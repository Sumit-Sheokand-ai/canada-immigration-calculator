import{r as g,j as S}from"./vendor-react-Ah1pgjPn.js";import{c as ht,b as wt}from"./feature-path-coach-Beny58Sb.js";const yt={"header.title":"Express Entry Score Studio","header.tagline":"Clear score. Clear plan.","welcome.heading":`Know your CRS score
and your next best move`,"welcome.sub":"Answer a few simple questions to see your CRS score, where your points come from, and what to do next.","welcome.btn":"Start free score check","welcome.updated":"IRCC data updated:","welcome.trust":"Draw data source — last updated:","welcome.microcopy":"Takes about 3 minutes. No paperwork. No spam.","welcome.resume":"You have a saved session.","welcome.resumeBtn":"Resume","welcome.startFresh":"Start Fresh","feature.accurate":"Understand your score","feature.accurateDesc":"See exactly how your CRS points are calculated.","feature.suggestions":"Focus on high-impact actions","feature.suggestionsDesc":"Get practical steps that can realistically raise your score.","feature.draws":"Track real draw movement","feature.drawsDesc":"Use recent draw patterns to plan better timing.","feature.instant":"Trusted and private","feature.instantDesc":"Start free. Save only when you choose.","wizard.step":"Step","wizard.of":"of","wizard.next":"Next →","wizard.back":"← Back","wizard.calculate":"Calculate Score ✓","results.breakdown":"Where your points come from","results.improve":"Best ways to improve your score","results.category":"Category draw eligibility","results.catIntro":"Some category rounds use lower cutoffs. Here is where your profile currently fits:","results.timeline":"Estimated timeline","results.draws":"Recent Express Entry draws","results.disclaimer":"This tool provides estimates using public CRS rules. Always confirm final requirements on canada.ca before filing.","results.restart":"↻ Recalculate","results.share":"Share Results","results.pdf":"Download PDF","results.whatif":"Scenario simulator","results.whatifDesc":"Test a few profile changes and compare possible score outcomes:","results.original":"Current","results.projected":"Projected","results.foreignWork":"Foreign Work (Skill Bonus)","strategy.actionCenter.title":"Action Center","strategy.actionCenter.subtitle":"Start here for the most important next actions — ranked by impact, timing, and risk.","strategy.actionCenter.saveProfile":"Save profile","strategy.actionCenter.openOptimizer":"Open optimizer","strategy.actionCenter.openForecast":"Open forecast","strategy.actionCenter.openDigitalTwin":"Open digital twin","strategy.actionCenter.openOpportunityRadar":"Open opportunity radar","strategy.actionCenter.openCommandCenter":"Open command center","strategy.actionCenter.openCopilot":"Open grounded copilot","strategy.actionCenter.openCollaboration":"Open collaboration workspace","strategy.actionCenter.openBenchmarks":"Open community benchmarks","strategy.actionCenter.openPlan":"Open 90-day plan","strategy.actionCenter.comparePlans":"Compare plans","strategy.actionCenter.expertCoach":"Expert strategy coach","strategy.actionCenter.manageAccount":"Manage account","strategy.actionCenter.exportHandoff":"Export consultant file","strategy.actionCenter.shareHandoff":"Copy handoff share link","strategy.actionCenter.profileStatus":"Profile save status","strategy.actionCenter.notSavedYet":"Not saved yet","strategy.actionCenter.planCompletion":"90-day completion","strategy.actionCenter.confidence":"Confidence","strategy.actionCenter.riskLevel":"Risk level","strategy.actionCenter.nextTask":"Next best task","strategy.actionCenter.startTask":"Start task","strategy.optimizer.title":"Strategy Optimizer","strategy.forecast.title":"Forecast Outlook","strategy.forecast.subtitle":"Projection based on recent draw cutoffs, volatility, and freshness of available data.","strategy.forecast.trend":"Trend","strategy.forecast.confidence":"Forecast confidence","strategy.forecast.sampleSize":"Sample size","strategy.forecast.likelihood":"Invitation likelihood","strategy.forecast.nextCutoff":"Projected next cutoff","strategy.forecast.threeDrawAvg":"3-draw avg","strategy.forecast.latestObserved":"Latest observed cutoff","strategy.forecast.gapToProjection":"Gap to projection","strategy.forecast.projectedSequence":"Projected sequence","strategy.forecast.volatility":"Volatility","strategy.forecast.slope":"Slope/draw","strategy.plan.title":"90-Day Action Plan","strategy.pricing.title":"Plans & Upgrade Path","strategy.pricing.experimentLabel":"Active experiment variant","strategy.pricing.freeCta":"Continue with Free","strategy.pricing.proCtaDefault":"Go to Pro setup","strategy.pricing.proCtaExperiment":"Start Pro planning","strategy.explainability.title":"Explainability & Confidence","footer.copy":"Free CRS Calculator 2026 · Not affiliated with IRCC"},vt={"header.title":"Calculateur SRC","welcome.heading":`Immigration au Canada
Calculateur de Points`,"welcome.sub":"Calculez votre score du Système de classement global (SCG) et découvrez votre meilleur chemin vers la résidence permanente canadienne.","welcome.btn":"Calculer Mon Score","welcome.updated":"Dernière mise à jour :","welcome.trust":"Données officielles d’IRCC — dernière mise à jour :","welcome.microcopy":"Cela prend 3 minutes — une question à la fois.","welcome.resume":"Vous avez un calcul en cours.","welcome.resumeBtn":"Reprendre","welcome.startFresh":"Recommencer","feature.accurate":"Score SCG Précis","feature.accurateDesc":"Calcul complet du Système de classement global","feature.suggestions":"Suggestions Intelligentes","feature.suggestionsDesc":"Conseils personnalisés pour augmenter vos points","feature.draws":"Derniers Tirages","feature.drawsDesc":"Résultats à jour des tirages Entrée express d'IRCC","feature.instant":"Résultats Instantanés","feature.instantDesc":"Obtenez votre score en moins de 2 minutes","wizard.step":"Étape","wizard.of":"de","wizard.next":"Suivant →","wizard.back":"← Retour","wizard.calculate":"Calculer le Score ✓","results.breakdown":"Détail de Votre Score","results.improve":"Comment Améliorer Votre Score","results.category":"Admissibilité aux Tirages par Catégorie","results.catIntro":"Le Canada organise des tirages spéciaux pour des groupes spécifiques avec des seuils plus bas. Voici ce à quoi vous pourriez être admissible :","results.timeline":"Calendrier Estimé","results.draws":"Tirages Récents Entrée Express","results.disclaimer":"Ce calculateur fournit une estimation basée sur les critères SCG publics. Il n'est pas affilié à IRCC.","results.restart":"↻ Recommencer","results.share":"Partager les Résultats","results.pdf":"Télécharger PDF","results.whatif":"Comparaison Hypothétique","results.whatifDesc":"Ajustez les variables pour voir comment votre score change :","results.original":"Original","results.projected":"Projeté","results.foreignWork":"Exp. Étrangère (Bonus)","strategy.actionCenter.title":"Centre d’action","strategy.actionCenter.subtitle":"Utilisez ce centre de contrôle pour exécuter les actions à plus fort impact avec priorités et risques visibles.","strategy.actionCenter.saveProfile":"Enregistrer le profil","strategy.actionCenter.openOptimizer":"Ouvrir l’optimiseur","strategy.actionCenter.openForecast":"Ouvrir la prévision","strategy.actionCenter.openPlan":"Ouvrir le plan 90 jours","strategy.actionCenter.comparePlans":"Comparer les offres","strategy.actionCenter.expertCoach":"Coach stratégie expert","strategy.actionCenter.manageAccount":"Gérer le compte","strategy.actionCenter.exportHandoff":"Exporter le dossier consultant","strategy.actionCenter.profileStatus":"Statut d’enregistrement","strategy.actionCenter.notSavedYet":"Pas encore enregistré","strategy.actionCenter.planCompletion":"Progression 90 jours","strategy.actionCenter.confidence":"Confiance","strategy.actionCenter.riskLevel":"Niveau de risque","strategy.actionCenter.nextTask":"Prochaine tâche prioritaire","strategy.actionCenter.startTask":"Démarrer la tâche","strategy.optimizer.title":"Optimiseur de stratégie","strategy.forecast.title":"Perspective de prévision","strategy.forecast.subtitle":"Projection basée sur les seuils récents, la volatilité et la fraîcheur des données.","strategy.forecast.trend":"Tendance","strategy.forecast.confidence":"Confiance de la prévision","strategy.forecast.sampleSize":"Taille d’échantillon","strategy.forecast.likelihood":"Probabilité d’invitation","strategy.forecast.nextCutoff":"Seuil projeté suivant","strategy.forecast.threeDrawAvg":"Moy. 3 tirages","strategy.forecast.latestObserved":"Dernier seuil observé","strategy.forecast.gapToProjection":"Écart à la projection","strategy.forecast.projectedSequence":"Séquence projetée","strategy.forecast.volatility":"Volatilité","strategy.forecast.slope":"Pente/tirage","strategy.plan.title":"Plan d’action 90 jours","strategy.pricing.title":"Offres et montée en gamme","strategy.pricing.experimentLabel":"Variante d’expérience active","strategy.pricing.freeCta":"Continuer en gratuit","strategy.pricing.proCtaDefault":"Accéder à la configuration Pro","strategy.pricing.proCtaExperiment":"Démarrer la planification Pro","strategy.explainability.title":"Explicabilité et confiance","footer.copy":"Calculateur SRC · Non affilié à IRCC"},Ee={en:yt,fr:vt},He=g.createContext();function Lr({children:e}){const[t,n]=g.useState(()=>{try{return localStorage.getItem("crs-lang")||"en"}catch{return"en"}}),r=g.useCallback(a=>{n(a);try{localStorage.setItem("crs-lang",a)}catch{}},[]),o=g.useCallback((a,i="")=>Ee[t]?.[a]||Ee.en[a]||i||a,[t]);return S.jsx(He.Provider,{value:{lang:t,setLang:r,t:o},children:e})}function bt(){return g.useContext(He)}const ze="crs-analytics-queue-v2",Te="crs-analytics-session-v1",Oe="2.0",kt=1800*1e3,St=2500;function We(e,t){try{return e?JSON.parse(e):t}catch{return t}}function xt(e,t){return typeof window>"u"?t:We(window.localStorage.getItem(e),t)}function Ct(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,JSON.stringify(t))}catch{}}function Ve(e="evt"){return`${e}_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,9)}`}function Mt(e,t=0){const n=Number(e);return Number.isFinite(n)?n:t}function _t(e){return e?String(e).trim().toLowerCase().replace(/[^a-z0-9:_-]+/g,"_").slice(0,80):""}function Ge(e={}){const t={};for(const[n,r]of Object.entries(e||{}))if(!(!n||r==null)){if(typeof r=="string"){t[n]=r.slice(0,280);continue}if(typeof r=="number"||typeof r=="boolean"){t[n]=r;continue}if(Array.isArray(r)){t[n]=r.slice(0,20).map(o=>String(o).slice(0,120));continue}t[n]=String(r).slice(0,280)}return t}function Nt(){return xt(ze,[])}function Pt(e){const t=Array.isArray(e)?e.slice(-300):[];Ct(ze,t)}function At(){if(typeof window>"u")return{id:"server",seq:0,started_at:new Date().toISOString()};const e=Date.now(),t=We(window.sessionStorage.getItem(Te),null),r=!t||!t.last_activity_ms||e-t.last_activity_ms>kt?{id:Ve("sess"),seq:1,started_at:new Date().toISOString(),last_activity_ms:e}:{...t,seq:Mt(t.seq,0)+1,last_activity_ms:e};try{window.sessionStorage.setItem(Te,JSON.stringify(r))}catch{}return r}function Lt(){if(typeof window>"u")return{app_version:"dev"};let e="unknown";try{e=Intl.DateTimeFormat().resolvedOptions().timeZone||"unknown"}catch{}return{app_version:"dev",lang:window.navigator?.language||"unknown",timezone:e,path:window.location?.pathname||"/"}}function It(e){return!1}async function Dt(e){if(typeof window>"u")return!1;const t=void 0;if(!It())return!1;const n=JSON.stringify(e);if(window.navigator?.sendBeacon&&document.visibilityState==="hidden")try{if(window.navigator.sendBeacon(t,new Blob([n],{type:"application/json"})))return!0}catch{}const r=typeof AbortController<"u"?new AbortController:null;let o=null;r&&(o=window.setTimeout(()=>r.abort(),St));try{return(await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0,signal:r?.signal})).ok}catch{return!1}finally{o&&window.clearTimeout(o)}}function Et(e,t){if(!(typeof window>"u")&&typeof window.plausible=="function")try{window.plausible(e,{props:t})}catch{}}function Tt(e){if(e instanceof Error){const t=String(e.stack||"").split(`
`)[0]||"",n=e?.cause instanceof Error?e.cause.message:typeof e?.cause=="string"?e.cause:"";return{error_name:String(e.name||"Error").slice(0,120),error_message:String(e.message||"Unknown error").slice(0,280),error_stack_head:String(t||"").slice(0,280),error_cause:String(n||"").slice(0,200)}}return typeof e=="string"?{error_name:"Error",error_message:e.slice(0,280),error_stack_head:"",error_cause:""}:e&&typeof e=="object"?{error_name:String(e.name||"Error").slice(0,120),error_message:String(e.message||JSON.stringify(e)).slice(0,280),error_stack_head:String(e.stack||"").split(`
`)[0]?.slice(0,280)||"",error_cause:""}:{error_name:"Error",error_message:"Unknown error",error_stack_head:"",error_cause:""}}function j(e,t={}){if(typeof window>"u")return;const n=_t(e);if(!n)return;const r=At(),o=Ge(t),a=Lt(),i={event_id:Ve("evt"),schema_version:Oe,name:n,ts:new Date().toISOString(),session_id:r.id,session_seq:r.seq,session_started_at:r.started_at,payload:o,meta:a},c=Nt();c.push(i),Pt(c),Et(n,{...o,schema_version:Oe,session_seq:r.seq}),Dt(i)}function Ir(e,t,n={}){if(typeof window>"u")return;const r=Ge(n),o=Tt(t),a=typeof navigator<"u"?navigator.onLine:void 0,i={...r,...o,online:typeof a=="boolean"?a:void 0,visibility:typeof document<"u"?document.visibilityState:void 0};j(e||"app_error",i)}const Ot="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='m268 112 144 144-144 144M392 256H100' stroke-linecap='square' stroke-miterlimit='10' stroke-width='48px' class='ionicon-fill-none'/></svg>",Ft="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M496 496H16V16h32v448h448z'/><path d='M192 432H80V208h112ZM336 432H224V160h112ZM479.64 432h-112V96h112Z'/></svg>",Bt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M32 456a24 24 0 0 0 24 24h400a24 24 0 0 0 24-24V176H32Zm320-244a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm0 80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm-80-80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm0 80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm0 80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm-80-80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm0 80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm-80-80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4Zm0 80a4 4 0 0 1 4-4h40a4 4 0 0 1 4 4v40a4 4 0 0 1-4 4h-40a4 4 0 0 1-4-4ZM456 64h-55.92V32h-48v32H159.92V32h-48v32H56a23.8 23.8 0 0 0-24 23.77V144h448V87.77A23.8 23.8 0 0 0 456 64'/></svg>",$t="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48m48.19 121.42 24.1 21.06-73.61 84.1-24.1-23.06ZM191.93 342.63 121.37 272 144 249.37 214.57 320Zm65 .79L185.55 272l22.64-22.62 47.16 47.21 111.13-127.17 24.1 21.06Z'/></svg>",jt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M396.31 32H264l84.19 112.26zM115.69 32l48.12 112.26L248 32zM256 74.67 192 160h128zM422.95 51.06 376.26 160H488zM89.05 51.06 23 160h112.74zM146.68 192H24l222.8 288h.53zM365.32 192 264.67 480h.53L488 192zM329.39 192H182.61L256 400z'/></svg>",Rt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M272 160v147.37l64-64L358.63 266 256 368.63 153.37 266 176 243.37l64 64V160H92a12 12 0 0 0-12 12v296a12 12 0 0 0 12 12h328a12 12 0 0 0 12-12V172a12 12 0 0 0-12-12ZM240 32h32v128h-32z'/></svg>",Ht="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M432 208H288l32-192L80 304h144l-32 192Z'/></svg>",zt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M209 384h-37a28 28 0 0 1-28-28V152a64 64 0 1 0-64-1.16V356a92.1 92.1 0 0 0 92 92h37v55.21L294.39 416 209 328.79ZM113 64a32 32 0 1 1-32 32 32 32 0 0 1 32-32M432 360.61V156a92.1 92.1 0 0 0-92-92h-35V9.93L217.14 96 305 182.07V128h35a28 28 0 0 1 28 28v204.61a64 64 0 1 0 64 0M400 448a32 32 0 1 1 32-32 32 32 0 0 1-32 32'/></svg>",Wt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M240 240H32V32h208ZM480 240H272V32h208ZM240 480H32V272h208ZM480 480H272V272h208Z'/></svg>",Vt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M480 150 256 48 32 150l224 104zM255.71 392.95l-144.81-66.2L32 362l224 102 224-102-78.69-35.3z'/><path d='m480 256-75.53-33.53L256.1 290.6l-148.77-68.17L32 256l224 102z'/></svg>",Gt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='m41.37 64 22.628-22.628L470.627 448l-22.628 22.627zM256 480a80.09 80.09 0 0 0 73.3-48H182.7a80.09 80.09 0 0 0 73.3 48M112 227.47V288l-48 64v48h268.12L115.87 183.75a236.8 236.8 0 0 0-3.87 43.72M448 352l-48-64v-60.53C400 157 372.64 95.61 304 80l-8-48h-80l-8 48a117.5 117.5 0 0 0-41.95 18.17l282 282Z'/></svg>",Ut="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M256 480a80.09 80.09 0 0 0 73.3-48H182.7a80.09 80.09 0 0 0 73.3 48M400 288v-60.53C400 157 372.64 95.61 304 80l-8-48h-80l-8 48c-68.88 15.61-96 76.76-96 147.47V288l-48 64v48h384v-48Z'/></svg>",Zt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M381.25 112a48 48 0 0 0-90.5 0H48v32h242.75a48 48 0 0 0 90.5 0H464v-32ZM176 208a48.09 48.09 0 0 0-45.25 32H48v32h82.75a48 48 0 0 0 90.5 0H464v-32H221.25A48.09 48.09 0 0 0 176 208M336 336a48.09 48.09 0 0 0-45.25 32H48v32h242.75a48 48 0 0 0 90.5 0H464v-32h-82.75A48.09 48.09 0 0 0 336 336'/></svg>",qt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><circle cx='152' cy='184' r='72'/><path d='M234 296c-28.16-14.3-59.24-20-82-20-44.58 0-136 27.34-136 82v42h150v-16.07c0-19 8-38.05 22-53.93 11.17-12.68 26.81-24.45 46-34'/><path d='M340 288c-52.07 0-156 32.16-156 96v48h312v-48c0-63.84-103.93-96-156-96'/><circle cx='340' cy='168' r='88'/></svg>",Yt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208 208-93.31 208-208S370.69 48 256 48m2 96a72 72 0 1 1-72 72 72 72 0 0 1 72-72m-2 288a175.55 175.55 0 0 1-129.18-56.6C135.66 329.62 215.06 320 256 320s120.34 9.62 129.18 55.39A175.52 175.52 0 0 1 256 432'/></svg>",Jt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='m58 362.09-6.51-14.59A224 224 0 0 1 256 32h16v234.37Z'/><path d='M304 66.46v220.65L94.62 380.78A208.31 208.31 0 0 0 272 480c114.69 0 208-93.31 208-208 0-103.81-76.45-190.1-176-205.54'/></svg>",Kt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><ellipse cx='256' cy='256' rx='36' ry='35.99'/><path d='m188.4 350.8-14.62-16.44a117.91 117.91 0 0 1 0-156.71l14.62-16.43 32.87 29.24-14.62 16.43a73.93 73.93 0 0 0 0 98.25l14.62 16.44ZM323.6 350.8l-32.89-29.22 14.62-16.44a73.93 73.93 0 0 0 0-98.25l-14.62-16.43 32.87-29.24 14.62 16.43a117.91 117.91 0 0 1 0 156.71Z'/><path d='m138.24 401.76-15-16.06a189.85 189.85 0 0 1 0-259.4l15-16.07 32.14 30.05-15 16.06a145.88 145.88 0 0 0 0 199.32l15 16.06ZM373.76 401.76l-32.14-30 15-16.06a145.88 145.88 0 0 0 0-199.32l-15-16.06 32.14-30 15 16.07a189.85 189.85 0 0 1 0 259.4Z'/><path d='m430.73 447-32.79-29.33 14.66-16.39a218.2 218.2 0 0 0 0-290.56l-14.67-16.38L430.72 65l14.67 16.39a262.18 262.18 0 0 1 0 349.22ZM81.27 447 66.6 430.61a262.18 262.18 0 0 1 0-349.22L81.28 65l32.79 29.34-14.68 16.38a218.2 218.2 0 0 0 0 290.56l14.66 16.39Z'/></svg>",Qt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M380.44 32H64a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h384a32.09 32.09 0 0 0 32-32V131.56ZM112 176v-64h192v64Zm223.91 179.76a80 80 0 1 1-83.66-83.67 80.21 80.21 0 0 1 83.66 83.67'/></svg>",Xt="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M378 324a69.78 69.78 0 0 0-48.83 19.91L202 272.41a69.7 69.7 0 0 0 0-32.82l127.13-71.5A69.76 69.76 0 1 0 308.87 129l-130.13 73.2a70 70 0 1 0 0 107.56L308.87 383A70 70 0 1 0 378 324'/></svg>",en="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='m479.07 111.36-.79-12.53-12.36-2.21c-86.5-15.52-122.61-26.74-203.33-63.2l-6.59-3-6.59 3C168.69 69.88 132.58 81.1 46.08 96.62l-12.36 2.21-.79 12.53c-3.85 61.11 4.36 118.05 24.43 169.24A349.5 349.5 0 0 0 129 393.11c53.47 56.73 110.24 81.37 121.07 85.73l6 2.41 6-2.41c10.83-4.36 67.6-29 121.07-85.73a349.5 349.5 0 0 0 71.5-112.51c20.07-51.19 28.28-108.13 24.43-169.24m-252.91 216L153.37 256l22.4-22.86 48.47 47.49 110.13-127.2 24.2 20.94Z'/></svg>",tn="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='m208 512-52.38-139.62L16 320l139.62-52.38L208 128l52.38 139.62L400 320l-139.62 52.38ZM88 176l-23.57-64.43L0 88l64.43-23.57L88 0l23.57 64.43L176 88l-64.43 23.57ZM400 256l-31.11-80.89L288 144l80.89-31.11L400 32l31.11 80.89L512 144l-80.89 31.11Z'/></svg>",nn="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M128 496H48V304h80ZM352 496h-80V208h80ZM464 496h-80V96h80ZM240 496h-80V16h80Z'/></svg>",rn="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M256 48C141.13 48 48 141.13 48 256c0 114.69 93.32 208 208 208 114.86 0 208-93.14 208-208 0-114.69-93.31-208-208-208m108 240H244a4 4 0 0 1-4-4V116a4 4 0 0 1 4-4h24a4 4 0 0 1 4 4v140h92a4 4 0 0 1 4 4v24a4 4 0 0 1-4 4'/></svg>",on="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M352 144h112v112' stroke-linecap='square' stroke-miterlimit='10' class='ionicon-fill-none ionicon-stroke-width'/><path d='m48 368 144-144 96 96 160-160' stroke-linecap='square' stroke-miterlimit='10' class='ionicon-fill-none ionicon-stroke-width'/></svg>",an={"arrow-forward-sharp":Ot,"bar-chart-sharp":Ft,"calendar-sharp":Bt,"checkmark-done-circle-sharp":$t,"diamond-sharp":jt,"download-sharp":Rt,"flash-sharp":Ht,"git-compare-sharp":zt,"grid-sharp":Wt,"layers-sharp":Vt,"notifications-off-sharp":Gt,"notifications-sharp":Ut,"options-sharp":Zt,"people-sharp":qt,"person-circle-sharp":Yt,"pie-chart-sharp":Jt,"radar-sharp":Kt,"save-sharp":Qt,"share-social-sharp":Xt,"shield-checkmark-sharp":en,"sparkles-sharp":tn,"stats-chart-sharp":nn,"time-sharp":rn,"trending-up-sharp":on},de=new Map;function sn(e){if(!e)return"";if(de.has(e))return de.get(e);const t=an[e];if(typeof t!="string")return de.set(e,""),"";const n=t.indexOf(","),r=n===-1?"":decodeURIComponent(t.slice(n+1));return de.set(e,r),r}function Dr({name:e,className:t="",label:n="",...r}){const o=sn(e);if(!o)return null;const a=n?{role:"img","aria-label":n}:{"aria-hidden":"true"};return S.jsx("span",{className:`svg-icon ${t}`.trim(),dangerouslySetInnerHTML:{__html:o},...a,...r})}const ke="crs-runtime-flags-v1",Y={forceLocalData:!1,allowRemoteQuestionBank:!0,enableAdvancedForecasting:!0,enablePerfTelemetry:!0};function Ue(e){const t=e&&typeof e=="object"?e:{};return{forceLocalData:!!t.forceLocalData,allowRemoteQuestionBank:t.allowRemoteQuestionBank!==!1,enableAdvancedForecasting:t.enableAdvancedForecasting!==!1,enablePerfTelemetry:t.enablePerfTelemetry!==!1}}function Fe(){if(typeof window>"u")return{...Y};try{const e=window.localStorage.getItem(ke);if(!e)return{...Y};const t=JSON.parse(e);return{...Y,...Ue(t)}}catch{return{...Y}}}function Er(e){const t={...Y,...Ue(e)};if(typeof window>"u")return t;try{window.localStorage.setItem(ke,JSON.stringify(t))}catch{}try{window.dispatchEvent(new Event("crs-runtime-flags-updated"))}catch{}return t}function Tr(){if(typeof window>"u")return{...Y};try{window.localStorage.removeItem(ke)}catch{}try{window.dispatchEvent(new Event("crs-runtime-flags-updated"))}catch{}return{...Y}}const ve="crs-exp-assignments-v1",cn="crs-exp-overrides-v1",Be="crs-exp-visitor-id-v1",$e="crs-exp-exposures-v1",Se={pricing_layout_v1:{variants:[{id:"control",weight:50},{id:"pro_first",weight:50}],goals:["pricing_cta_click","handoff_export"]}};function Ze(e,t){try{return e?JSON.parse(e):t}catch{return t}}function xe(e){return typeof window>"u"?{}:Ze(window.localStorage.getItem(e),{})}function ln(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,JSON.stringify(t||{}))}catch{}}function dn(e){return typeof window>"u"?{}:Ze(window.sessionStorage.getItem(e),{})}function un(e,t){if(!(typeof window>"u"))try{window.sessionStorage.setItem(e,JSON.stringify(t||{}))}catch{}}function pn(e=""){let t=0;for(let n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t)}function fn(e,t,n=Se){const r=n?.[e];if(!r||!Array.isArray(r.variants)||r.variants.length===0)return"control";const o=r.variants.map(s=>({id:String(s.id||""),weight:Number(s.weight)>0?Number(s.weight):0})).filter(s=>s.id&&s.weight>0);if(!o.length)return"control";const a=o.reduce((s,f)=>s+f.weight,0),c=pn(`${e}:${t||"default"}`)%a;let l=0;for(const s of o)if(l+=s.weight,c<l)return s.id;return o[o.length-1].id}function mn(){if(typeof window>"u")return"server";const e=String(window.localStorage.getItem(Be)||"").trim();if(e)return e;const t=`visitor_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,9)}`;try{window.localStorage.setItem(Be,t)}catch{}return t}function gn(e){const t=xe(cn),n=String(t?.[e]||"").trim();return n&&Se[e]?.variants?.some(a=>a.id===n)?n:null}function hn(e){if(typeof window>"u")return;const t=dn($e),n=`${e.experimentKey}:${e.variant}`;t?.[e.experimentKey]!==n&&(un($e,{...t,[e.experimentKey]:n}),j("experiment_exposure",{experiment_key:e.experimentKey,experiment_variant:e.variant,experiment_source:e.source}))}function wn(e,{autoTrack:t=!1}={}){if(!Se[e])return{experimentKey:e,variant:"control",source:"unknown_experiment"};const r=gn(e),o=mn(),a=r||fn(e,o),i=r?"override":"hash",c=xe(ve);c?.[e]!==a&&ln(ve,{...c,[e]:a});const l={experimentKey:e,variant:a,source:i,visitorId:o};return t&&hn(l),l}function yn(){return xe(ve)}function vn(e={}){const t={};for(const[n,r]of Object.entries(e||{}))r!=null&&(typeof r=="string"||typeof r=="number"||typeof r=="boolean")&&(t[n]=r);return t}function bn(e=[],t={}){return(Array.isArray(e)?e:[]).map(n=>{let r=!1;try{r=typeof n?.check=="function"?!!n.check(t):!1}catch{r=!1}return{id:n?.id||"",name:n?.name||"",recentCutoff:Number(n?.recentCutoff)||0,cutoffRange:n?.cutoffRange||"",source:n?.source||"unknown",updatedAt:n?.updatedAt||null,eligible:r}})}function kn(e={}){return{confidenceBand:e?.confidenceBand||"Unknown",overallConfidence:Number(e?.overallConfidence)||0,score:Number(e?.score)||0,cutoff:Number(e?.cutoff)||0,gap:Number(e?.gap)||0,top:e?.top?{title:e.top.title,lane:e.top.lane,score:Number(e.top.score)||0,scoreGain:Number(e.top.scoreGain)||0,months:Number(e.top.months)||0,confidence:Number(e.top.confidence)||0,effort:e.top.effort||"Unknown"}:null,ranked:(e?.ranked||[]).slice(0,4).map(t=>({id:t.id,title:t.title,lane:t.lane,score:Number(t.score)||0,scoreGain:Number(t.scoreGain)||0,months:Number(t.months)||0,confidence:Number(t.confidence)||0,effort:t.effort||"Unknown"})),riskFlags:(e?.globalRiskFlags||[]).map(t=>({id:t.id,label:t.label,severity:t.severity}))}}function Sn(e=null){return e?{readinessIndex:Number(e?.readinessIndex)||0,recommendedWindow:e?.recommendedWindow||"",recommendedOpportunityId:e?.recommendedOpportunityId||"",signals:(e?.signals||[]).slice(0,5).map(t=>({id:t.id,title:t.title,lane:t.lane,opportunityScore:Number(t.opportunityScore)||0,confidenceBand:t.confidenceBand||"Unknown",scoreDeltaNeeded:Number(t.scoreDeltaNeeded)||0,windowLabel:t.windowLabel||"",riskLevel:t.riskLevel||"unknown"})),alertTriggers:(e?.alertTriggers||[]).slice(0,4).map(t=>({id:t.id,title:t.title,trigger:t.trigger,windowLabel:t.windowLabel}))}:null}function xn(e=null){return e?{readinessScore:Number(e?.readinessScore)||0,readinessBand:e?.readinessBand||"Unknown",profileCompleteness:Number(e?.profileCompleteness)||0,blockers:(e?.blockers||[]).map(t=>({id:t.id,label:t.label,detail:t.detail})),checklist:(e?.checklist||[]).map(t=>({id:t.id,title:t.title,owner:t.owner,dueWindow:t.dueWindow,status:t.status,evidence:t.evidence}))}:null}function Cn(e=null){return e?{modelLabel:e?.modelLabel||"Unknown",groundingMode:e?.groundingMode||"unknown",cards:(e?.cards||[]).map(t=>({id:t.id,prompt:t.prompt,response:t.response,confidenceBand:t.confidenceBand,quickAction:t.quickAction,evidence:Array.isArray(t.evidence)?t.evidence:[]}))}:null}function Mn(e=null){return e?{workspaceId:e?.workspaceId||"",workspaceReadiness:Number(e?.workspaceReadiness)||0,readinessBand:e?.readinessBand||"Unknown",packageStatus:e?.packageStatus||"unknown",reviewChecklist:(e?.reviewChecklist||[]).map(t=>({id:t.id,label:t.label,status:t.status,detail:t.detail})),collaborationNotes:Array.isArray(e?.collaborationNotes)?e.collaborationNotes:[]}:null}function _n(e=null){return e?{percentile:Number(e?.percentile)||0,benchmarkBand:e?.benchmarkBand||"Unknown",cohort:e?.cohort||null,summary:e?.summary||"",comparison:(e?.comparison||[]).map(t=>({id:t.id,label:t.label,score:Number(t.score)||0,isUser:!!t.isUser})),leverageSignals:(e?.leverageSignals||[]).map(t=>({id:t.id,label:t.label,headroom:Number(t.headroom)||0}))}:null}function Nn(e={}){return{completionPct:Number(e?.completionPct)||0,completedCount:Number(e?.completedCount)||0,totalCount:Number(e?.totalCount)||0,nextBestTask:e?.nextBestTask?{id:e.nextBestTask.id,title:e.nextBestTask.title,dateWindow:e.nextBestTask.dateWindow,successMetric:e.nextBestTask.successMetric}:null,tasks:(e?.tasks||[]).map(t=>({id:t.id,title:t.title,lane:t.lane,priority:t.priority,impact:Number(t.impact)||0,dateWindow:t.dateWindow,weekWindow:t.weekWindow}))}}function Pn({answers:e={},result:t={},strategy:n={},forecast:r=null,actionPlan:o={},opportunityRadar:a=null,commandCenter:i=null,copilot:c=null,collaboration:l=null,communityBenchmarks:s=null,drawData:f={},categoryInfo:p=[]}={}){const h=Number(t?.total)||0,u=Number(f?.averageCutoff)||Number(n?.cutoff)||0;return{schema:"crs_consultant_handoff_v1",generatedAt:new Date().toISOString(),appVersion:"dev",summary:{score:h,averageCutoff:u,gapToAverageCutoff:h-u,confidenceBand:n?.confidenceBand||"Unknown"},policy:t?.policy||null,profileAnswers:vn(e),scoreBreakdown:t?.breakdown||{},scoreDetails:t?.details||{},strategy:kn(n),opportunityRadar:Sn(a),commandCenter:xn(i),copilot:Cn(c),collaboration:Mn(l),communityBenchmarks:_n(s),forecast:r?{trendLabel:r.trendLabel,confidenceBand:r.confidenceBand,confidenceScore:Number(r.confidenceScore)||0,projectedNextCutoff:Number(r.projectedNextCutoff)||0,projectedThreeDrawAvg:Number(r.projectedThreeDrawAvg)||0,projectedDraws:Array.isArray(r.projectedDraws)?r.projectedDraws:[],invitationLikelihood:r.invitationLikelihood||"Unknown"}:null,actionPlan:Nn(o),dataSnapshot:{drawLastUpdated:f?.lastUpdated||null,drawSource:f?.source||null,categoryCount:Array.isArray(p)?p.length:0,categoryEligibility:bn(p,e)},experimentAssignments:yn()}}function An(e){try{if(!e)return null;const t=String(e).replace(/-/g,"+").replace(/_/g,"/"),n=t.length%4===0?"":"=".repeat(4-t.length%4);return JSON.parse(decodeURIComponent(atob(t+n)))}catch{return null}}function Or(e=window.location.search){try{const n=new URLSearchParams(e||"").get("handoff");return An(n)}catch{return null}}const qe="crs-saved-profiles-v1";function Ce(){try{const e=localStorage.getItem(qe);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}}function Ye(e){try{localStorage.setItem(qe,JSON.stringify(e))}catch{}}function Ln(){const e=Math.random().toString(36).slice(2,8);return`prf_${Date.now().toString(36)}_${e}`}function In(){return`${Math.random().toString(36).slice(2,10)}${Math.random().toString(36).slice(2,10)}`}function Dn(){const e=Ce();return Object.values(e).sort((t,n)=>String(n.updatedAt).localeCompare(String(t.updatedAt)))}function Fr({id:e,name:t="",answers:n={},score:r=0,email:o="",alertOptIn:a=!1,alertToken:i=null}){const c=Ce(),l=e||Ln(),s=new Date().toISOString(),f=c[l],p={id:l,name:t||f?.name||`Profile ${l.slice(-4)}`,answers:n,score:r,email:o,alertOptIn:!!a,alertToken:a?i||f?.alertToken||In():null,createdAt:f?.createdAt||s,updatedAt:s};return c[l]=p,Ye(c),p}function Br({reason:e="autopilot",force:t=!1}={}){const n=Ce(),r=Object.entries(n||{});if(!r.length)return{status:"noop",reason:e,scanned:0,updated:0,skipped:0,policyVersion:""};let o=0,a=0,i="";const c=new Date().toISOString();for(const[l,s]of r){const f=s?.answers;if(!f||typeof f!="object"){a+=1;continue}const p=ht(f),h=Number(p?.total||0),u=String(p?.policy?.version||"");i=u||i;const k=Number(s?.score||0),P=String(s?.policyVersion||"");(t||k!==h||P!==u)&&(n[l]={...s,score:h,policyVersion:u,policyEffectiveDate:p?.policy?.effectiveDate||"",policySource:p?.policy?.source||"",policyRecalculatedAt:c},o+=1)}return o>0&&Ye(n),{status:o>0?"updated":"noop",reason:e,scanned:r.length,updated:o,skipped:a,policyVersion:i,recalculatedAt:c}}const En="crs-90-day-action-plan-v1",Je=1440*60*1e3,je={High:3,Medium:2,Low:1},O={impact:.34,speed:.18,confidence:.22,effort:.12,laneFit:.14},W={budgetCad:3500,weeklyHours:6,examAttempts:2,relocationPreference:"balanced"},Tn=[{id:"3m",label:"3 months",months:3,gainFactor:.35},{id:"6m",label:"6 months",months:6,gainFactor:.62},{id:"12m",label:"12 months",months:12,gainFactor:.88}];function y(e,t,n){return Math.max(t,Math.min(n,e))}function On(e,t){return`Day ${e}-${t}`}function d(e,t=0){const n=Number(e);return Number.isFinite(n)?n:t}function R(e,t=0){const n=parseInt(e,10);return Number.isFinite(n)?n:t}function pe(e={}){const t=e&&typeof e=="object"?e:{},n=["balanced","province","federal"].includes(t.relocationPreference)?t.relocationPreference:W.relocationPreference;return{budgetCad:y(R(t.budgetCad,W.budgetCad),500,2e4),weeklyHours:y(R(t.weeklyHours,W.weeklyHours),2,30),examAttempts:y(R(t.examAttempts,W.examAttempts),1,8),relocationPreference:n}}function Fn(e=new Date){const t=new Date(e);return t.setHours(0,0,0,0),t}function fe(e,t){return new Date(e.getTime()+t*Je)}function be(e){try{return e.toLocaleDateString(void 0,{month:"short",day:"numeric"})}catch{return e.toISOString().slice(0,10)}}function ue(e,t,n){const r=fe(e,Math.max(t-1,0)),o=fe(e,Math.max(n-1,0));return{startDateIso:r.toISOString(),endDateIso:o.toISOString(),weekWindow:`Week ${Math.ceil(t/7)}-${Math.ceil(n/7)}`,dateWindow:`${be(r)} → ${be(o)}`}}function Bn(e,t){const n=d(t);return e==="listening"?n>=8.5?10:n>=8?9:n>=7.5?8:n>=6?7:n>=5.5?6:n>=5?5:0:e==="reading"?n>=8?10:n>=7?9:n>=6.5?8:n>=6?7:n>=5?6:n>=4?5:0:n>=7.5?10:n>=7?9:n>=6.5?8:n>=6?7:n>=5.5?6:n>=5?5:0}function $n(e={}){const t=["listening","reading","writing","speaking"],n=e.firstOfficialLanguage==="french",o=t.map(a=>n?R(e[`french_${a}`],0):e.langTestType==="celpip"?R(e[`celpip_${a}`],0):Bn(a,e[`ielts_${a}`])).filter(a=>a>0);return o.length?Math.min(...o):0}function F(e,t,n,r="medium"){return{id:e,label:t,detail:n,severity:r}}function jn(e){return e==="high"?10:e==="medium"?5:2}function Rn(e="Medium"){return e==="Easy"?100:e==="Medium"?68:38}function Hn(e=0){return e>=76?"High":e>=56?"Medium":"Low"}function zn(e={},t,n){const r=d(t?.total),o=n-r,a=R(e.age,0),i=$n(e),c=e.hasFrench==="yes"||e.firstOfficialLanguage==="french",l=R(e.canadianWorkExp,0),s=R(e.foreignWorkExp,0),f=i>=9?18:i>=7?46:74,p=y((a>=33?28:14)+(i<7?26:i<9?16:6)+(l===0?12:4)+(s>=3?8:3),10,90),h=[{key:"answers_accuracy",label:"Profile values are accurate and complete",confidence:e.knowsScore==="yes"?"Medium":"High"},{key:"draw_trend_stability",label:"Recent draw patterns remain directionally similar",confidence:Math.abs(o)<=20?"Medium":"Low"},{key:"execution_discipline",label:"You can sustain weekly execution cadence for 90 days",confidence:p<=45?"High":p<=65?"Medium":"Low"}],u=[];return a>=33&&u.push(F("risk-age-decay","Age-point decay risk","Delays can reduce score as age thresholds change.",a>=38?"high":"medium")),i>0&&i<7&&u.push(F("risk-language-floor","Language floor below CLB 7","Several lanes become weaker or inaccessible below CLB 7.","high")),c||u.push(F("risk-no-french","No French upside yet","You may miss lower-cutoff category opportunities tied to French strength.","low")),o>40&&u.push(F("risk-large-gap","Large score gap","A single action may not close this gap; a combination strategy is likely required.","high")),{score:r,gap:o,age:a,minLanguageClb:i,hasFrench:c,canadianWorkExp:l,foreignWorkExp:s,languageHeadroom:f,profileComplexity:p,assumptions:h,globalRiskFlags:u}}function Ke(e={}){const t=[e.age,e.education,e.pathway,e.canadianWorkExp,e.foreignWorkExp,e.hasFrench,e.hasPNP].join("|");let n=0;for(let r=0;r<t.length;r+=1)n=(n<<5)-n+t.charCodeAt(r),n|=0;return Math.abs(n).toString(16)}function Wn(e,t,n){const r=e.category==="Language"?50+t.languageHeadroom*.45:e.category==="Provincial"?72:e.category==="Combination"?76:60,o=y(r+(e.goalReached?8:0)+(e.likelihoodPercent-50)*.35,30,95),a=[];return e.estimatedMonths>=10&&a.push(F(`${e.id}-timeline`,"Long timeline","This lane can take substantial time before score impact materializes.","medium")),e.difficulty==="Hard"&&a.push(F(`${e.id}-effort`,"Execution intensity","Consistent weekly effort is required to avoid plan drift.","medium")),!e.goalReached&&n>0&&a.push(F(`${e.id}-bridge`,"May require a second lane","This lane may need a backup action to fully close your gap.","low")),{id:`path-${e.id}`,title:e.title,lane:e.category,reason:e.whyItFits,scoreGain:e.potentialGain,months:e.estimatedMonths,confidence:e.likelihoodPercent,effort:e.difficulty,estimatedCostCad:d(e.estimatedCostCad,0),examSensitive:e.category==="Language"||/language|ielts|celpip|tef|tcf|french/i.test(e.title||""),laneFit:o,riskFlags:a}}function Vn({score:e,cutoff:t,eligibleCount:n,signals:r}){const o=t-e,a=o<=0?82:o<=20?64:38,i=[];return n||i.push(F("category-not-eligible","Not category-eligible yet","A prerequisite profile change is required before this lane can be used.","high")),o>35&&i.push(F("category-gap","Gap still material","Category targeting helps, but the score gap remains significant.","medium")),{id:"lane-category-draws",title:"Category Draw Positioning",lane:"Category Draws",reason:n>0?`You match ${n} category stream(s). Improve targeted factors to close the category cutoff gap.`:"You are not currently category-eligible; targeted profile adjustments can unlock lower-cutoff streams.",scoreGain:y(Math.round(Math.max(o,0)*.5),0,80),months:o<=0?1:o<=20?4:8,confidence:a,effort:o<=0?"Easy":o<=20?"Medium":"Hard",estimatedCostCad:1200,examSensitive:!r.hasFrench,laneFit:y((n>0?70:35)+(r.hasFrench?8:0),25,90),riskFlags:i}}function Gn(e){if(!e)return null;const t=[];return e.matchScore<55&&t.push(F(`province-${e.id}-fit`,"Lower province fit","Province alignment is currently moderate; stream targeting needs tighter matching.","high")),e.matchScore>=55&&e.matchScore<70&&t.push(F(`province-${e.id}-variance`,"Selection variance","Provincial intake criteria can shift and may require profile tuning.","medium")),{id:`lane-province-${e.id}`,title:`${e.name} PNP Focus`,lane:"Provincial",reason:`${e.name} has the highest profile match in your province analysis.`,scoreGain:e.matchScore>=70?600:300,months:e.matchScore>=70?6:9,confidence:y(e.matchScore,35,88),effort:e.matchScore>=70?"Medium":"Hard",estimatedCostCad:e.matchScore>=70?3200:4200,examSensitive:!1,laneFit:y(e.matchScore+(e.matchScore>=70?6:-4),25,95),riskFlags:t}}function Un(e={},t=0){return[{key:"coreHumanCapital",label:"Core profile factors",value:d(e.coreHumanCapital)},{key:"skillTransferability",label:"Transferability factors",value:d(e.skillTransferability)},{key:"additionalPoints",label:"Additional point factors",value:d(e.additionalPoints)},{key:"spouseFactors",label:"Spouse factors",value:d(e.spouseFactors)}].map(r=>({...r,headroom:y(100-Math.round(r.value/Math.max(t,1)*100),0,100)})).sort((r,o)=>o.headroom-r.headroom).slice(0,2)}function Zn(e,t){const n=Math.max(Math.abs(t),35),r=y(Math.round(e.scoreGain/n*100),8,100),o=y(100-e.months*11,12,100),a=y(e.confidence,12,100),i=Rn(e.effort),c=y(d(e.laneFit,60),10,100),l=r*O.impact+o*O.speed+a*O.confidence+i*O.effort+c*O.laneFit,s=Array.isArray(e.riskFlags)?e.riskFlags:[],f=y(s.reduce((h,u)=>h+jn(u.severity),0),0,24),p=y(Math.round(l-f),1,100);return{...e,score:p,riskPenalty:f,scoreBreakdown:[{key:"impact",label:"Impact potential",value:r,weight:O.impact},{key:"speed",label:"Speed to value",value:o,weight:O.speed},{key:"confidence",label:"Data confidence",value:a,weight:O.confidence},{key:"effort",label:"Execution ease",value:i,weight:O.effort},{key:"laneFit",label:"Profile-lane fit",value:c,weight:O.laneFit}]}}function qn(e={}){const t=e.effort==="Hard"?10:e.effort==="Medium"?6:3,n=d(e.months,6)<=3?2:d(e.months,6)<=6?1:0;return t+n}function Yn(e={}){const t=d(e.estimatedCostCad,0);return t>0?t:e.lane==="Provincial"?3600:e.lane==="Category Draws"?1200:e.lane==="Language"?1800:2200}function Jn(e={}){return/provincial/i.test(e.lane||"")}function Kn(e,t){const n=pe(t),r=[],o=Yn(e),a=qn(e);let i=0;const c=n.budgetCad/Math.max(o,1);if(c<.75){const u=Math.min(Math.round((.75-c)*20),12);i-=u,r.push({id:"budget",label:"Budget pressure",delta:-u})}else if(c>1.35){const u=Math.min(Math.round((c-1.35)*8),5);i+=u,r.push({id:"budget",label:"Budget headroom",delta:u})}const l=n.weeklyHours-a;if(l<0){const u=Math.min(Math.abs(l)*2,10);i-=u,r.push({id:"time",label:"Time constraint",delta:-u})}else if(l>0){const u=Math.min(l,4);i+=u,r.push({id:"time",label:"Time capacity",delta:u})}if(e.examSensitive){if(n.examAttempts<=1)i-=8,r.push({id:"exam",label:"Low exam retry budget",delta:-8});else if(n.examAttempts>=3){const u=Math.min((n.examAttempts-2)*2,4);i+=u,r.push({id:"exam",label:"Exam retry flexibility",delta:u})}}const s=Jn(e);if(n.relocationPreference==="province"){const u=s?8:-3;i+=u,r.push({id:"relocation",label:"Province-focused preference",delta:u})}else if(n.relocationPreference==="federal"){const u=s?-7:4;i+=u,r.push({id:"relocation",label:"Federal-focused preference",delta:u})}const f=y(Math.round(i),-24,18),p=y(e.score+f,1,100),h=y(Math.round(70+f*2),12,99);return{...e,baseScore:e.score,score:p,constraintAdjustment:f,constraintFitScore:h,constraintFactors:r,estimatedCostCad:o,requiredWeeklyHours:a}}function Qn(e){const t=new Date(e?.date||"");return Number.isNaN(t.getTime())?null:t}function Xn(e={},t=10){return[...e.generalProgram||[],...e.categoryBased||[],...e.pnpDraws||[]].map(r=>({score:d(r?.score),date:Qn(r),program:r?.program||"Unknown"})).filter(r=>r.score>0&&r.date).sort((r,o)=>o.date.getTime()-r.date.getTime()).slice(0,t)}function er(e=[]){if(!e.length)return 0;const t=e.reduce((r,o)=>r+o,0)/e.length,n=e.reduce((r,o)=>r+(o-t)**2,0)/e.length;return Math.sqrt(n)}function Qe(e=0){return e>=75?"High":e>=55?"Medium":"Low"}function ye({scoreGap:e=0,volatility:t=0,confidence:n=60}){const r=y((e+80)/160,0,1),o=y(d(t)/120,0,.26),a=y(d(n,60)/100,0,1)*.2,i=r*.72+a-o;return y(i,.02,.98)}function tr({forecast:e,averageCutoff:t,horizonMonths:n}){if(!e)return Math.round(d(t,520));const r=d(e.projectedNextCutoff,d(t,520)),o=d(e.slopePerDraw,0),a=Math.max(Math.round(n/2),1);return Math.round(y(r+o*Math.max(a-1,0),300,800))}function nr(e=0){return e>=70?"High":e>=45?"Medium":"Low"}function rr({strategy:e,forecast:t,actionPlan:n,averageCutoff:r,userScore:o}){const a=d(o,d(e?.score,0)),i=Math.max(d(e?.top?.scoreGain,0),0),c=y(d(n?.completionPct,0),0,100),l=y(c/100*.55+.45,.4,1),s=d(t?.volatility,14),f=d(t?.confidenceScore,e?.overallConfidence||58),p=e?.top?.title||"Primary strategy lane",h=Tn.map(v=>{const x=tr({forecast:t,averageCutoff:r,horizonMonths:v.months}),L=Math.round(i*v.gainFactor*l),M=a+L,D=Math.round(M-x),B=ye({scoreGap:D,volatility:s,confidence:f}),I=ye({scoreGap:D+Math.max(Math.round(i*.35),8),volatility:s*.75,confidence:f+8}),H=ye({scoreGap:D-Math.max(Math.round(i*.45),10),volatility:s*1.25,confidence:f-10}),T=Math.round(B*100),V=Math.round(I*100),G=Math.round(H*100),b=y(Math.round(26+s*.8-f*.18),8,34),E=y(Math.round(T-b/2),1,99),Me=y(Math.round(T+b/2),1,99);return{id:v.id,label:v.label,months:v.months,projectedCutoff:x,expectedScore:M,expectedGain:L,scoreGap:D,baseProbabilityPct:T,bestProbabilityPct:V,worstProbabilityPct:G,chanceBand:nr(T),confidenceInterval:{lowPct:E,highPct:Me,uncertaintyPct:b}}}),k=[...h].sort((v,x)=>x.baseProbabilityPct!==v.baseProbabilityPct?x.baseProbabilityPct-v.baseProbabilityPct:v.months-x.months)[0]||h[0]||null,P=k?.id||"6m",C=Qe(f),w=[{id:"top_lane_gain",label:`${p} expected gain`,value:`+${Math.round(i)} pts potential`,influence:i>=20?"positive":"neutral"},{id:"execution_cadence",label:"Execution cadence",value:`${c}% action-plan completion`,influence:c>=55?"positive":c>=25?"neutral":"negative"},{id:"draw_volatility",label:"Draw volatility pressure",value:`${Number(s).toFixed(2)} volatility`,influence:s<=12?"positive":s<=24?"neutral":"negative"}];return{generatedAt:new Date().toISOString(),confidenceBand:C,recommendedHorizonId:P,topLane:p,horizons:h,keyDrivers:w,summary:k?`Best current horizon: ${k.label} with ${k.baseProbabilityPct}% base invitation probability.`:"Digital twin is preparing probability projections."}}function or({activeDraws:e,userScore:t,baseConfidence:n=60}){const r=Xn(e,10);if(!r.length)return null;const o=r[0],a=[...r].reverse(),i=a[0],c=a[a.length-1],l=a.length,s=l>1?(c.score-i.score)/(l-1):0,f=o.score,p=Math.round(y(f+s,300,800)),h=Math.round(y(p+s,300,800)),u=Math.round(y(h+s,300,800)),k=Math.round((p+h+u)/3),P=er(r.map(B=>B.score)),C=o.date,w=C?Math.floor((Date.now()-C.getTime())/Je):999;let v=d(n,60);v+=Math.min(l*3,18),v-=Math.min(P*1.2,24),w<=2?v+=5:w<=7?v+=1:w>14&&(v-=9),v=y(Math.round(v),20,92);const x=s>1.5?"rising":s<-1.5?"falling":"stable",L=x==="rising"?"Cutoff trend is rising":x==="falling"?"Cutoff trend is falling":"Cutoff trend is stable",M=d(t)-p,D=M>=20?"High":M>=0?"Medium":"Low";return{sampleSize:l,volatility:Number(P.toFixed(2)),slopePerDraw:Number(s.toFixed(2)),projectedNextCutoff:p,projectedThreeDrawAvg:k,projectedDraws:[p,h,u],trendDirection:x,trendLabel:L,confidenceScore:v,confidenceBand:Qe(v),invitationLikelihood:D,userGapToNext:M,latestObservedCutoff:f,latestObservedProgram:o.program,latestObservedDateIso:C?.toISOString()||""}}function ar({answers:e,result:t,averageCutoff:n,categoryInfo:r=[],provinces:o=[],eligibleCategoryCount:a=Number.NaN,optimizerConstraints:i=W}){const c=pe(i),l=d(t?.total),s=d(n,520),f=s-l,p=zn(e,t,s),u=(wt(e,t,{averageCutoff:s}).plans||[]).slice(0,2).map(b=>Wn(b,p,f)),k=d(a,Number.NaN),P=Number.isFinite(k)?Math.max(Math.round(k),0):r.filter(b=>typeof b?.check=="function"&&b.check(e)).length,C=Vn({score:l,cutoff:s,eligibleCount:P,signals:p}),w=Gn((o||[])[0]||null),x=[...u,C,w].filter(Boolean).map(b=>Zn(b,f)).map(b=>Kn(b,c)).sort((b,E)=>E.score-b.score).slice(0,4),L=x[0]||null,M=x[1]||null,D=Un(t?.breakdown,l),B=[...p.globalRiskFlags||[],...x.slice(0,2).flatMap(b=>b.riskFlags||[])],I=Object.values(B.reduce((b,E)=>(E?.id&&(b[E.id]||(b[E.id]=E)),b),{})).slice(0,5),H=x.slice(0,2).map(b=>y(b.confidence-b.riskPenalty,0,100)),T=H.length?Math.round(H.reduce((b,E)=>b+E,0)/H.length):36,V=Hn(T),G=L?`Primary lane: ${L.title}. Estimated gain ${L.scoreGain} points in ~${L.months} months (${V.toLowerCase()} confidence).`:"No strong lane detected yet. Start by improving language and category eligibility.";return{score:l,cutoff:s,gap:f,ranked:x,top:L,nextBest:M,bottlenecks:D,assumptions:p.assumptions,globalRiskFlags:I,overallConfidence:T,confidenceBand:V,profileSignals:{minLanguageClb:p.minLanguageClb,profileComplexity:p.profileComplexity,languageHeadroom:p.languageHeadroom},optimizerConstraints:c,scoreWeights:O,guidanceSummary:G}}function Xe(e="in_progress"){return e==="ready"?100:e==="blocked"?28:62}function ir(e={}){const t=String(e.lane||"").toLowerCase();return t.includes("provincial")?"Shortlist province streams and prep EOI documents this week.":t.includes("category")?"Align profile to category thresholds and track next category rounds.":t.includes("language")?"Book exam slot and run a focused weekly language sprint.":"Execute the next milestone from your primary lane playbook."}function sr(e={},t=0){const n=String(e.lane||"").toLowerCase();let r=n.includes("provincial")?45:n.includes("category")?21:28;const o=d(e.months,6);return o<=3&&(r-=6),o>=9&&(r+=10),t>35&&(r+=7),t<=5&&(r-=3),y(Math.round(r),10,90)}function cr(e=0){return e<=14?"Next 2 weeks":e<=30?"Next 30 days":e<=60?"Next 1-2 months":"Next quarter"}function re(e=0){return e>=78?"High":e>=56?"Medium":"Low"}function lr({strategy:e,forecast:t=null,averageCutoff:n=0,userScore:r=0,eligibleCategoryCount:o=0}){const a=Array.isArray(e?.ranked)?e.ranked:[],i=d(r,d(e?.score,0)),c=d(n,d(e?.cutoff,520)),l=Math.max(Math.round(c-i),0),s=d(t?.confidenceScore,d(e?.overallConfidence,58)),f=t?.trendDirection||"stable",p=a.slice(0,4).map((w,v)=>{const x=sr(w,l),L=Math.max(c-(i+d(w.scoreGain,0)),0),M=y(100-Math.round(L*1.7),12,100),D=y(Math.round(d(w.score,0)*.54+d(w.constraintFitScore,60)*.18+s*.18+M*.1-d(w.riskPenalty,0)*.35),1,99),B=(w.riskFlags||[]).some(I=>I.severity==="high")?"high":(w.riskFlags||[]).some(I=>I.severity==="medium")?"medium":"low";return{id:`opportunity-${w.id||v}`,title:w.title,lane:w.lane,whyNow:w.reason,opportunityScore:D,confidenceBand:re(D),scoreDeltaNeeded:Math.round(L),windowDays:x,windowLabel:cr(x),trendDirection:f,nextAction:ir(w),riskLevel:B}}),h=o>0?[{id:"opportunity-category-eligibility",title:"Category-eligible window",lane:"Category Draws",whyNow:`You currently match ${o} category stream(s), which can create faster draw pathways.`,opportunityScore:y(58+o*6-Math.min(l,25),28,92),confidenceBand:o>=3?"High":"Medium",scoreDeltaNeeded:Math.max(l-12,0),windowDays:l<=15?18:28,windowLabel:l<=15?"Immediate window":"Next 30 days",trendDirection:f,nextAction:"Prioritize category-specific actions and monitor nearest category rounds.",riskLevel:l>30?"medium":"low"}]:[],u=[...p,...h].sort((w,v)=>v.opportunityScore-w.opportunityScore).slice(0,5),k=u[0]||null,P=u.length?Math.round(u.slice(0,3).reduce((w,v)=>w+v.opportunityScore,0)/Math.min(u.length,3)):0,C=u.slice(0,3).map(w=>({id:`trigger-${w.id}`,title:w.title,trigger:w.scoreDeltaNeeded<=0?"Activate immediately when next draw opens.":`Activate when remaining gap is ≤ ${Math.max(w.scoreDeltaNeeded-5,0)} points.`,windowLabel:w.windowLabel}));return{generatedAt:new Date().toISOString(),readinessIndex:P,recommendedOpportunityId:k?.id||"",recommendedWindow:k?.windowLabel||"No opportunity window detected",trendDirection:f,summary:k?`${k.title} is your best near-term opportunity (${k.opportunityScore}/100) in the ${k.windowLabel.toLowerCase()}.`:"Opportunity radar is waiting for additional profile signals.",signals:u,alertTriggers:C}}function dr(e={}){const t=["age","education","pathway","canadianWorkExp","foreignWorkExp","langTestType"],n=t.filter(r=>{const o=e?.[r];return o==null?!1:typeof o=="string"?o.trim()!=="":!0}).length;return t.length>0?Math.round(n/t.length*100):0}function ur({actionPlan:e,strategy:t,opportunityRadar:n,profileCompleteness:r,gap:o}){const a=Array.isArray(e?.tasks)?e.tasks:[],i=d(e?.completedCount,0)>0,c=!!t?.nextBest,l=Array.isArray(n?.signals)&&n.signals.length>0,s=r>=80?"ready":r>=55?"in_progress":"blocked",f=r>=85?"ready":r>=60?"in_progress":"blocked",p=c?"ready":o>20?"blocked":"in_progress",h=l?"ready":"in_progress";return[{id:"cmd-baseline",title:"Lock baseline profile + target score",owner:"Candidate",dueWindow:(a.find(k=>k.priority==="High")||a[0])?.dateWindow||"This week",status:i?"ready":s,evidence:i?"At least one high-priority plan task completed.":"Save baseline and confirm target delta."},{id:"cmd-primary-lane",title:`Execute primary lane: ${t?.top?.title||"Top strategy lane"}`,owner:"Candidate",dueWindow:t?.top?.months?`~${t.top.months} months`:"Next 30 days",status:i?"in_progress":"blocked",evidence:t?.top?.reason||"Primary lane rationale unavailable."},{id:"cmd-doc-pack",title:"Prepare application document command pack",owner:"Candidate + Consultant",dueWindow:"Days 30-60",status:f,evidence:`Profile completeness ${r}%.`},{id:"cmd-fallback",title:"Activate backup lane contingency",owner:"Consultant",dueWindow:"Before day 60",status:p,evidence:c?`Backup lane ready: ${t?.nextBest?.title}.`:"Backup lane not selected yet."},{id:"cmd-monitor",title:"Monitor upcoming draw windows and trigger rules",owner:"Candidate",dueWindow:n?.recommendedWindow||"Weekly",status:h,evidence:l?`${n?.signals?.length||0} opportunity signal(s) detected.`:"No radar opportunity signals detected yet."}]}function pr({answers:e,result:t,strategy:n,actionPlan:r,opportunityRadar:o}){const a=d(t?.total,d(n?.score,0)),i=d(n?.cutoff,0),c=Math.max(i-a,0),l=dr(e),s=ur({actionPlan:r,strategy:n,opportunityRadar:o,profileCompleteness:l,gap:c}),f=[];c>35&&f.push({id:"blocker-gap",label:"Large score gap",detail:`Gap remains ${Math.round(c)} points.`}),(n?.profileSignals?.minLanguageClb||0)>0&&(n?.profileSignals?.minLanguageClb||0)<7&&f.push({id:"blocker-language-floor",label:"Language floor below CLB 7",detail:"Language score floor can limit lane viability."}),l<60&&f.push({id:"blocker-profile-completeness",label:"Profile completeness is low",detail:`Completeness is ${l}%; fill missing profile fields.`});const p=s.length?Math.round(s.reduce((u,k)=>u+Xe(k.status),0)/s.length):0,h=y(Math.round(p*.45+d(r?.completionPct,0)*.35+d(n?.overallConfidence,0)*.2-Math.min(f.length*6,18)),0,100);return{generatedAt:new Date().toISOString(),readinessScore:h,readinessBand:re(h),blockers:f,profileCompleteness:l,checklist:s,summary:h>=75?"Application command center is in strong shape for near-term execution.":h>=55?"Application command center is progressing, with a few blockers to clear.":"Application command center needs foundational fixes before aggressive execution."}}function fr({strategy:e,forecast:t,digitalTwin:n,commandCenter:r,opportunityRadar:o}){return[`Top lane: ${e?.top?.title||"N/A"} (${d(e?.top?.score,0)}/100)`,`Confidence: ${e?.confidenceBand||"Unknown"} (${d(e?.overallConfidence,0)}/100)`,`Forecast next cutoff: ${d(t?.projectedNextCutoff,d(e?.cutoff,0))}`,`Digital twin recommendation: ${(n?.recommendedHorizonId||"n/a").toUpperCase?.()||"N/A"}`,`Command readiness: ${d(r?.readinessScore,0)}/100`,`Opportunity radar top window: ${o?.recommendedWindow||"N/A"}`]}function mr({strategy:e,forecast:t,actionPlan:n,digitalTwin:r,commandCenter:o,opportunityRadar:a}){const i=n?.nextBestTask,c=e?.top,l=a?.signals?.[0],s=fr({strategy:e,forecast:t,digitalTwin:r,commandCenter:o,opportunityRadar:a}),f=[{id:"copilot-weekly-focus",prompt:"What should I execute this week?",response:i?`Execute "${i.title}" first, then continue "${c?.title||"your primary lane"}".`:`Prioritize "${c?.title||"your primary lane"}" this week and close one blocker.`,confidenceBand:re(d(e?.overallConfidence,0)),evidence:[s[0],`Next task: ${i?.title||"none"}`,`Action-plan completion: ${d(n?.completionPct,0)}%`],quickAction:"section-90-day-plan"},{id:"copilot-gap-clarity",prompt:"How close am I to the likely draw threshold?",response:`Your current gap is ${Math.round(Math.max(d(e?.gap,0),0))} points versus the average cutoff snapshot.`,confidenceBand:re(d(t?.confidenceScore,d(e?.overallConfidence,0))),evidence:[`Current score: ${d(e?.score,0)}`,`Cutoff reference: ${d(e?.cutoff,0)}`,`Forecast next cutoff: ${d(t?.projectedNextCutoff,d(e?.cutoff,0))}`],quickAction:"section-forecast"},{id:"copilot-opportunity-window",prompt:"Where is the fastest opportunity window?",response:l?`${l.title} is the top opportunity (${l.opportunityScore}/100) in the ${l.windowLabel.toLowerCase()}.`:"No high-confidence radar window yet; continue strengthening your top lane.",confidenceBand:l?.confidenceBand||"Low",evidence:[`Radar readiness index: ${d(a?.readinessIndex,0)}/100`,`Recommended window: ${a?.recommendedWindow||"none"}`,`Top lane fit: ${d(c?.constraintFitScore,0)}/100`],quickAction:"section-opportunity-radar"},{id:"copilot-risk-control",prompt:"What is my biggest execution risk right now?",response:o?.blockers?.[0]?`${o.blockers[0].label}. Address this before scaling to secondary lanes.`:"No major blockers detected. Keep execution cadence and monitor draw updates.",confidenceBand:re(d(o?.readinessScore,0)),evidence:[`Command readiness: ${d(o?.readinessScore,0)}/100`,`Blocker count: ${o?.blockers?.length||0}`,`Global risk flags: ${e?.globalRiskFlags?.length||0}`],quickAction:"section-command-center"}];return{generatedAt:new Date().toISOString(),modelLabel:"Grounded Strategy Copilot",groundingMode:"deterministic_rulepack_v1",cards:f,evidence:s}}function gr({answers:e,result:t,strategy:n,actionPlan:r,commandCenter:o,copilot:a}){const i=`ws-${Ke(e).slice(0,10)}`,c=[{id:"collab-policy",label:"Policy snapshot attached",status:t?.policy?.version?"ready":"blocked",detail:t?.policy?.version?`Using ${t.policy.version} (${t.policy.source||"unknown source"})`:"No policy snapshot found in result payload."},{id:"collab-lane",label:"Top lane rationale documented",status:n?.top?.reason?"ready":"in_progress",detail:n?.top?.reason||"Top lane rationale missing."},{id:"collab-action-plan",label:"Action milestones assigned",status:(r?.tasks?.length||0)>=3?"ready":"in_progress",detail:`${r?.tasks?.length||0} tasks available for consultant review.`},{id:"collab-copilot",label:"Grounded advisory briefs prepared",status:(a?.cards?.length||0)>=3?"ready":"in_progress",detail:`${a?.cards?.length||0} copilot brief(s) generated.`}],l=c.length?Math.round(c.reduce((p,h)=>p+Xe(h.status),0)/c.length):0,s=y(Math.round(l*.5+d(o?.readinessScore,0)*.25+d(r?.completionPct,0)*.25),0,100),f=["Attach latest language test receipts and booking confirmations.","Highlight any province-specific ties or mobility constraints.","Confirm which lane is fallback if primary timeline slips by >20%."];return{generatedAt:new Date().toISOString(),workspaceId:i,workspaceReadiness:s,readinessBand:re(s),packageStatus:s>=72?"review_ready":s>=52?"needs_follow_up":"draft",reviewChecklist:c,collaborationNotes:f}}function hr(e=0){return e>=90?"Top decile":e>=75?"Upper quartile":e>=50?"Above median":e>=30?"Emerging tier":"Early tier"}function wr({answers:e,result:t,strategy:n}){const r=d(t?.total,d(n?.score,0)),o=R(e?.age,30),a=String(e?.education||""),i=d(n?.profileSignals?.minLanguageClb,0),c=R(e?.canadianWorkExp,0),l=e?.hasFrench==="yes"||e?.firstOfficialLanguage==="french",s={secondary:0,one_year_post:12,two_year_post:18,bachelors:26,two_or_more:34,masters:45,doctoral:52}[a]||22,f=o>=39?-20:o>=35?-10:o<=24?-8:0,p=i>=9?38:i>=7?24:i>=5?10:0,h=y(c*8,0,24),u=l?18:0,k=Math.round(460+s+f+p+h+u),P=k+28,C=k+52,w=y(Math.round(50+(r-k)/2.1),1,99),v=hr(w),x=[{id:"benchmark-p50",label:"Cohort median (P50)",score:k},{id:"benchmark-p75",label:"Upper quartile (P75)",score:P},{id:"benchmark-p90",label:"Top decile (P90)",score:C},{id:"benchmark-user",label:"Your current score",score:r,isUser:!0}],L=(n?.bottlenecks||[]).map(M=>({id:`benchmark-lever-${M.key}`,label:M.label,headroom:d(M.headroom,0)}));return{generatedAt:new Date().toISOString(),percentile:w,benchmarkBand:v,cohort:{ageBand:o<25?"18-24":o<30?"25-29":o<35?"30-34":o<40?"35-39":"40+",educationTier:a||"unknown",languageFloor:i},comparison:x,leverageSignals:L,summary:`You are in the ${v.toLowerCase()} at approximately P${w} against an anonymized peer cohort baseline.`}}function yr({answers:e,result:t,suggestions:n=[],averageCutoff:r,activeDraws:o,categoryInfo:a=[],provinces:i=[],progress:c={},enableAdvancedForecasting:l=!1,eligibleCategoryCount:s=Number.NaN,optimizerConstraints:f=W}){const p=ar({answers:e,result:t,averageCutoff:r,categoryInfo:a,provinces:i,eligibleCategoryCount:s,optimizerConstraints:f}),h=vr({suggestions:n,strategy:p,scoreGap:Math.max((r||0)-(t?.total||0),0),progress:c}),u=l?or({activeDraws:o,userScore:t?.total||0,baseConfidence:p.overallConfidence}):null,k=rr({strategy:p,forecast:u,actionPlan:h,averageCutoff:r,userScore:t?.total||0}),P=lr({strategy:p,forecast:u,averageCutoff:r,userScore:t?.total||0,eligibleCategoryCount:s}),C=pr({answers:e,result:t,strategy:p,actionPlan:h,opportunityRadar:P}),w=mr({strategy:p,forecast:u,actionPlan:h,digitalTwin:k,commandCenter:C,opportunityRadar:P}),v=gr({answers:e,result:t,strategy:p,actionPlan:h,commandCenter:C,copilot:w}),x=wr({answers:e,result:t,strategy:p});return{strategy:p,actionPlan:h,forecast:u,digitalTwin:k,opportunityRadar:P,commandCenter:C,copilot:w,collaboration:v,communityBenchmarks:x}}function te(e,t,n,r,o,a,i,c="Medium",l,s={}){const{startDateIso:f,endDateIso:p,weekWindow:h,dateWindow:u}=ue(l,r,o);return{id:e,title:t,rationale:n,window:On(r,o),dayFrom:r,dayTo:o,impact:a,lane:i,priority:c,startDateIso:f,endDateIso:p,weekWindow:h,dateWindow:u,successMetric:s.successMetric||"Task completed with verified profile update.",checkpoint:s.checkpoint||"Run a score recalculation and note delta.",dependencies:s.dependencies||[],cadence:s.cadence||"3 focused sessions per week"}}function vr({suggestions:e=[],strategy:t,scoreGap:n=0,progress:r={}}){const o=e[1],a=t?.top?.title||"Profile Optimization",i=Math.max(d(n),0),c=Fn(new Date),l=[te("plan-baseline","Lock baseline and target score",`Set a concrete target and freeze your baseline profile to avoid random changes. Current gap: ${i} points.`,1,7,0,a,"High",c,{successMetric:"Target score and top lane documented; baseline snapshot saved.",checkpoint:"Save profile with date tag and score target.",cadence:"One 45-minute planning block + one review"}),te("plan-primary-lane",`Execute primary lane: ${a}`,t?.top?.reason||"Follow the highest-impact lane identified by optimizer.",8,30,t?.top?.scoreGain||10,a,"High",c,{successMetric:`Deliver at least 60% of ${a} milestones.`,checkpoint:"Verify measurable progress (test booking, docs, submissions, etc.)."}),te("plan-secondary-lane",o?`Secondary boost: ${o.title}`:"Secondary boost: language and profile precision",o?.description||"Add one additional improvement path to reduce draw uncertainty.",24,50,o?.potentialGain||8,o?.title||"Secondary path","Medium",c,{successMetric:"Secondary lane started with first concrete deliverable completed.",checkpoint:"Compare score delta before/after secondary-lane kickoff.",dependencies:["plan-primary-lane"]}),te("plan-document-pack","Prepare immigration document pack","Collect and verify key documents (identity, education, work proofs, test reports, proof-of-funds readiness).",35,68,0,"Readiness","High",c,{successMetric:"Core document checklist reaches 90% readiness.",checkpoint:"Review missing docs and issue dates.",cadence:"Two short admin sessions weekly"}),te("plan-risk-buffer","Activate fallback lane if progress stalls","If progress velocity is below target, start a backup action immediately (e.g., category-specific adjustment or province-first route).",55,80,6,"Fallback Control","Medium",c,{successMetric:"Fallback lane is selected and started within 7 days of stall signal.",checkpoint:"Mark stall trigger if expected gain is short by 20%+.",dependencies:["plan-primary-lane"]}),te("plan-profile-audit","Profile audit and draw readiness check","Re-evaluate score vs latest draws and category cutoffs. Trigger fallback lane if gap remains above 15 points.",75,90,0,"Risk Control","High",c,{successMetric:"Final 90-day readiness review completed with go/no-go decision.",checkpoint:"Capture current score, active cutoff delta, and next 30-day plan.",dependencies:["plan-document-pack"]})],s=[{label:"Days 1-30",objective:"Baseline lock + launch primary lane",expectedGain:l[1].impact,dateWindow:ue(c,1,30).dateWindow},{label:"Days 31-60",objective:"Add secondary lane + document readiness",expectedGain:l[2].impact,dateWindow:ue(c,31,60).dateWindow},{label:"Days 61-90",objective:"Fallback control + final draw readiness review",expectedGain:l[4].impact,dateWindow:ue(c,61,90).dateWindow}],f=l.filter(C=>!!r[C.id]).length,p=l.length,h=p>0?Math.round(f/p*100):0,u=[...l].filter(C=>!r[C.id]).sort((C,w)=>{const v=je[w.priority]-je[C.priority];return v!==0?v:C.dayFrom-w.dayFrom})[0]||null,k=h>=100?"All action-plan tasks are complete. Keep a weekly score monitor to stay draw-ready.":u?`Next best task: ${u.title} (${u.dateWindow}).`:"Continue progressing through the plan in order of priority.",P=[14,30,60,90].map(C=>{const w=fe(c,C-1);return{day:C,iso:w.toISOString(),label:be(w)}});return{tasks:l,milestones:s,completedCount:f,totalCount:p,completionPct:h,nextBestTask:u,completionGuidance:k,calendar:{planStartIso:c.toISOString(),planEndIso:fe(c,89).toISOString(),reviewDates:P}}}function Re(e={}){if(typeof window>"u")return{};const t=`${En}:${Ke(e)}`;try{const n=window.localStorage.getItem(t);return n?JSON.parse(n):{}}catch{return{}}}function ne(e,t=null){if(typeof window>"u")return t;try{const n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch{return t}}function br(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,JSON.stringify(t))}catch{}}function kr(e={}){const t=JSON.stringify(e||{});let n=0;for(let r=0;r<t.length;r+=1)n=(n<<5)-n+t.charCodeAt(r),n|=0;return Math.abs(n).toString(16)}function Sr({answers:e,result:t,suggestions:n,averageCutoff:r,activeDraws:o,activeCategoryInfo:a,provinces:i,drawFreshness:c,categoryFreshness:l,saveStatus:s,onJumpToSection:f,onOpenAccount:p}){const{t:h}=bt(),[u,k]=g.useState(()=>Fe()),[P,C]=g.useState(()=>({experimentKey:"pricing_layout_v1",variant:"control",source:"init"})),[w,v]=g.useState(()=>Re(e)),x=g.useRef(null),L=g.useRef(0),[M,D]=g.useState(null),B=g.useRef(""),I=g.useMemo(()=>kr(e),[e]),H=g.useMemo(()=>`crs-last-visit-snapshot-v1:${I}`,[I]),T=g.useMemo(()=>`crs-action-reminders-v1:${I}`,[I]),V=g.useMemo(()=>`crs-optimizer-constraints-v1:${I}`,[I]),G=g.useMemo(()=>`crs-command-center-checklist-v1:${I}`,[I]),[b,E]=g.useState(null),[Me,et]=g.useState(()=>ne(T,{})||{}),[_e,tt]=g.useState(()=>ne(G,{})||{}),[me,nt]=g.useState(()=>pe(W)),[xr,Cr]=g.useState(""),[Ne,rt]=g.useState("6m"),Pe=g.useMemo(()=>a.filter(m=>typeof m?.check=="function"&&m.check(e)).length,[a,e]);g.useEffect(()=>{v(Re(e))},[e]),g.useEffect(()=>{et(ne(T,{})||{})},[T]),g.useEffect(()=>{tt(ne(G,{})||{})},[G]),g.useEffect(()=>{const m=ne(V,W);nt(pe(m))},[V]),g.useEffect(()=>{const m=()=>k(Fe());return window.addEventListener("crs-runtime-flags-updated",m),()=>window.removeEventListener("crs-runtime-flags-updated",m)},[]),g.useEffect(()=>{C(wn("pricing_layout_v1",{autoTrack:!0}))},[]);const ge=g.useMemo(()=>({answers:e,result:t,suggestions:n,averageCutoff:r,activeDraws:o,provinces:i,progress:w,enableAdvancedForecasting:u.enableAdvancedForecasting,eligibleCategoryCount:Pe,optimizerConstraints:me}),[o,e,r,Pe,me,w,i,t,u.enableAdvancedForecasting,n]);g.useEffect(()=>{let m=!1;const N=()=>{m||D(yr(ge))};if(typeof Worker>"u")return N(),()=>{m=!0};try{x.current||(x.current=new Worker(new URL("/assets/strategy.worker-BRx3o1ZF.js",import.meta.url),{type:"module"}));const A=x.current,Z=L.current+=1,ee=le=>{const q=le?.data||{};if(!(m||q.id!==Z)){if(q.status==="ok"&&q.data){D(q.data);return}N()}},ce=()=>{m||N()};return A.addEventListener("message",ee),A.addEventListener("error",ce),A.postMessage({id:Z,input:ge}),()=>{m=!0,A.removeEventListener("message",ee),A.removeEventListener("error",ce)}}catch{return N(),()=>{m=!0}}},[ge]),g.useEffect(()=>()=>{x.current?.terminate?.(),x.current=null},[]);const Ae=g.useMemo(()=>({score:Number(t?.total)||0,cutoff:Number(r)||0,gap:Math.max((Number(r)||0)-(Number(t?.total)||0),0),ranked:[],top:null,nextBest:null,bottlenecks:[],assumptions:[],globalRiskFlags:[],overallConfidence:0,confidenceBand:"Low",profileSignals:{profileComplexity:0,minLanguageClb:0,languageHeadroom:0},guidanceSummary:"Preparing strategic insights..."}),[r,t?.total]),Le=g.useMemo(()=>({tasks:[],milestones:[],completedCount:0,totalCount:0,completionPct:0,nextBestTask:null,completionGuidance:"Preparing action plan...",calendar:{reviewDates:[]}}),[]),_=g.useMemo(()=>M?.strategy||Ae,[M?.strategy,Ae]),oe=g.useMemo(()=>M?.actionPlan||Le,[Le,M?.actionPlan]),ae=M?.forecast||null,$=M?.digitalTwin||null,U=M?.opportunityRadar||null,z=M?.commandCenter||null,J=M?.copilot||null,K=M?.collaboration||null,Q=M?.communityBenchmarks||null,ie=$?.recommendedHorizonId||"",X=g.useMemo(()=>Array.isArray($?.horizons)?$.horizons:[],[$?.horizons]);g.useMemo(()=>X.find(m=>m.id===Ne)||X[0]||null,[X,Ne]);const Ie=oe.completionPct||0;g.useMemo(()=>(z?.checklist||[]).map(m=>{const N=!!_e[m.id];return{...m,userMarkedDone:N,effectiveStatus:N?"ready":m.status}}),[z?.checklist,_e]).filter(m=>m.effectiveStatus==="ready").length,g.useEffect(()=>{if(!M?.strategy)return;const m=ne(H,null),N={score:Number(_.score)||0,cutoff:Number(_.cutoff)||0,confidence:Number(_.overallConfidence)||0,updatedAt:new Date().toISOString()};m&&Number.isFinite(Number(m.score))?E({scoreDelta:N.score-(Number(m.score)||0),cutoffDelta:N.cutoff-(Number(m.cutoff)||0),confidenceDelta:N.confidence-(Number(m.confidence)||0),previousUpdatedAt:m.updatedAt||""}):E(null),br(H,N)},[M?.strategy,H,_.cutoff,_.overallConfidence,_.score]),g.useEffect(()=>{ie&&ie&&rt(ie)},[ie]),g.useEffect(()=>{if(!$)return;const m=`${$.generatedAt||""}:${$.recommendedHorizonId||""}:${X.length}`;!m||m===B.current||(B.current=m,j("digital_twin_rendered",{recommended_horizon_id:$.recommendedHorizonId||"none",horizon_count:X.length,confidence_band:$.confidenceBand||"unknown"}))},[$,X.length]),g.useEffect(()=>{U&&j("opportunity_radar_rendered",{signal_count:U.signals?.length||0,readiness_index:Number(U.readinessIndex||0),recommended_window:U.recommendedWindow||"unknown"})},[U]),g.useEffect(()=>{z&&j("application_command_center_rendered",{readiness_score:Number(z.readinessScore||0),blocker_count:z.blockers?.length||0,checklist_count:z.checklist?.length||0})},[z]),g.useEffect(()=>{J&&j("grounded_copilot_rendered",{card_count:J.cards?.length||0,grounding_mode:J.groundingMode||"unknown"})},[J]),g.useEffect(()=>{K&&j("consultant_collaboration_workspace_rendered",{readiness_score:Number(K.workspaceReadiness||0),package_status:K.packageStatus||"unknown"})},[K]),g.useEffect(()=>{Q&&j("community_benchmark_rendered",{percentile:Number(Q.percentile||0),benchmark_band:Q.benchmarkBand||"unknown"})},[Q]),[{label:"Core Human Capital",value:t?.breakdown?.coreHumanCapital||0},{label:"Skill Transferability",value:t?.breakdown?.skillTransferability||0},{label:"Additional Points",value:t?.breakdown?.additionalPoints||0},{label:"Spouse Factors",value:t?.breakdown?.spouseFactors||0}].sort((m,N)=>N.value-m.value).slice(0,3),g.useMemo(()=>{const m=c?.tier==="fresh"?92:c?.tier==="recent"?74:48,N=l?.tier==="fresh"?88:l?.tier==="recent"?72:45,A=Math.round((m+N)/2),Z=Math.max(Math.min(Math.round(Ie*.9+10),100),0),ee=(_.globalRiskFlags||[]).filter(we=>we.severity==="high").length,ce=(_.globalRiskFlags||[]).filter(we=>we.severity==="medium").length,le=Math.min(ee*12+ce*6,36),q=Number(ae?.confidenceScore||_.overallConfidence||0);return{total:Math.max(Math.min(Math.round(Number(_.overallConfidence||0)*.35+A*.25+Z*.2+q*.2-le),100),0),dataScore:A,executionScore:Z,forecastScore:q,riskPenalty:le}},[l?.tier,Ie,c?.tier,ae?.confidenceScore,_.globalRiskFlags,_.overallConfidence]),g.useMemo(()=>[...oe.tasks||[]].filter(m=>!w[m.id]).sort((m,N)=>{const A=(m.priority==="High"?0:m.priority==="Medium"?1:2)-(N.priority==="High"?0:N.priority==="Medium"?1:2);return A!==0?A:(m.dayFrom||0)-(N.dayFrom||0)}).slice(0,4),[oe.tasks,w]);const se=(()=>{const m=Dn().slice(0,8).map(A=>({id:A.id,label:A.updatedAt?new Date(A.updatedAt).toLocaleDateString():"Saved",score:Number(A.score)||0,current:!1})),N={id:"current-profile",label:"Now",score:Number(t?.total)||0,current:!0};return[...m,N].filter(A=>A.score>0).slice(-9)})();g.useMemo(()=>Pn({answers:e,result:t,strategy:_,forecast:ae,actionPlan:oe,opportunityRadar:U,commandCenter:z,copilot:J,collaboration:K,communityBenchmarks:Q,drawData:{...o,source:c?.tier||"unknown"},categoryInfo:a}),[oe,a,o,e,K,z,Q,J,c?.tier,ae,U,t,_]);const ot=Math.max(...se.map(m=>m.score||0),600);g.useMemo(()=>{const m=_.globalRiskFlags?.some(ee=>ee.severity==="high"),N=(_.profileSignals?.profileComplexity||0)>=70,A=(_.gap||0)>45,Z=m||_.top?.effort==="Hard"||(_.gap||0)>22;return A&&N?{tier:"pro",badge:"Priority recommendation",rationale:"Your profile looks high-complexity with a wider gap. Pro tracking helps reduce execution risk with tighter follow-through."}:Z?{tier:"pro",badge:"Recommended now",rationale:"You likely benefit from structured tracking and guided execution while closing your gap."}:{tier:"free",badge:"Sufficient for now",rationale:"Your current profile can continue with free tools while monitoring draw changes."}},[_.gap,_.globalRiskFlags,_.profileSignals?.profileComplexity,_.top?.effort]),_.optimizerConstraints,P.variant==="pro_first"?h("strategy.pricing.proCtaExperiment","Start Pro planning"):h("strategy.pricing.proCtaDefault","Go to Pro setup");const at=!1,it=!1,st=!1,ct=!1,De=!1,he=!1,lt=!1,dt=!1,ut=!1,pt=!1,ft=!1,mt=(m,N)=>{f(m),j("action_center_cta_clicked",{cta:N,target_section:m,confidence_band:_.confidenceBand,experiment_key:P.experimentKey,experiment_variant:P.variant})},gt=()=>{p?.(),j("action_center_cta_clicked",{cta:"manage_account",target_section:"account_modal",confidence_band:_.confidenceBand,experiment_key:P.experimentKey,experiment_variant:P.variant})};return S.jsxs(S.Fragment,{children:[S.jsxs("section",{className:"card",id:"section-save-bridge",children:[S.jsx("h3",{children:"Profile workspace"}),S.jsx("p",{className:"cat-intro",children:"Use the save panel below to store your current profile and draw alerts."}),S.jsxs("div",{className:"strategic-action-grid",children:[S.jsx("button",{type:"button",className:"action-btn",onClick:()=>mt("section-save","save_profile"),children:"Open save panel"}),S.jsx("button",{type:"button",className:"action-btn",onClick:gt,children:h("strategy.actionCenter.manageAccount","Manage account")})]}),!!s&&S.jsx("p",{className:"save-note",children:s})]}),pt,ft,b&&S.jsxs("section",{className:"card change-since-last-card",children:[S.jsx("h3",{children:h("strategy.changes.title","Since your last visit")}),S.jsxs("div",{className:"strategic-action-status",children:[S.jsxs("span",{children:["Score delta: ",S.jsxs("strong",{children:[b.scoreDelta>0?"+":"",b.scoreDelta]})]}),S.jsxs("span",{children:["Cutoff delta: ",S.jsxs("strong",{children:[b.cutoffDelta>0?"+":"",b.cutoffDelta]})]}),S.jsxs("span",{children:["Confidence delta: ",S.jsxs("strong",{children:[b.confidenceDelta>0?"+":"",b.confidenceDelta]})]})]}),b.previousUpdatedAt&&S.jsxs("p",{className:"save-note",children:["Previous snapshot: ",new Date(b.previousUpdatedAt).toLocaleString()]})]}),De,at,it,lt,dt,ut,ct,st,he,De,he,S.jsxs("section",{className:"card strategic-profile-trend",id:"section-profile-trend",children:[S.jsx("h3",{children:h("strategy.trend.title","Profile trend timeline")}),S.jsx("p",{className:"cat-intro",children:h("strategy.trend.subtitle","Track score movement across your saved snapshots and current profile.")}),!se.length&&S.jsx("p",{className:"save-note",children:"Save a few profiles to unlock your timeline view."}),!!se.length&&S.jsx("ul",{className:"profile-trend-list",children:se.map(m=>S.jsxs("li",{className:m.current?"current":"",children:[S.jsxs("div",{className:"profile-trend-label",children:[S.jsx("strong",{children:m.label}),m.current&&S.jsx("span",{className:"profile-trend-current",children:"Current"})]}),S.jsx("div",{className:"profile-trend-bar-wrap",children:S.jsx("span",{className:"profile-trend-bar",style:{width:`${Math.max(Math.min(Math.round(m.score/ot*100),100),5)}%`}})}),S.jsx("span",{className:"profile-trend-score",children:m.score})]},m.id))})]}),he]})}const $r=Object.freeze(Object.defineProperty({__proto__:null,default:Sr},Symbol.toStringTag,{value:"Module"}));export{Dr as I,Lr as L,$r as R,Br as a,Or as b,Ir as c,on as d,en as e,Ht as f,tn as g,Ot as h,Fr as i,Er as j,Tr as k,Dn as l,Fe as r,nn as s,j as t,bt as u};
