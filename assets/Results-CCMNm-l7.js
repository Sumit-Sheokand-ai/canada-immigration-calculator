const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/feature-path-coach-CtSDU3nA.js","assets/vendor-react-Ah1pgjPn.js","assets/data-question-bank-F-s7nTqV.js","assets/vendor-supabase-BZ0N5lZN.js","assets/vendor-motion-DURBmaq0.js"])))=>i.map(i=>d[i]);
import{t as S,u as pa,r as De,g as fa,l as We,L as Qe,a as ga,i as xa,s as ya,b as ba,_ as ja}from"./index-DMGRQAcb.js";import{r as f,j as e}from"./vendor-react-Ah1pgjPn.js";import{g as va,a as ka,r as ne,b as Na,h as wa,c as Sa,u as Ca,d as _a}from"./feature-path-coach-CtSDU3nA.js";import{v as Pa}from"./data-question-bank-F-s7nTqV.js";import{u as Ma,m as j,A as me}from"./vendor-motion-DURBmaq0.js";import"./vendor-supabase-BZ0N5lZN.js";function q(a,t,s,r,o,u,d=""){return{title:a,description:t,potentialGain:s,difficulty:r,timeframe:o,icon:u,action:d}}function Ea(a,t){const s=[],r=va(a),o=ka(a),u=a.firstOfficialLanguage==="french"?"french":"english",d=u==="french"||a.hasFrench==="yes";if(r<10){const p=Math.min(r+1,10),c=["listening","reading","writing","speaking"];let l="First official language";const x={};if(u==="french"){l="French (NCLC)",x.hasFrench="yes",x.frenchTestType="clb";for(const k of c){const w=`french_${k}`,P=parseInt(a[w],10)||0;x[w]=String(Math.max(P,p))}}else{l=a.langTestType==="celpip"?"CELPIP":"IELTS";for(const k of c){const w=a.langTestType==="celpip"?`celpip_${k}`:`ielts_${k}`,P=a.langTestType==="celpip"?parseInt(a[w],10)||0:parseFloat(a[w])||0;a.langTestType==="celpip"?x[w]=Math.max(P,p):x[w]=Math.max(P,P+.5)}}const y=ne(a,x).total-t.total;y>0&&s.push(q(`Improve ${l} Scores`,`Raising your weakest ${l} skill to CLB ${p} could add significant points. Focus on your lowest band.`,y,"Medium","3-5 months","language",`Current min CLB ${r} → target CLB ${p} = +${y} CRS`))}const m=["less_than_secondary","secondary","one_year_post","two_year_post","bachelors","two_or_more","masters","doctoral"],h=m.indexOf(a.education);if(h>=0&&h<m.length-1){const p=m[h+1],l=ne(a,{education:p}).total-t.total;if(l>0){const x={secondary:"high school diploma",one_year_post:"1-year diploma",two_year_post:"2-year diploma",bachelors:"bachelor's degree",two_or_more:"two credentials",masters:"master's degree",doctoral:"doctoral degree"};s.push(q("Higher Education",`Completing a ${x[p]||"higher credential"} could boost your score.`,l,"Hard","1-4 years","education",`${a.education||"current level"} → ${p} = +${l} CRS`))}}const g=parseInt(a.canadianWorkExp)||0;if(g<5){const c=ne(a,{canadianWorkExp:String(g+1)}).total-t.total;c>0&&s.push(q("Gain Canadian Work Experience","An additional year of Canadian work experience adds points across multiple categories including skill transferability.",c,"Hard","8-12 months","work",`${g} year(s) → ${g+1} year(s) = +${c} CRS`))}if(d)Na(a)>=7&&t.total<520&&t.total>=370&&s.push(q("Target French-Language Category Draw",`With your French NCLC 7+ scores, you qualify for French-language category draws where recent cutoffs are around 400 — your score of ${t.total} may already be competitive!`,0,"Easy","Immediate","french",`Current score ${t.total} already fits many French-category cutoffs`));else{const l=ne(a,{hasFrench:"yes",french_listening:"7",french_reading:"7",french_writing:"7",french_speaking:"7"}).total-t.total;l>0&&s.push(q("Add French Test Results (TEF/TCF)",`Strong French skills (NCLC 7+) earn ${o>=5?"50":"25"} additional CRS points. Plus, French-language category draws have cutoffs around 400 — much lower than general draws (~520).`,l,"Hard","6-12 months","french",`Reach NCLC 7 in all 4 abilities = +${l} CRS`))}if(a.hasPNP!=="yes"&&s.push(q("Provincial Nominee Program","A PNP nomination adds 600 points, virtually guaranteeing an ITA. Explore programs in provinces like Ontario, BC, Alberta and Saskatchewan.",600,"Hard","2-8 months","province","PNP nomination = +600 CRS")),a.canadianEducation!=="yes"&&s.push(q("Study in Canada","A Canadian credential (1-2 year program) adds 15 points, or 30 points for a 3+ year program.",30,"Hard","12-36 months","study","Canadian credential can add +15 to +30 CRS")),a.hasSibling!=="yes"&&s.push(q("Sibling in Canada (If Applicable)","If you have a sibling who is a Canadian citizen or PR, this adds 15 points. Check if any siblings qualify.",15,"Easy","1-2 weeks","family","Eligible sibling relationship = +15 CRS")),wa(a)){const p=["listening","reading","writing","speaking"];let c=99;for(const l of p){const x=parseInt(a[`spouseLang_${l}`])||0;x<c&&(c=x)}if(c<9){const l=Math.min(c+1,9),x={};for(const k of p)x[`spouseLang_${k}`]=String(Math.max(parseInt(a[`spouseLang_${k}`])||0,l));const y=ne(a,x).total-t.total;y>0&&s.push(q("Improve Spouse's Language Scores",`Your spouse's language improvement to CLB ${l} could add points.`,y,"Medium","3-5 months","language",`Spouse min CLB ${c} → ${l} = +${y} CRS`))}}return s.sort((p,c)=>c.potentialGain-p.potentialGain),s}function $a(a){const t=a.total;return t>=500?{label:"Very Strong",months:"1-3",description:"You are very likely to receive an ITA in the next few draws."}:t>=470?{label:"Strong",months:"3-6",description:"Your score is competitive. An ITA is likely within a few months."}:t>=440?{label:"Moderate",months:"6-12",description:"Your score is near recent cutoffs. Category-based draws may help."}:t>=400?{label:"Below Average",months:"12-18",description:"You may need to improve your profile or target a category-based draw."}:{label:"Needs Improvement",months:"18+",description:"Significant profile improvements are recommended before applying."}}const Fa=[{id:"on",name:"Ontario",abbr:"ON",streams:["Human Capital Priorities","Skilled Trades","French-Speaking"],demandSectors:["stem","healthcare","trade"],minCLB:7,minEducation:"bachelors",minWorkYears:1,notes:"Largest province. Strong demand for tech, healthcare, and skilled trades. Ontario often sends NOIs to Express Entry candidates with CRS 400+."},{id:"bc",name:"British Columbia",abbr:"BC",streams:["Skills Immigration","Express Entry BC","Tech"],demandSectors:["stem","healthcare","trade"],minCLB:5,minEducation:"two_year_post",minWorkYears:1,notes:"Tech hub (Vancouver). BC PNP Tech targets 29 in-demand occupations including software, data, and engineering roles."},{id:"ab",name:"Alberta",abbr:"AB",streams:["Alberta Advantage Immigration","Express Entry Stream"],demandSectors:["trade","healthcare","stem","transport"],minCLB:5,minEducation:"secondary",minWorkYears:1,notes:"Strong energy/oil sector. Growing tech scene in Calgary and Edmonton. Lower cost of living than ON/BC."},{id:"sk",name:"Saskatchewan",abbr:"SK",streams:["International Skilled Worker","Express Entry"],demandSectors:["agriculture","healthcare","trade","transport"],minCLB:4,minEducation:"secondary",minWorkYears:1,notes:"In-Demand Occupations list is broad. One of the easiest PNPs to qualify for. Agriculture and mining are key industries."},{id:"mb",name:"Manitoba",abbr:"MB",streams:["Skilled Workers Overseas","Skilled Workers in Manitoba"],demandSectors:["healthcare","agriculture","trade","transport"],minCLB:5,minEducation:"one_year_post",minWorkYears:1,notes:"Welcoming to newcomers. Strong need for healthcare workers and tradespeople. Lower CRS requirements than federal draws."},{id:"ns",name:"Nova Scotia",abbr:"NS",streams:["Labour Market Priorities","Skilled Worker","Physician"],demandSectors:["healthcare","trade","stem"],minCLB:5,minEducation:"one_year_post",minWorkYears:1,notes:"Part of Atlantic Immigration Program. Growing tech sector in Halifax. Healthcare workers are highly sought after."},{id:"nb",name:"New Brunswick",abbr:"NB",streams:["Express Entry Labour Market","Skilled Workers with Employer Support"],demandSectors:["healthcare","trade","agriculture"],minCLB:5,minEducation:"secondary",minWorkYears:1,notes:"Bilingual province (English/French). Part of Atlantic Immigration Program. Francophone candidates get priority."},{id:"pe",name:"Prince Edward Island",abbr:"PE",streams:["Express Entry","Labour Impact"],demandSectors:["agriculture","healthcare","trade"],minCLB:5,minEducation:"two_year_post",minWorkYears:2,notes:"Small province with lower competition. Agriculture and tourism are key industries."},{id:"nl",name:"Newfoundland & Labrador",abbr:"NL",streams:["Express Entry","Skilled Worker","Priority Skills"],demandSectors:["healthcare","trade","stem"],minCLB:5,minEducation:"one_year_post",minWorkYears:1,notes:"Part of Atlantic Immigration Program. Growing need for healthcare and tech workers. Oil and gas sector."},{id:"yt",name:"Yukon",abbr:"YT",streams:["Yukon Express Entry","Skilled Worker"],demandSectors:["trade","healthcare","transport"],minCLB:4,minEducation:"secondary",minWorkYears:1,notes:"Territory with small population. Job offer typically required. Good for tradespeople and healthcare workers."}],Ee={less_than_secondary:0,secondary:1,one_year_post:2,two_year_post:3,bachelors:4,two_or_more:5,masters:6,doctoral:7};function Aa(a,t){return(Ee[a]||0)>=(Ee[t]||0)}function La(a){const t=Ta(a),s=a.education||"secondary",r=Math.max(parseInt(a.canadianWorkExp)||0,parseInt(a.foreignWorkExp)||0),o=a.occupationCategory||"other",u=a.hasFrench==="yes";return Fa.map(d=>{let m=0;const h=100;t>=d.minCLB&&(m+=20,t>=d.minCLB+2&&(m+=10)),Aa(s,d.minEducation)&&(m+=15,(Ee[s]||0)>=4&&(m+=5)),r>=d.minWorkYears&&(m+=15,r>=3&&(m+=5)),d.demandSectors.includes(o)&&(m+=25),u&&(d.id==="nb"||d.id==="on")&&(m+=5);const g=Math.min(Math.round(m/h*100),100);return{...d,matchScore:g}}).sort((d,m)=>m.matchScore-d.matchScore)}function Ta(a){if(a.langTestType==="celpip"){const s=["listening","reading","writing","speaking"].map(r=>parseInt(a[`celpip_${r}`])||0);return Math.min(...s)}if(a.langTestType==="ielts"){const s=["listening","reading","writing","speaking"].map(r=>{const o=parseFloat(a[`ielts_${r}`])||0;return o>=8?10:o>=7?9:o>=6.5?8:o>=6?7:o>=5.5?6:o>=5?5:o>=4?4:0});return Math.min(...s)}return 0}const Xe="crs-saved-profiles-v1";function Ze(){try{const a=localStorage.getItem(Xe);if(!a)return{};const t=JSON.parse(a);return t&&typeof t=="object"?t:{}}catch{return{}}}function Ra(a){try{localStorage.setItem(Xe,JSON.stringify(a))}catch{}}function Ba(){const a=Math.random().toString(36).slice(2,8);return`prf_${Date.now().toString(36)}_${a}`}function Ia(){return`${Math.random().toString(36).slice(2,10)}${Math.random().toString(36).slice(2,10)}`}function ue(){const a=Ze();return Object.values(a).sort((t,s)=>String(s.updatedAt).localeCompare(String(t.updatedAt)))}function Da({id:a,name:t="",answers:s={},score:r=0,email:o="",alertOptIn:u=!1,alertToken:d=null}){const m=Ze(),h=a||Ba(),g=new Date().toISOString(),p=m[h],c={id:h,name:t||p?.name||`Profile ${h.slice(-4)}`,answers:s,score:r,email:o,alertOptIn:!!u,alertToken:u?d||p?.alertToken||Ia():null,createdAt:p?.createdAt||g,updatedAt:g};return m[h]=c,Ra(m),c}const ea="crs-90-day-action-plan-v1",Wa=1440*60*1e3,Oe={High:3,Medium:2,Low:1},B={impact:.34,speed:.18,confidence:.22,effort:.12,laneFit:.14};function $(a,t,s){return Math.max(t,Math.min(s,a))}function Oa(a,t){return`Day ${a}-${t}`}function W(a,t=0){const s=Number(a);return Number.isFinite(s)?s:t}function ie(a,t=0){const s=parseInt(a,10);return Number.isFinite(s)?s:t}function Ga(a=new Date){const t=new Date(a);return t.setHours(0,0,0,0),t}function fe(a,t){return new Date(a.getTime()+t*Wa)}function $e(a){try{return a.toLocaleDateString(void 0,{month:"short",day:"numeric"})}catch{return a.toISOString().slice(0,10)}}function pe(a,t,s){const r=fe(a,Math.max(t-1,0)),o=fe(a,Math.max(s-1,0));return{startDateIso:r.toISOString(),endDateIso:o.toISOString(),weekWindow:`Week ${Math.ceil(t/7)}-${Math.ceil(s/7)}`,dateWindow:`${$e(r)} → ${$e(o)}`}}function Ha(a,t){const s=W(t);return a==="listening"?s>=8.5?10:s>=8?9:s>=7.5?8:s>=6?7:s>=5.5?6:s>=5?5:0:a==="reading"?s>=8?10:s>=7?9:s>=6.5?8:s>=6?7:s>=5?6:s>=4?5:0:s>=7.5?10:s>=7?9:s>=6.5?8:s>=6?7:s>=5.5?6:s>=5?5:0}function Ya(a={}){const t=["listening","reading","writing","speaking"],s=a.firstOfficialLanguage==="french",o=t.map(u=>s?ie(a[`french_${u}`],0):a.langTestType==="celpip"?ie(a[`celpip_${u}`],0):Ha(u,a[`ielts_${u}`])).filter(u=>u>0);return o.length?Math.min(...o):0}function I(a,t,s,r="medium"){return{id:a,label:t,detail:s,severity:r}}function za(a){return a==="high"?10:a==="medium"?5:2}function Ua(a="Medium"){return a==="Easy"?100:a==="Medium"?68:38}function qa(a=0){return a>=76?"High":a>=56?"Medium":"Low"}function Va(a={},t,s){const r=W(t?.total),o=s-r,u=ie(a.age,0),d=Ya(a),m=a.hasFrench==="yes"||a.firstOfficialLanguage==="french",h=ie(a.canadianWorkExp,0),g=ie(a.foreignWorkExp,0),p=d>=9?18:d>=7?46:74,c=$((u>=33?28:14)+(d<7?26:d<9?16:6)+(h===0?12:4)+(g>=3?8:3),10,90),l=[{key:"answers_accuracy",label:"Profile values are accurate and complete",confidence:a.knowsScore==="yes"?"Medium":"High"},{key:"draw_trend_stability",label:"Recent draw patterns remain directionally similar",confidence:Math.abs(o)<=20?"Medium":"Low"},{key:"execution_discipline",label:"You can sustain weekly execution cadence for 90 days",confidence:c<=45?"High":c<=65?"Medium":"Low"}],x=[];return u>=33&&x.push(I("risk-age-decay","Age-point decay risk","Delays can reduce score as age thresholds change.",u>=38?"high":"medium")),d>0&&d<7&&x.push(I("risk-language-floor","Language floor below CLB 7","Several lanes become weaker or inaccessible below CLB 7.","high")),m||x.push(I("risk-no-french","No French upside yet","You may miss lower-cutoff category opportunities tied to French strength.","low")),o>40&&x.push(I("risk-large-gap","Large score gap","A single action may not close this gap; a combination strategy is likely required.","high")),{score:r,gap:o,age:u,minLanguageClb:d,hasFrench:m,canadianWorkExp:h,foreignWorkExp:g,languageHeadroom:p,profileComplexity:c,assumptions:l,globalRiskFlags:x}}function aa(a={}){const t=[a.age,a.education,a.pathway,a.canadianWorkExp,a.foreignWorkExp,a.hasFrench,a.hasPNP].join("|");let s=0;for(let r=0;r<t.length;r+=1)s=(s<<5)-s+t.charCodeAt(r),s|=0;return Math.abs(s).toString(16)}function Ja(a,t,s){const r=a.category==="Language"?50+t.languageHeadroom*.45:a.category==="Provincial"?72:a.category==="Combination"?76:60,o=$(r+(a.goalReached?8:0)+(a.likelihoodPercent-50)*.35,30,95),u=[];return a.estimatedMonths>=10&&u.push(I(`${a.id}-timeline`,"Long timeline","This lane can take substantial time before score impact materializes.","medium")),a.difficulty==="Hard"&&u.push(I(`${a.id}-effort`,"Execution intensity","Consistent weekly effort is required to avoid plan drift.","medium")),!a.goalReached&&s>0&&u.push(I(`${a.id}-bridge`,"May require a second lane","This lane may need a backup action to fully close your gap.","low")),{id:`path-${a.id}`,title:a.title,lane:a.category,reason:a.whyItFits,scoreGain:a.potentialGain,months:a.estimatedMonths,confidence:a.likelihoodPercent,effort:a.difficulty,laneFit:o,riskFlags:u}}function Ka({score:a,cutoff:t,eligibleCount:s,signals:r}){const o=t-a,u=o<=0?82:o<=20?64:38,d=[];return s||d.push(I("category-not-eligible","Not category-eligible yet","A prerequisite profile change is required before this lane can be used.","high")),o>35&&d.push(I("category-gap","Gap still material","Category targeting helps, but the score gap remains significant.","medium")),{id:"lane-category-draws",title:"Category Draw Positioning",lane:"Category Draws",reason:s>0?`You match ${s} category stream(s). Improve targeted factors to close the category cutoff gap.`:"You are not currently category-eligible; targeted profile adjustments can unlock lower-cutoff streams.",scoreGain:$(Math.round(Math.max(o,0)*.5),0,80),months:o<=0?1:o<=20?4:8,confidence:u,effort:o<=0?"Easy":o<=20?"Medium":"Hard",laneFit:$((s>0?70:35)+(r.hasFrench?8:0),25,90),riskFlags:d}}function Qa(a){if(!a)return null;const t=[];return a.matchScore<55&&t.push(I(`province-${a.id}-fit`,"Lower province fit","Province alignment is currently moderate; stream targeting needs tighter matching.","high")),a.matchScore>=55&&a.matchScore<70&&t.push(I(`province-${a.id}-variance`,"Selection variance","Provincial intake criteria can shift and may require profile tuning.","medium")),{id:`lane-province-${a.id}`,title:`${a.name} PNP Focus`,lane:"Provincial",reason:`${a.name} has the highest profile match in your province analysis.`,scoreGain:a.matchScore>=70?600:300,months:a.matchScore>=70?6:9,confidence:$(a.matchScore,35,88),effort:a.matchScore>=70?"Medium":"Hard",laneFit:$(a.matchScore+(a.matchScore>=70?6:-4),25,95),riskFlags:t}}function Xa(a={},t=0){return[{key:"coreHumanCapital",label:"Core profile factors",value:W(a.coreHumanCapital)},{key:"skillTransferability",label:"Transferability factors",value:W(a.skillTransferability)},{key:"additionalPoints",label:"Additional point factors",value:W(a.additionalPoints)},{key:"spouseFactors",label:"Spouse factors",value:W(a.spouseFactors)}].map(r=>({...r,headroom:$(100-Math.round(r.value/Math.max(t,1)*100),0,100)})).sort((r,o)=>o.headroom-r.headroom).slice(0,2)}function Za(a,t){const s=Math.max(Math.abs(t),35),r=$(Math.round(a.scoreGain/s*100),8,100),o=$(100-a.months*11,12,100),u=$(a.confidence,12,100),d=Ua(a.effort),m=$(W(a.laneFit,60),10,100),h=r*B.impact+o*B.speed+u*B.confidence+d*B.effort+m*B.laneFit,g=Array.isArray(a.riskFlags)?a.riskFlags:[],p=$(g.reduce((l,x)=>l+za(x.severity),0),0,24),c=$(Math.round(h-p),1,100);return{...a,score:c,riskPenalty:p,scoreBreakdown:[{key:"impact",label:"Impact potential",value:r,weight:B.impact},{key:"speed",label:"Speed to value",value:o,weight:B.speed},{key:"confidence",label:"Data confidence",value:u,weight:B.confidence},{key:"effort",label:"Execution ease",value:d,weight:B.effort},{key:"laneFit",label:"Profile-lane fit",value:m,weight:B.laneFit}]}}function et({answers:a,result:t,averageCutoff:s,categoryInfo:r=[],provinces:o=[]}){const u=W(t?.total),d=W(s,520),m=d-u,h=Va(a,t,d),p=(Sa(a,t,{averageCutoff:d}).plans||[]).slice(0,2).map(i=>Ja(i,h,m)),c=r.filter(i=>typeof i?.check=="function"&&i.check(a)).length,l=Ka({score:u,cutoff:d,eligibleCount:c,signals:h}),x=Qa((o||[])[0]||null),y=[...p,l,x].filter(Boolean).map(i=>Za(i,m)).sort((i,v)=>v.score-i.score).slice(0,4),k=y[0]||null,w=y[1]||null,P=Xa(t?.breakdown,u),K=[...h.globalRiskFlags||[],...y.slice(0,2).flatMap(i=>i.riskFlags||[])],_=Object.values(K.reduce((i,v)=>(v?.id&&(i[v.id]||(i[v.id]=v)),i),{})).slice(0,5),G=y.slice(0,2).map(i=>$(i.confidence-i.riskPenalty,0,100)),F=G.length?Math.round(G.reduce((i,v)=>i+v,0)/G.length):36,V=qa(F),se=k?`Primary lane: ${k.title}. Estimated gain ${k.scoreGain} points in ~${k.months} months (${V.toLowerCase()} confidence).`:"No strong lane detected yet. Start by improving language and category eligibility.";return{score:u,cutoff:d,gap:m,ranked:y,top:k,nextBest:w,bottlenecks:P,assumptions:h.assumptions,globalRiskFlags:_,overallConfidence:F,confidenceBand:V,profileSignals:{minLanguageClb:h.minLanguageClb,profileComplexity:h.profileComplexity,languageHeadroom:h.languageHeadroom},scoreWeights:B,guidanceSummary:se}}function te(a,t,s,r,o,u,d,m="Medium",h,g={}){const{startDateIso:p,endDateIso:c,weekWindow:l,dateWindow:x}=pe(h,r,o);return{id:a,title:t,rationale:s,window:Oa(r,o),dayFrom:r,dayTo:o,impact:u,lane:d,priority:m,startDateIso:p,endDateIso:c,weekWindow:l,dateWindow:x,successMetric:g.successMetric||"Task completed with verified profile update.",checkpoint:g.checkpoint||"Run a score recalculation and note delta.",dependencies:g.dependencies||[],cadence:g.cadence||"3 focused sessions per week"}}function at({suggestions:a=[],strategy:t,scoreGap:s=0,progress:r={}}){const o=a[1],u=t?.top?.title||"Profile Optimization",d=Math.max(W(s),0),m=Ga(new Date),h=[te("plan-baseline","Lock baseline and target score",`Set a concrete target and freeze your baseline profile to avoid random changes. Current gap: ${d} points.`,1,7,0,u,"High",m,{successMetric:"Target score and top lane documented; baseline snapshot saved.",checkpoint:"Save profile with date tag and score target.",cadence:"One 45-minute planning block + one review"}),te("plan-primary-lane",`Execute primary lane: ${u}`,t?.top?.reason||"Follow the highest-impact lane identified by optimizer.",8,30,t?.top?.scoreGain||10,u,"High",m,{successMetric:`Deliver at least 60% of ${u} milestones.`,checkpoint:"Verify measurable progress (test booking, docs, submissions, etc.)."}),te("plan-secondary-lane",o?`Secondary boost: ${o.title}`:"Secondary boost: language and profile precision",o?.description||"Add one additional improvement path to reduce draw uncertainty.",24,50,o?.potentialGain||8,o?.title||"Secondary path","Medium",m,{successMetric:"Secondary lane started with first concrete deliverable completed.",checkpoint:"Compare score delta before/after secondary-lane kickoff.",dependencies:["plan-primary-lane"]}),te("plan-document-pack","Prepare immigration document pack","Collect and verify key documents (identity, education, work proofs, test reports, proof-of-funds readiness).",35,68,0,"Readiness","High",m,{successMetric:"Core document checklist reaches 90% readiness.",checkpoint:"Review missing docs and issue dates.",cadence:"Two short admin sessions weekly"}),te("plan-risk-buffer","Activate fallback lane if progress stalls","If progress velocity is below target, start a backup action immediately (e.g., category-specific adjustment or province-first route).",55,80,6,"Fallback Control","Medium",m,{successMetric:"Fallback lane is selected and started within 7 days of stall signal.",checkpoint:"Mark stall trigger if expected gain is short by 20%+.",dependencies:["plan-primary-lane"]}),te("plan-profile-audit","Profile audit and draw readiness check","Re-evaluate score vs latest draws and category cutoffs. Trigger fallback lane if gap remains above 15 points.",75,90,0,"Risk Control","High",m,{successMetric:"Final 90-day readiness review completed with go/no-go decision.",checkpoint:"Capture current score, active cutoff delta, and next 30-day plan.",dependencies:["plan-document-pack"]})],g=[{label:"Days 1-30",objective:"Baseline lock + launch primary lane",expectedGain:h[1].impact,dateWindow:pe(m,1,30).dateWindow},{label:"Days 31-60",objective:"Add secondary lane + document readiness",expectedGain:h[2].impact,dateWindow:pe(m,31,60).dateWindow},{label:"Days 61-90",objective:"Fallback control + final draw readiness review",expectedGain:h[4].impact,dateWindow:pe(m,61,90).dateWindow}],p=h.filter(k=>!!r[k.id]).length,c=h.length,l=c>0?Math.round(p/c*100):0,x=[...h].filter(k=>!r[k.id]).sort((k,w)=>{const P=Oe[w.priority]-Oe[k.priority];return P!==0?P:k.dayFrom-w.dayFrom})[0]||null,O=l>=100?"All action-plan tasks are complete. Keep a weekly score monitor to stay draw-ready.":x?`Next best task: ${x.title} (${x.dateWindow}).`:"Continue progressing through the plan in order of priority.",y=[14,30,60,90].map(k=>{const w=fe(m,k-1);return{day:k,iso:w.toISOString(),label:$e(w)}});return{tasks:h,milestones:g,completedCount:p,totalCount:c,completionPct:l,nextBestTask:x,completionGuidance:O,calendar:{planStartIso:m.toISOString(),planEndIso:fe(m,89).toISOString(),reviewDates:y}}}function Ge(a={}){if(typeof window>"u")return{};const t=`${ea}:${aa(a)}`;try{const s=window.localStorage.getItem(t);return s?JSON.parse(s):{}}catch{return{}}}function tt(a={},t={}){if(typeof window>"u")return;const s=`${ea}:${aa(a)}`;try{window.localStorage.setItem(s,JSON.stringify(t||{}))}catch{}}function nt({value:a}){const t=a==="High"?"priority-high":a==="Medium"?"priority-medium":"priority-low";return e.jsx("span",{className:`priority-badge ${t}`,children:a})}function He({value:a}){const t=a==="Easy"?"effort-easy":a==="Medium"?"effort-medium":"effort-hard";return e.jsx("span",{className:`effort-badge ${t}`,children:a})}function Ye({value:a}){const t=a==="high"?"risk-high":a==="medium"?"risk-medium":"risk-low";return e.jsx("span",{className:`risk-badge ${t}`,children:a})}function st(a=""){return a==="High"?"assumption-high":a==="Medium"?"assumption-medium":"assumption-low"}function it(a){return a==="free"?"Free":a==="advisor"?"Advisor Mode":"Pro Tracking"}function rt({answers:a,result:t,suggestions:s,averageCutoff:r,activeDraws:o,activeCategoryInfo:u,provinces:d,drawFreshness:m,categoryFreshness:h,saveStatus:g,onJumpToSection:p,onOpenAccount:c}){const l=f.useMemo(()=>et({answers:a,result:t,averageCutoff:r,categoryInfo:u,provinces:d}),[u,a,r,d,t]),[x,O]=f.useState(()=>Ge(a));f.useEffect(()=>{O(Ge(a))},[a]);const y=f.useMemo(()=>at({suggestions:s,strategy:l,scoreGap:Math.max((r||0)-(t?.total||0),0),progress:x}),[r,x,t?.total,l,s]),k=y.completedCount||0,w=y.totalCount||y.tasks.length,P=y.completionPct||0,K=[{label:"Core Human Capital",value:t?.breakdown?.coreHumanCapital||0},{label:"Skill Transferability",value:t?.breakdown?.skillTransferability||0},{label:"Additional Points",value:t?.breakdown?.additionalPoints||0},{label:"Spouse Factors",value:t?.breakdown?.spouseFactors||0}].sort((i,v)=>v.value-i.value).slice(0,3),_=f.useMemo(()=>{const i=l.globalRiskFlags?.some(H=>H.severity==="high"),v=(l.profileSignals?.profileComplexity||0)>=70,A=(l.gap||0)>45,Z=i||l.top?.effort==="Hard"||(l.gap||0)>22;return A&&v?{tier:"advisor",badge:"Best for complex case",rationale:"Your profile looks high-complexity with a wider gap. Advisor workflows may reduce execution risk."}:Z?{tier:"pro",badge:"Recommended now",rationale:"You likely benefit from structured tracking and guided execution while closing your gap."}:{tier:"free",badge:"Sufficient for now",rationale:"Your current profile can continue with free tools while monitoring draw changes."}},[l.gap,l.globalRiskFlags,l.profileSignals?.profileComplexity,l.top?.effort]),G=l.globalRiskFlags?.some(i=>i.severity==="high")?"Elevated":l.globalRiskFlags?.some(i=>i.severity==="medium")?"Moderate":"Low",F=(i,v)=>{p(i),S("action_center_cta_clicked",{cta:v,target_section:i,confidence_band:l.confidenceBand})},V=()=>{c?.(),S("action_center_cta_clicked",{cta:"manage_account",target_section:"account_modal",confidence_band:l.confidenceBand})},se=i=>{const v={...x,[i]:!x[i]};O(v),tt(a,v);const A=y.tasks.filter(H=>!!v[H.id]).length,Z=y.tasks.length>0?Math.round(A/y.tasks.length*100):0;S("action_plan_task_toggled",{task_id:i,completed:!!v[i],completion_pct:Z,completed_count:A,total_count:y.tasks.length,next_task_id:y.nextBestTask?.id||"none"})};return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"card strategic-action-center",id:"section-action-center",children:[e.jsx("h3",{children:"Action Center"}),e.jsx("p",{className:"cat-intro",children:"Use this control center to execute the highest-impact moves with clear priority and risk visibility."}),e.jsxs("div",{className:"strategic-action-grid",children:[e.jsx("button",{type:"button",className:"action-btn",onClick:()=>F("section-save","save_profile"),children:"Save profile"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>F("section-optimizer","open_optimizer"),children:"Open strategy optimizer"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>F("section-90-day-plan","open_90_day_plan"),children:"Open 90-day plan"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>F("section-pricing","compare_plans"),children:"Compare plans"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>F("section-coach","expert_strategy_coach"),children:"Expert strategy coach"}),e.jsx("button",{type:"button",className:"action-btn",onClick:V,children:"Manage account"})]}),e.jsxs("div",{className:"strategic-action-status",children:[e.jsxs("span",{children:["Profile save status: ",e.jsx("strong",{children:g||"Not saved yet"})]}),e.jsxs("span",{children:["90-day completion: ",e.jsxs("strong",{children:[P,"%"]})," (",k,"/",w,")"]}),e.jsxs("span",{children:["Confidence: ",e.jsx("strong",{children:l.confidenceBand})," (",l.overallConfidence," / 100)"]}),e.jsxs("span",{children:["Risk level: ",e.jsx("strong",{children:G})]})]}),y.nextBestTask&&e.jsxs("div",{className:"next-task-callout",children:[e.jsxs("div",{children:[e.jsxs("strong",{children:["Next best task: ",y.nextBestTask.title]}),e.jsxs("p",{children:[y.nextBestTask.dateWindow," · ",y.nextBestTask.weekWindow]}),e.jsx("small",{children:y.nextBestTask.successMetric})]}),e.jsx("button",{type:"button",className:"action-btn auth-btn-primary",onClick:()=>F("section-90-day-plan","next_best_task"),children:"Start task"})]})]}),e.jsxs("section",{className:"card strategic-optimizer",id:"section-optimizer",children:[e.jsx("h3",{children:"Strategy Optimizer"}),e.jsx("p",{className:"cat-intro",children:l.guidanceSummary}),l.top&&e.jsxs("div",{className:"optimizer-top-callout",children:[e.jsxs("div",{className:"optimizer-option-head",children:[e.jsxs("strong",{children:["Top lane: ",l.top.title]}),e.jsxs("span",{className:"optimizer-score",children:["Priority ",l.top.score,"/100"]})]}),e.jsx("p",{children:l.top.reason}),e.jsxs("div",{className:"optimizer-meta",children:[e.jsxs("span",{children:["Estimated gain: +",l.top.scoreGain]}),e.jsxs("span",{children:["Expected timeline: ~",l.top.months," months"]}),e.jsxs("span",{children:["Confidence: ",l.top.confidence,"%"]}),e.jsx(He,{value:l.top.effort})]}),!!l.top.riskFlags?.length&&e.jsx("ul",{className:"optimizer-risk-list",children:l.top.riskFlags.map(i=>e.jsxs("li",{children:[e.jsx(Ye,{value:i.severity}),e.jsx("span",{children:i.label})]},i.id))})]}),e.jsx("div",{className:"optimizer-options",children:l.ranked.map((i,v)=>e.jsxs("article",{className:"optimizer-option",children:[e.jsxs("div",{className:"optimizer-option-head",children:[e.jsxs("strong",{children:[v+1,". ",i.title]}),e.jsxs("div",{className:"optimizer-option-end",children:[e.jsxs("span",{className:"optimizer-score",children:["Score ",i.score]}),e.jsx(He,{value:i.effort})]})]}),e.jsx("p",{children:i.reason}),e.jsxs("div",{className:"optimizer-meta",children:[e.jsxs("span",{children:["Lane: ",i.lane]}),e.jsxs("span",{children:["+",i.scoreGain," pts"]}),e.jsxs("span",{children:[i.months," mo"]}),e.jsxs("span",{children:[i.confidence,"% confidence"]})]})]},i.id))})]}),e.jsxs("section",{className:"card strategic-plan",id:"section-90-day-plan",children:[e.jsx("h3",{children:"90-Day Action Plan"}),e.jsx("p",{className:"cat-intro",children:"Execution-focused milestones with calendar windows, measurable outcomes, and fallback controls."}),e.jsx("p",{className:"plan-guidance",children:y.completionGuidance}),e.jsx("div",{className:"plan-review-dates",children:y.calendar?.reviewDates?.map(i=>e.jsxs("span",{children:["Review D",i.day,": ",i.label]},i.day))}),e.jsx("div",{className:"plan-milestones",children:y.milestones.map(i=>e.jsxs("div",{className:"plan-milestone",children:[e.jsx("strong",{children:i.label}),e.jsx("p",{children:i.objective}),e.jsx("small",{children:i.dateWindow}),e.jsxs("small",{children:["Expected gain: +",i.expectedGain," pts"]})]},i.label))}),e.jsx("ul",{className:"plan-task-list",children:y.tasks.map(i=>{const v=!!x[i.id],A=y.nextBestTask?.id===i.id&&!v;return e.jsxs("li",{className:`${v?"done":""} ${A?"next-task":""}`.trim(),children:[e.jsx("button",{type:"button",className:"plan-task-toggle",onClick:()=>se(i.id),"aria-label":`Toggle ${i.title}`,children:v?"✓":"○"}),e.jsxs("div",{children:[e.jsxs("div",{className:"plan-task-head",children:[e.jsx("strong",{children:i.title}),e.jsx(nt,{value:i.priority})]}),e.jsx("p",{children:i.rationale}),e.jsxs("div",{className:"optimizer-meta",children:[e.jsx("span",{children:i.window}),e.jsx("span",{children:i.weekWindow}),e.jsx("span",{children:i.dateWindow}),e.jsxs("span",{children:["Lane: ",i.lane]}),e.jsxs("span",{children:["Impact: +",i.impact," pts"]})]}),e.jsxs("small",{className:"plan-task-metric",children:["Success metric: ",i.successMetric]}),e.jsxs("small",{className:"plan-task-metric",children:["Checkpoint: ",i.checkpoint]})]})]},i.id)})})]}),e.jsxs("section",{className:"card strategic-pricing",id:"section-pricing",children:[e.jsx("h3",{children:"Plans & Upgrade Path"}),e.jsx("p",{className:"cat-intro",children:"Choose support depth based on your current gap, risk profile, and execution complexity."}),e.jsxs("div",{className:"pricing-recommendation-banner",children:[e.jsxs("strong",{children:[_.badge,": ",it(_.tier)]}),e.jsx("p",{children:_.rationale})]}),e.jsxs("div",{className:"pricing-grid",children:[e.jsxs("article",{className:`pricing-tier ${_.tier==="free"?"recommended":""}`,children:[_.tier==="free"&&e.jsx("span",{className:"pricing-reco-badge",children:"Best fit now"}),e.jsx("h4",{children:"Free"}),e.jsx("strong",{children:"0 CAD"}),e.jsxs("ul",{children:[e.jsx("li",{children:"CRS scoring + basic suggestions"}),e.jsx("li",{children:"Scenario compare"}),e.jsx("li",{children:"Local profile save"})]}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>{S("pricing_cta_clicked",{tier:"free",recommended:_.tier==="free"}),F("section-optimizer","continue_free")},children:"Continue with Free"})]}),e.jsxs("article",{className:`pricing-tier featured ${_.tier==="pro"?"recommended":""}`,children:[_.tier==="pro"&&e.jsx("span",{className:"pricing-reco-badge",children:"Recommended"}),e.jsx("h4",{children:"Pro Tracking"}),e.jsx("strong",{children:"5 CAD / month"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Expert strategy coach"}),e.jsx("li",{children:"Daily action tracking"}),e.jsx("li",{children:"Cloud sync + alerts"})]}),e.jsx("button",{type:"button",className:"action-btn auth-btn-primary",onClick:()=>{S("pricing_cta_clicked",{tier:"pro_tracking",recommended:_.tier==="pro"}),F("section-coach","go_to_pro_setup")},children:"Go to Pro setup"})]}),e.jsxs("article",{className:`pricing-tier ${_.tier==="advisor"?"recommended":""}`,children:[_.tier==="advisor"&&e.jsx("span",{className:"pricing-reco-badge",children:"Complex-case fit"}),e.jsx("h4",{children:"Advisor Mode"}),e.jsx("strong",{children:"Coming soon"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Multi-profile management"}),e.jsx("li",{children:"Team workflows"}),e.jsx("li",{children:"Priority insights"})]}),e.jsx("a",{className:"action-btn action-link-btn",href:"/guides.html",onClick:()=>S("pricing_cta_clicked",{tier:"advisor_mode_waitlist",recommended:_.tier==="advisor"}),children:"View Advisor playbooks"})]})]})]}),e.jsxs("section",{className:"card strategic-explainability",id:"section-explainability",children:[e.jsx("h3",{children:"Explainability & Confidence"}),e.jsx("p",{className:"cat-intro",children:"Structured reasoning for lane ranking, confidence, and risk assumptions."}),e.jsxs("div",{className:"explain-grid",children:[e.jsxs("article",{children:[e.jsx("h4",{children:"Top score drivers"}),e.jsx("ul",{children:K.map(i=>e.jsxs("li",{children:[e.jsx("span",{children:i.label}),e.jsx("strong",{children:i.value})]},i.label))})]}),e.jsxs("article",{children:[e.jsx("h4",{children:"Recommendation score factors"}),e.jsx("ul",{className:"explain-factor-list",children:(l.top?.scoreBreakdown||[]).map(i=>e.jsxs("li",{children:[e.jsxs("div",{className:"explain-factor-head",children:[e.jsx("span",{children:i.label}),e.jsx("strong",{children:i.value})]}),e.jsx("div",{className:"explain-factor-track",children:e.jsx("span",{className:"explain-factor-fill",style:{width:`${i.value}%`}})}),e.jsxs("small",{children:["Weight: ",Math.round((i.weight||0)*100),"%"]})]},i.key))})]}),e.jsxs("article",{children:[e.jsx("h4",{children:"Data confidence"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Overall confidence: ",e.jsxs("strong",{children:[l.confidenceBand," (",l.overallConfidence,"/100)"]})]}),e.jsxs("li",{children:["Draw freshness: ",e.jsx("strong",{children:m?.label||"Unknown"})]}),e.jsxs("li",{children:["Category freshness: ",e.jsx("strong",{children:h?.label||"Unknown"})]}),e.jsxs("li",{children:["Draw source snapshot: ",e.jsx("strong",{children:o?.lastUpdated||"Unavailable"})]})]})]}),e.jsxs("article",{children:[e.jsx("h4",{children:"Assumptions used"}),e.jsx("ul",{className:"assumption-list",children:(l.assumptions||[]).map(i=>e.jsxs("li",{children:[e.jsx("span",{children:i.label}),e.jsx("strong",{className:st(i.confidence),children:i.confidence})]},i.key))})]}),e.jsxs("article",{children:[e.jsx("h4",{children:"Risk indicators"}),e.jsxs("ul",{className:"risk-indicator-list",children:[(l.globalRiskFlags||[]).map(i=>e.jsxs("li",{children:[e.jsxs("div",{children:[e.jsx("strong",{children:i.label}),e.jsx("small",{children:i.detail})]}),e.jsx(Ye,{value:i.severity})]},i.id)),!l.globalRiskFlags?.length&&e.jsx("li",{children:"No major risk flags detected."})]})]}),e.jsxs("article",{children:[e.jsx("h4",{children:"Trust cues"}),e.jsxs("div",{className:"trust-inline-cues",children:[e.jsx("span",{children:"Estimate model only"}),e.jsx("span",{children:"No legal advice"}),e.jsx("span",{children:"Review official IRCC before filing"})]}),e.jsxs("p",{className:"save-note",children:["Review governance in the ",e.jsx("a",{href:"/trust.html",children:"Trust Center"}),", implementation guides in ",e.jsx("a",{href:"/guides.html",children:"Guides"}),", and rights controls in ",e.jsx("a",{href:"/privacy.html",children:"Privacy Policy"}),"."]})]})]})]})]})}const ot=f.lazy(()=>ja(()=>import("./feature-path-coach-CtSDU3nA.js").then(a=>a.P),__vite__mapDeps([0,1,2,3,4]))),ze={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.08}}},C={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:18}}};function Ue(a){return a==="supabase"?"Live sync":"Local fallback"}function qe(a){return a==="supabase"?"draw-source-live":"draw-source-fallback"}function ta(a){if(!a)return null;const t=new Date(a);return Number.isNaN(t.getTime())?null:t}function Ve(a){const t=ta(a);if(!t)return{tier:"unknown",label:"Freshness unknown",dateLabel:a||"—"};const r=Math.max(new Date().getTime()-t.getTime(),0),o=Math.floor(r/(1e3*60*60*24)),u=o===0?"Updated today":o===1?"Updated 1 day ago":`Updated ${o} days ago`;return o<=2?{tier:"fresh",label:u,dateLabel:t.toLocaleDateString()}:o<=14?{tier:"recent",label:u,dateLabel:t.toLocaleDateString()}:{tier:"stale",label:u,dateLabel:t.toLocaleDateString()}}function Je(a={}){return[{label:"Age",value:a.age||"—"},{label:"Education",value:a.education||"—"},{label:"Language test",value:a.langTestType||"—"},{label:"Canadian work",value:a.canadianWorkExp||"0"},{label:"Program",value:a.pathway||"—"}]}function ct({value:a,duration:t=1.2,reduceMotion:s=!1}){const[r,o]=f.useState(a);return f.useEffect(()=>{if(s)return;const u=a,d=performance.now(),m=h=>{const g=(h-d)/(t*1e3);if(g>=1){o(u);return}const p=1-Math.pow(1-g,3);o(Math.round(u*p)),requestAnimationFrame(m)};requestAnimationFrame(m)},[a,t,s]),s?e.jsx(e.Fragment,{children:a}):e.jsx(e.Fragment,{children:r})}function lt({score:a,statusColor:t,reduceMotion:s=!1}){const o=2*Math.PI*54,u=Math.min(a/1200,1);return e.jsxs("div",{className:"score-gauge","aria-label":`CRS Score: ${a} out of 1200`,children:[e.jsxs("svg",{viewBox:"0 0 120 120",width:"180",height:"180",children:[e.jsx("circle",{cx:"60",cy:"60",r:54,fill:"none",stroke:"var(--surface-2)",strokeWidth:"8"}),e.jsx(j.circle,{cx:"60",cy:"60",r:54,fill:"none",stroke:t,strokeWidth:"8",strokeLinecap:"round",transform:"rotate(-90 60 60)",strokeDasharray:o,initial:s?!1:{strokeDashoffset:o},animate:{strokeDashoffset:o-u*o},transition:s?{duration:0}:{duration:1.4,ease:[.22,1,.36,1]}})]}),e.jsxs("div",{className:"gauge-text",children:[e.jsx("div",{className:"gauge-number","aria-live":"polite",children:e.jsx(ct,{value:a,reduceMotion:s})}),e.jsx("div",{className:"gauge-max",children:"/ 1,200"})]})]})}function he({id:a,label:t,open:s,onToggle:r}){return e.jsx("h3",{className:"section-toggle-heading",children:e.jsxs("button",{type:"button",className:"section-toggle",onClick:r,"aria-expanded":s,"aria-controls":a,children:[e.jsx("span",{children:t}),e.jsx("span",{className:"toggle-arrow","aria-hidden":"true",children:"▾"})]})})}function dt({icon:a,label:t,value:s,max:r,note:o}){const u=Math.round(s/r*100);return e.jsxs(j.div,{className:"bd-item",variants:C,children:[e.jsx("span",{className:"bd-icon",children:a}),e.jsxs("div",{className:"bd-info",children:[e.jsxs("div",{className:"bd-top",children:[e.jsxs("span",{className:"bd-label",children:[t,o&&e.jsxs("small",{className:"bd-note",children:[" (",o,")"]})]}),e.jsxs("span",{className:"bd-pts",children:[s," ",e.jsxs("small",{children:["/ ",r]})]})]}),e.jsx("div",{className:"bd-bar-bg",children:e.jsx(j.div,{className:"bd-bar-fill",initial:{width:0},animate:{width:`${u}%`},transition:{duration:.8,delay:.3,ease:"easeOut"}})})]})]})}function Pe({draw:a,userScore:t}){const s=t>=a.score;return e.jsxs("div",{className:`draw-row ${s?"draw-above":"draw-below"}`,children:[e.jsx("span",{className:"draw-date",children:a.date}),e.jsx("span",{className:"draw-program",children:a.program}),e.jsx("span",{className:"draw-score",children:a.score})]})}const mt=[{value:"secondary",label:"High School"},{value:"one_year_post",label:"1-Year Diploma"},{value:"two_year_post",label:"2-Year Diploma"},{value:"bachelors",label:"Bachelor's"},{value:"two_or_more",label:"2+ Credentials"},{value:"masters",label:"Master's"},{value:"doctoral",label:"PhD"}];function Me(a,t,s){return{id:a,label:t,age:s.age||"",education:s.education||"",canadianWorkExp:s.canadianWorkExp||"0",minClb:""}}function ut(a){return{5:5,6:5.5,7:6,8:6.5,9:7,10:7.5}[a]||0}function ht(a,t){const s={};if(t.age&&t.age!==a.age&&(s.age=t.age),t.education&&t.education!==a.education&&(s.education=t.education),t.canadianWorkExp&&t.canadianWorkExp!==a.canadianWorkExp&&(s.canadianWorkExp=t.canadianWorkExp),t.minClb){const r=parseInt(t.minClb,10),o=["listening","reading","writing","speaking"];if(a.langTestType==="celpip")for(const u of o){const d=`celpip_${u}`;s[d]=String(Math.max(parseInt(a[d],10)||0,r))}else{const u=ut(r);for(const d of o){const m=`ielts_${d}`;s[m]=String(Math.max(parseFloat(a[m])||0,u))}}}return Object.keys(s).length===0?null:ne(a,s)}function pt({answers:a,originalScore:t,t:s}){const[r,o]=f.useState(()=>[Me("a","Scenario A",a),Me("b","Scenario B",a)]),u=()=>{r.length>=3||o(h=>[...h,Me("c","Scenario C",a)])},d=h=>{r.length<=2||o(g=>g.filter(p=>p.id!==h))},m=(h,g)=>{o(p=>p.map(c=>c.id===h?{...c,...g}:c))};return e.jsxs("div",{className:"scenario-panel",children:[e.jsx("div",{className:"scenario-grid",children:r.map(h=>{const g=ht(a,h),p=g?g.total-t:0;return e.jsxs("div",{className:"scenario-card",children:[e.jsxs("div",{className:"scenario-head",children:[e.jsx("strong",{children:h.label}),h.id==="c"&&e.jsx("button",{type:"button",className:"scenario-remove",onClick:()=>d(h.id),children:"Remove"})]}),e.jsxs("div",{className:"wi-grid",children:[e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Age"}),e.jsxs("select",{value:h.age,onChange:c=>m(h.id,{age:c.target.value}),children:[e.jsx("option",{value:"",children:"Current"}),Array.from({length:30},(c,l)=>l+18).map(c=>e.jsx("option",{value:c,children:c},c))]})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Education"}),e.jsxs("select",{value:h.education,onChange:c=>m(h.id,{education:c.target.value}),children:[e.jsx("option",{value:"",children:"Current"}),mt.map(c=>e.jsx("option",{value:c.value,children:c.label},c.value))]})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Canadian Work (yrs)"}),e.jsx("select",{value:h.canadianWorkExp,onChange:c=>m(h.id,{canadianWorkExp:c.target.value}),children:[0,1,2,3,4,5].map(c=>e.jsx("option",{value:c,children:c},c))})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Min Language CLB"}),e.jsxs("select",{value:h.minClb,onChange:c=>m(h.id,{minClb:c.target.value}),children:[e.jsx("option",{value:"",children:"Current"}),[5,6,7,8,9,10].map(c=>e.jsxs("option",{value:c,children:["CLB ",c,"+"]},c))]})]})]}),g&&e.jsx(j.div,{className:"wi-result",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"wi-scores",children:[e.jsxs("div",{className:"wi-score-block",children:[e.jsx("small",{children:s("results.original")}),e.jsx("strong",{children:t})]}),e.jsx("span",{className:"wi-arrow",children:"→"}),e.jsxs("div",{className:"wi-score-block projected",children:[e.jsx("small",{children:s("results.projected")}),e.jsx("strong",{children:g.total})]}),e.jsxs("span",{className:`wi-delta ${p>0?"pos":p<0?"neg":""}`,children:[p>0?"+":"",p," pts"]})]})})]},h.id)})}),r.length<3&&e.jsx("button",{type:"button",className:"btn-toggle scenario-add-btn",onClick:u,children:"Add Scenario C ▼"})]})}function ft(){return e.jsx(j.div,{className:"loading-screen",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,scale:.95,transition:{duration:.3}},children:e.jsx(Qe,{})})}function gt(a){const t=f.useRef(null);return f.useEffect(()=>{if(!a)return;const s=t.current;if(!s)return;const r=s.getContext("2d");s.width=window.innerWidth,s.height=window.innerHeight;const o=["#22c55e","#4CC9F0","#7C3AED","#f59e0b","#ec4899","#3A0CA3"],u=Array.from({length:120},()=>({x:Math.random()*s.width,y:Math.random()*s.height-s.height,w:Math.random()*8+4,h:Math.random()*6+2,color:o[Math.floor(Math.random()*o.length)],vx:(Math.random()-.5)*4,vy:Math.random()*3+2,rot:Math.random()*360,rv:(Math.random()-.5)*8}));let d;const m=()=>{r.clearRect(0,0,s.width,s.height);let g=!1;for(const p of u)p.x+=p.vx,p.y+=p.vy,p.rot+=p.rv,p.vy+=.05,p.y<s.height+20&&(g=!0),r.save(),r.translate(p.x,p.y),r.rotate(p.rot*Math.PI/180),r.fillStyle=p.color,r.fillRect(-p.w/2,-p.h/2,p.w,p.h),r.restore();g&&(d=requestAnimationFrame(m))};d=requestAnimationFrame(m);const h=setTimeout(()=>{cancelAnimationFrame(d),r.clearRect(0,0,s.width,s.height)},4e3);return()=>{cancelAnimationFrame(d),clearTimeout(h)}},[a]),t}function Nt({answers:a,onRestart:t,drawData:s,drawSource:r="local-fallback",categoryInfo:o,motionIntensity:u="full"}){const{t:d}=pa(),m=Ma()||u==="off",{user:h,isAuthenticated:g}=Ca(),p=f.useMemo(()=>De(),[]),c=s||ga(),l=f.useMemo(()=>Array.isArray(o)&&o.length>0?o:fa(),[o]),[x,O]=f.useState(!0),[y,k]=f.useState(!1),[w,P]=f.useState(!1),[K,_]=f.useState(!1),[G,F]=f.useState(!1),[V,se]=f.useState(!1),[i,v]=f.useState(()=>ue()),[A,Z]=f.useState("__current__"),[H,Fe]=f.useState(()=>ue()[0]?.id||"__current__"),[ge,na]=f.useState(()=>p.profileName||""),[Ae,sa]=f.useState(()=>p.contactEmail||""),[T,ia]=f.useState(()=>!!p.defaultDrawAlerts),[xe,ee]=f.useState(""),[Le,Te]=f.useState(!1),[ye,re]=f.useState([]),[be,ae]=f.useState("idle"),je=p.autoSyncProfiles!==!1;f.useEffect(()=>{const n=setTimeout(()=>O(!1),500);return()=>clearTimeout(n)},[]),f.useEffect(()=>{v(ue())},[]);const J=f.useMemo(()=>{if(a.knowsScore==="yes"){const n=parseInt(a.scoreRange,10)||400;return{total:n,breakdown:{coreHumanCapital:n,spouseFactors:0,skillTransferability:0,additionalPoints:0},details:{age:0,education:0,firstLanguage:0,secondLanguage:0,canadianWork:0,foreignWork:0,spouseTotal:0,skillTotal:0,additionalTotal:0}}}return _a(a)},[a]),R=a.knowsScore!=="yes",N=J.total,Q=c.averageCutoff,Y=N-Q,ve=xa(),ke=f.useMemo(()=>Ve(c.lastUpdated),[c.lastUpdated]),oe=f.useMemo(()=>{const n=l.map(b=>b?.updatedAt).filter(Boolean).map(b=>ta(b)).filter(Boolean).sort((b,L)=>L.getTime()-b.getTime())[0];return Ve(n?n.toISOString():c.lastUpdated)},[l,c.lastUpdated]),Re=f.useMemo(()=>l.some(n=>n?.source==="supabase")?"Live sync":"Local fallback",[l]),D=f.useMemo(()=>[{id:"__current__",name:"Current profile",score:N,answers:a},...i.map(n=>({id:n.id,name:n.name||n.id,score:Number(n.score)||0,answers:n.answers||{}}))],[a,i,N]),z=f.useMemo(()=>D.find(n=>n.id===A),[A,D]),U=f.useMemo(()=>D.find(n=>n.id===H),[H,D]),Ne=!!z&&!!U&&z.id!==U.id,ce=Ne?U.score-z.score:0,ra=f.useMemo(()=>Je(z?.answers||a),[a,z?.answers]),oa=f.useMemo(()=>Je(U?.answers||a),[a,U?.answers]);f.useEffect(()=>{const n=D.some(L=>L.id===A),b=D.some(L=>L.id===H);if(n||Z("__current__"),!b){const L=D.find(de=>de.id!==A)?.id||"__current__";Fe(L)}},[A,H,D]),f.useEffect(()=>{if(!g||!ve||!h?.id){re([]),ae("idle");return}let n=!0;return ae("loading"),We(h.id).then(b=>{n&&(b.status==="ok"?(re(b.data||[]),ae("ready")):(re([]),ae("empty")))}).catch(()=>{n&&ae("error")}),()=>{n=!1}},[ve,g,h?.id]);const X=Y>=20?{cls:"above",marker:"+",title:"Great News!",desc:`Your score is ${Y} points above the recent cut-off (${Q}). You have a strong chance of receiving an Invitation to Apply.`,color:"#22c55e"}:Y>=-10?{cls:"close",marker:"~",title:"Almost There!",desc:`You're just ${Math.abs(Y)} points ${Y>=0?"above":"below"} the recent cut-off (${Q}). A few small improvements could make the difference.`,color:"#f59e0b"}:{cls:"below",marker:"—",title:"Room to Improve",desc:`You're ${Math.abs(Y)} points below the recent cut-off (${Q}). Don't worry — see the suggestions below to boost your score.`,color:"#ef4444"},le=f.useMemo(()=>Ea(a,J),[a,J]),we=f.useMemo(()=>$a(J),[J]),M=J.details,ca=f.useMemo(()=>{const n=[{icon:"A",label:"Age",value:M.age,max:110},{icon:"E",label:"Education",value:M.education,max:150},{icon:"L",label:"English Language",value:M.firstLanguage,max:136},{icon:"W",label:"Canadian Work",value:M.canadianWork,max:80}];return M.secondLanguage>0&&n.splice(3,0,{icon:"F",label:"French",value:M.secondLanguage,max:24}),M.foreignWork>0?n.push({icon:"S",label:d("results.foreignWork"),value:M.skillTotal,max:100,note:"via skill transferability"}):n.push({icon:"S",label:"Skill Bonus",value:M.skillTotal,max:100}),M.spouseTotal>0&&n.push({icon:"P",label:"Spouse",value:M.spouseTotal,max:40}),M.additionalTotal>0&&n.push({icon:"+",label:"Bonus Points",value:M.additionalTotal,max:600}),n},[M,d]),la=le.slice(0,3),Se=le.slice(3),Ce=Pa[a.pathway],_e=f.useMemo(()=>R?La(a):[],[a,R]),Be=!m&&!x&&Y>=20,da=gt(Be),ma=async()=>{const n=Ae.trim()||h?.email||"";if(T&&!n){ee("Add an email to enable draw alerts (or sign in).");return}if(n&&!/^\S+@\S+\.\S+$/.test(n)){ee("Please enter a valid email address.");return}const b=Da({name:ge.trim(),answers:a,score:N,email:n,alertOptIn:!!T&&!!n});v(ue());const L=De();ya({...L,profileName:ge.trim(),contactEmail:n,defaultDrawAlerts:!!T}),Te(!0),S("profile_save_started",{has_email:!!n,alerts_opt_in:!!T,is_authenticated:!!g,score:N});try{if(je&&(n||T))if((await ba(b,{userId:h?.id||null})).status==="ok"){if(g&&h?.id){const Ie=await We(h.id);Ie.status==="ok"&&(re(Ie.data||[]),ae("ready"))}ee(T?"Profile saved, synced, and draw alerts subscribed.":"Profile saved and synced with your account."),S("profile_save_completed",{status:"cloud_synced",alerts_opt_in:!!T,score:N})}else ee("Profile saved locally. Configure Supabase env vars to enable cloud sync/alerts."),S("profile_save_completed",{status:"local_only",alerts_opt_in:!!T,score:N});else ee(je?"Profile saved locally.":"Profile saved locally. Auto-sync is off in account settings."),S("profile_save_completed",{status:je?"local_only":"local_autosync_off",alerts_opt_in:!!T,score:N})}catch(de){ee(`Profile saved locally, but cloud sync failed: ${de.message}`),S("profile_save_completed",{status:"cloud_sync_failed",alerts_opt_in:!!T,score:N})}finally{Te(!1)}},ua=()=>{S("results_pdf_print_clicked",{score:N}),window.print()},E=n=>{const b=document.getElementById(n);b&&(b.scrollIntoView({behavior:"smooth",block:"start"}),S("results_section_jump",{section_id:n}))},ha=()=>{window.dispatchEvent(new CustomEvent("crs-open-account-modal")),S("account_modal_open_requested",{source:"results_action_center"})};return f.useEffect(()=>{x||S("results_viewed",{score:N,diff_from_cutoff:Y,draw_source:r,category_count:l.length})},[l.length,Y,r,x,N]),x?e.jsx(ft,{}):e.jsxs(j.div,{className:"results",variants:ze,initial:"hidden",animate:"show",exit:{opacity:0,transition:{duration:.2}},children:[Be&&e.jsx("canvas",{ref:da,className:"confetti-canvas"}),e.jsx(j.div,{className:"score-hero",variants:C,children:e.jsx(lt,{score:N,statusColor:X.color,reduceMotion:m})}),e.jsx(j.div,{className:"result-actions",variants:C,children:e.jsx("button",{type:"button",className:"action-btn",onClick:ua,"aria-label":"Download PDF",children:d("results.pdf")})}),e.jsx(rt,{answers:a,result:J,suggestions:le,averageCutoff:c.averageCutoff,activeDraws:c,activeCategoryInfo:l,provinces:_e,drawFreshness:ke,categoryFreshness:oe,saveStatus:xe,onJumpToSection:E,onOpenAccount:ha}),e.jsxs(j.div,{className:"card quick-nav-card",variants:C,children:[e.jsx("h3",{children:"Quick navigation"}),e.jsxs("div",{className:"quick-nav-grid",children:[e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-action-center"),children:"Action center"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-save"),children:"Save profile"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-optimizer"),children:"Optimizer"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-90-day-plan"),children:"90-day plan"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-pricing"),children:"Plans"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-explainability"),children:"Explainability"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-profile-compare"),children:"Profile compare"}),R&&e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-breakdown"),children:"Score breakdown"}),R&&e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-improve"),children:"Improve score"}),R&&e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-coach"),children:"Expert strategy"}),R&&e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-category"),children:"Category draws"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-timeline"),children:"Timeline"}),e.jsx("button",{type:"button",className:"action-btn",onClick:()=>E("section-draws"),children:"Recent draws"})]})]}),e.jsxs(j.div,{className:`card status-card ${X.cls}-card`,variants:C,children:[e.jsxs("div",{className:"status-header",children:[e.jsx("span",{className:`status-marker ${X.cls}`,children:X.marker})," ",e.jsx("strong",{children:X.title})]}),e.jsx("p",{className:"status-desc",children:X.desc}),e.jsxs("div",{className:`draw-source-pill ${qe(r)}`,children:["Draw data source: ",Ue(r)," · Updated ",c.lastUpdated||"—",e.jsx("span",{className:`freshness-pill freshness-${ke.tier}`,children:ke.label})]}),e.jsxs("div",{className:"cutoff-compare",children:[e.jsx(Ke,{label:"Your Score",value:N,max:Math.max(N,Q,600),color:"var(--primary)"}),e.jsx(Ke,{label:"Cut-off",value:Q,max:Math.max(N,Q,600),color:"var(--surface-3)"})]})]}),e.jsxs(j.div,{className:"card save-profile-card",variants:C,id:"section-save",children:[e.jsx("h3",{children:"Save your profile"}),e.jsx("p",{className:"cat-intro",children:"Save this result and optionally subscribe to draw alerts."}),g?e.jsxs("p",{className:"save-note",children:["Signed in as ",h.email,". Saves are synced across your devices."]}):e.jsx("p",{className:"save-note",children:"Tip: sign in to sync profiles and score tracking across devices."}),e.jsxs("div",{className:"save-grid",children:[e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Profile name (optional)"}),e.jsx("input",{type:"text",value:ge,onChange:n=>na(n.target.value),placeholder:"e.g., Feb 2026 Profile"})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Email (optional)"}),e.jsx("input",{type:"email",value:Ae,onChange:n=>sa(n.target.value),placeholder:"you@example.com"})]})]}),e.jsxs("label",{className:"save-alert-row",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:n=>ia(n.target.checked)}),e.jsx("span",{children:"Notify me by email when my score is at/above the latest cutoff"})]}),!ve&&e.jsx("p",{className:"save-note",children:"Cloud alerts need Supabase env vars (`VITE_SUPABASE_URL`, `VITE_SUPABASE_ANON_KEY`)."}),e.jsx("div",{className:"save-actions",children:e.jsx("button",{type:"button",className:"action-btn",onClick:ma,disabled:Le,children:Le?"Saving…":"Save Profile"})}),xe&&e.jsx("p",{className:"save-status",children:xe}),g&&e.jsxs("div",{className:"save-synced-list",children:[e.jsx("h4",{children:"Synced profiles"}),be==="loading"&&e.jsx("p",{className:"save-note",children:"Loading your synced profiles..."}),be==="error"&&e.jsx("p",{className:"save-note",children:"Could not load synced profiles right now."}),be!=="loading"&&ye.length===0&&e.jsx("p",{className:"save-note",children:"No synced profiles yet. Save your current result to start tracking."}),ye.length>0&&e.jsx("ul",{className:"save-synced-items",children:ye.slice(0,5).map(n=>e.jsxs("li",{children:[e.jsx("span",{children:n.name||n.id}),e.jsx("strong",{children:n.score})]},n.id))})]})]}),e.jsxs(j.div,{className:"card profile-compare-card",variants:C,id:"section-profile-compare",children:[e.jsx(he,{id:"profile-compare-panel",label:"Profile Compare Mode",open:V,onToggle:()=>{const n=!V;se(n),S("profile_compare_toggled",{open:n})}}),e.jsx(me,{initial:!1,children:V&&e.jsxs(j.div,{id:"profile-compare-panel",initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:m?{duration:0}:{duration:.2},children:[e.jsx("p",{className:"cat-intro",children:"Compare your current answers with any locally saved profile to spot score gaps quickly."}),e.jsxs("div",{className:"profile-compare-controls wi-grid",children:[e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Profile A"}),e.jsx("select",{value:A,onChange:n=>Z(n.target.value),children:D.map(n=>e.jsxs("option",{value:n.id,children:[n.name," (",n.score,")"]},`a-${n.id}`))})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Profile B"}),e.jsx("select",{value:H,onChange:n=>Fe(n.target.value),children:D.map(n=>e.jsxs("option",{value:n.id,children:[n.name," (",n.score,")"]},`b-${n.id}`))})]})]}),!Ne&&e.jsx("p",{className:"path-empty-text",children:"Choose two different profiles to compare."}),Ne&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"profile-compare-delta",children:[e.jsx("strong",{children:U.name})," vs ",e.jsx("strong",{children:z.name}),":",e.jsxs("span",{className:ce>0?"delta-up":ce<0?"delta-down":"",children:[" ",ce>0?"+":"",ce," points"]})]}),e.jsxs("div",{className:"profile-compare-grid",children:[e.jsxs("div",{className:"profile-compare-column",children:[e.jsx("h4",{children:z.name}),e.jsx("strong",{className:"profile-compare-score",children:z.score}),e.jsx("ul",{children:ra.map(n=>e.jsxs("li",{children:[e.jsx("span",{children:n.label}),e.jsx("strong",{children:n.value})]},`${z.id}-${n.label}`))})]}),e.jsxs("div",{className:"profile-compare-column",children:[e.jsx("h4",{children:U.name}),e.jsx("strong",{className:"profile-compare-score",children:U.score}),e.jsx("ul",{children:oa.map(n=>e.jsxs("li",{children:[e.jsx("span",{children:n.label}),e.jsx("strong",{children:n.value})]},`${U.id}-${n.label}`))})]})]})]})]})})]}),R&&e.jsxs(j.div,{className:"card",variants:C,id:"section-breakdown",children:[e.jsx("h3",{children:d("results.breakdown")}),e.jsx(j.div,{className:"breakdown-grid",variants:ze,initial:"hidden",animate:"show",children:ca.map(n=>e.jsx(dt,{...n},n.label))}),e.jsxs("div",{className:"bd-total",children:[e.jsx("span",{children:"Total CRS Score"}),e.jsx("span",{className:"bd-total-num",children:N})]})]}),R&&e.jsxs(j.div,{className:"card whatif-card",variants:C,children:[e.jsx(he,{id:"scenario-compare-panel",label:"Scenario Compare (A vs B)",open:K,onToggle:()=>{const n=!K;_(n),S("scenario_compare_toggled",{open:n})}}),e.jsx(me,{initial:!1,children:K&&e.jsxs(j.div,{id:"scenario-compare-panel",initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:m?{duration:0}:{duration:.2},children:[e.jsx("p",{className:"cat-intro",children:d("results.whatifDesc")}),e.jsx(pt,{answers:a,originalScore:N,t:d})]})})]}),le.length>0&&e.jsxs(j.div,{className:"card",variants:C,id:"section-improve",children:[e.jsx("h3",{children:d("results.improve")}),la.map((n,b)=>e.jsxs(j.div,{className:"action-card",variants:C,children:[e.jsx("div",{className:"action-rank",children:b+1}),e.jsxs("div",{className:"action-body",children:[e.jsxs("div",{className:"action-title",children:[n.title,n.potentialGain>0&&e.jsxs("span",{className:"action-badge",children:["+",n.potentialGain," pts"]})]}),e.jsx("div",{className:"action-desc",children:n.description}),n.action&&e.jsx("div",{className:"action-specific",children:n.action}),e.jsxs("div",{className:"action-meta",children:[e.jsx("span",{className:"action-time",children:n.timeframe}),e.jsx("span",{className:`action-diff diff-${n.difficulty.toLowerCase()}`,children:n.difficulty})]})]})]},b)),Se.length>0&&e.jsxs(e.Fragment,{children:[y&&Se.map((n,b)=>e.jsxs(j.div,{className:"action-card",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("div",{className:"action-rank",children:b+4}),e.jsxs("div",{className:"action-body",children:[e.jsxs("div",{className:"action-title",children:[n.title,n.potentialGain>0&&e.jsxs("span",{className:"action-badge",children:["+",n.potentialGain," pts"]})]}),e.jsx("div",{className:"action-desc",children:n.description}),n.action&&e.jsx("div",{className:"action-specific",children:n.action}),e.jsxs("div",{className:"action-meta",children:[e.jsx("span",{className:"action-time",children:n.timeframe}),e.jsx("span",{className:`action-diff diff-${n.difficulty.toLowerCase()}`,children:n.difficulty})]})]})]},b+3)),e.jsx("button",{type:"button",className:"btn-toggle",onClick:()=>k(!y),children:y?"Show fewer ▲":`Show ${Se.length} more suggestions ▼`})]})]}),R&&e.jsx("div",{id:"section-coach",children:e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"loading-fallback",children:e.jsx(Qe,{})}),children:e.jsx(ot,{answers:a,result:J,averageCutoff:c.averageCutoff,categoryInfo:l,motionIntensity:u})})}),R&&e.jsxs(j.div,{className:"card",variants:C,id:"section-category",children:[e.jsx("h3",{children:d("results.category")}),e.jsx("p",{className:"cat-intro",children:d("results.catIntro")}),e.jsxs("div",{className:"category-meta-row",children:[e.jsxs("span",{className:`draw-source-pill ${Re==="Live sync"?"draw-source-live":"draw-source-fallback"}`,children:["Category config: ",Re]}),e.jsxs("span",{className:`freshness-pill freshness-${oe.tier}`,children:[oe.label," · ",oe.dateLabel]})]}),e.jsx("div",{className:"cat-grid",children:l.map(n=>{const b=n.check(a),L=b&&N>=n.recentCutoff;return e.jsxs(j.div,{className:`cat-card ${b?L?"cat-above":"cat-eligible":"cat-na"}`,variants:C,children:[e.jsxs("div",{className:"cat-header",children:[e.jsx("span",{className:"cat-icon",children:n.icon}),e.jsxs("div",{children:[e.jsx("strong",{className:"cat-name",children:n.name}),b&&e.jsx("span",{className:`cat-badge ${L?"badge-above":"badge-eligible"}`,children:L?"Above Cutoff":"Eligible"}),!b&&e.jsx("span",{className:"cat-badge badge-na",children:"Not Eligible"})]})]}),e.jsx("p",{className:"cat-desc",children:n.description}),e.jsxs("div",{className:"cat-cutoff",children:[e.jsxs("span",{children:["Recent cutoff: ",e.jsx("strong",{children:n.recentCutoff})]}),e.jsxs("span",{className:"cat-range",children:["Range: ",n.cutoffRange]})]}),!b&&e.jsx("p",{className:"cat-req",children:n.eligibility})]},n.id)})})]}),R&&_e.length>0&&e.jsxs(j.div,{className:"card",variants:C,children:[e.jsx(he,{id:"province-recommender-panel",label:"Province Recommender",open:G,onToggle:()=>{const n=!G;F(n),S("province_recommender_toggled",{open:n})}}),e.jsx(me,{initial:!1,children:G&&e.jsxs(j.div,{id:"province-recommender-panel",initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:m?{duration:0}:{duration:.2},children:[e.jsx("p",{className:"cat-intro",children:"Based on your profile, these provinces may be good matches for Provincial Nominee Programs."}),e.jsx("div",{className:"prov-grid",children:_e.slice(0,5).map(n=>e.jsxs("div",{className:"prov-card",children:[e.jsxs("div",{className:"prov-header",children:[e.jsx("span",{className:"prov-abbr",children:n.abbr}),e.jsxs("div",{children:[e.jsx("strong",{className:"prov-name",children:n.name}),e.jsxs("span",{className:`prov-match ${n.matchScore>=70?"match-high":n.matchScore>=40?"match-mid":"match-low"}`,children:[n.matchScore,"% match"]})]})]}),e.jsx("div",{className:"prov-bar-wrap",children:e.jsx(j.div,{className:"prov-bar",initial:{width:0},animate:{width:`${n.matchScore}%`},transition:m?{duration:0}:{duration:.8,ease:"easeOut"},style:{background:n.matchScore>=70?"#22c55e":n.matchScore>=40?"#f59e0b":"var(--surface-3)"}})}),e.jsx("p",{className:"prov-notes",children:n.notes})]},n.id))})]})})]}),e.jsxs(j.div,{className:"card",variants:C,id:"section-timeline",children:[e.jsx("h3",{children:d("results.timeline")}),e.jsxs("div",{className:`timeline-badge tl-${X.cls}`,children:[e.jsx("strong",{children:we.label})," — est. ",we.months," months"]}),e.jsx("p",{className:"timeline-desc",children:we.description})]}),e.jsxs(j.div,{className:"card",variants:C,id:"section-draws",children:[e.jsx(he,{id:"recent-draws-panel",label:d("results.draws"),open:w,onToggle:()=>{const n=!w;P(n),S("recent_draws_toggled",{open:n})}}),e.jsxs("div",{className:`draw-source-pill ${qe(r)}`,children:["Source: ",Ue(r)," · Updated ",c.lastUpdated||"—"]}),e.jsx(me,{initial:!1,children:w&&e.jsxs(j.div,{id:"recent-draws-panel",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:m?{duration:0}:{duration:.22},className:"draws-content",children:[e.jsx("h4",{className:"draws-subhead",children:"General / CEC Draws"}),c.generalProgram.slice(0,4).map((n,b)=>e.jsx(Pe,{draw:n,userScore:N},`g${b}`)),e.jsx("h4",{className:"draws-subhead",children:"Category-Based Draws"}),c.categoryBased.slice(0,4).map((n,b)=>e.jsx(Pe,{draw:n,userScore:N},`c${b}`)),!!c.pnpDraws?.length&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"draws-subhead",children:"Provincial Nominee (PNP)"}),c.pnpDraws.slice(0,3).map((n,b)=>e.jsx(Pe,{draw:n,userScore:N},`p${b}`))]})]})})]}),Ce&&e.jsxs(j.div,{className:"card",variants:C,children:[e.jsxs("h3",{children:[Ce.name," Requirements"]}),e.jsx("ul",{className:"pathway-list",children:Ce.requirements.map((n,b)=>e.jsx("li",{children:n},b))})]}),e.jsx(j.div,{className:"card disclaimer",variants:C,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Disclaimer:"})," ",d("results.disclaimer")," ",e.jsx("a",{href:"https://www.canada.ca/en/immigration-refugees-citizenship.html",target:"_blank",rel:"noopener noreferrer",children:"canada.ca"})]})}),e.jsx(j.button,{type:"button",className:"btn-restart",onClick:()=>{S("results_restart_clicked",{score:N}),t()},whileHover:m?void 0:{scale:1.03},whileTap:m?void 0:{scale:.96},variants:C,children:d("results.restart")})]})}function Ke({label:a,value:t,max:s,color:r}){const o=Math.round(t/s*100);return e.jsxs("div",{className:"cutoff-row",children:[e.jsx("span",{className:"cutoff-label",children:a}),e.jsx("div",{className:"cutoff-bar-wrap",children:e.jsx(j.div,{className:"cutoff-bar",style:{background:r},initial:{width:0},animate:{width:`${o}%`},transition:{duration:.8,ease:"easeOut"},children:t})})]})}export{Nt as default};
