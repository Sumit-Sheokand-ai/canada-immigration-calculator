import{c as be,a as ve,b as ye,e as je,f as ke,s as Se,d as Ne,g as we,h as Ce,i as Ee,j as _e,k as Le,l as Te,m as Pe,n as $e,o as Me,p as Ie,q as We,u as Ae,r as g,t as Be,v as Re,w as e,x as p,y as W,z as Fe,A as Oe,B as Ye,C as De,D as qe,L as Ge}from"./index-CRbKm2Rh.js";const He=(a,n,t)=>Math.max(n,Math.min(t,a));function Ue(a){const n={...a};if(a.hasFrench==="yes"&&a.frenchTestType==="tef")for(const t of["listening","reading","writing","speaking"])n[`french_${t}`]=String(be(t,parseInt(a[`tef_${t}`])||0));else if(a.hasFrench==="yes"&&a.frenchTestType==="tcf")for(const t of["listening","reading","writing","speaking"])n[`french_${t}`]=String(ve(t,parseInt(a[`tcf_${t}`])||0));return n}function H(a){return a.hasSpouse==="yes"&&a.spouseIsCanadian!=="yes"&&a.spouseAccompanying!=="no"}const A=a=>H(a)?1:0;function ne(a,n){if(a.langTestType==="celpip")return He(parseInt(a[`celpip_${n}`])||0,0,12);const t=parseFloat(a[`ielts_${n}`])||0;return Me(n,t)}function B(a){const n=["listening","reading","writing","speaking"];let t=99;for(const i of n){const r=ne(a,i);r<t&&(t=r)}return t===99?0:t}function te(a,n){return parseInt(a[`french_${n}`])||0}function se(a){const n=["listening","reading","writing","speaking"];let t=99;for(const i of n){const r=te(a,i);r<t&&(t=r)}return t===99?0:t}function Je(a){const n=B(a);return n>=9?2:n>=7?1:0}function ze(a){const n=parseInt(a.canadianWorkExp)||0;return n>=2?2:n>=1?1:0}function Ve(a){const n=parseInt(a.foreignWorkExp)||0;return n>=3?2:n>=1?1:0}function Ke(a){let n=parseInt(a.age);return isNaN(n)?0:(n<18&&(n=17),n>47&&(n=47),n>44&&(n=45),ye[n]?.[A(a)]||0)}function Xe(a){return je[a.education]?.[A(a)]||0}function Qe(a){const n=["listening","reading","writing","speaking"],t=A(a);return n.reduce((i,r)=>{const m=ne(a,r);return i+(ke[m]?.[t]||0)},0)}function Ze(a){if(a.hasFrench!=="yes")return 0;const n=["listening","reading","writing","speaking"],t=A(a),i=n.reduce((r,m)=>{const l=te(a,m);return r+(Se[l]?.[t]||0)},0);return Math.min(i,t===0?24:22)}function ea(a){let n=parseInt(a.canadianWorkExp)||0;return n>5&&(n=5),Ne[n]?.[A(a)]||0}function aa(a){if(!H(a))return 0;let n=0;n+=we[a.spouseEducation]||0;const t=["listening","reading","writing","speaking"];let i=0;for(const m of t){const l=parseInt(a[`spouseLang_${m}`])||0;i+=Ie[l]||0}n+=Math.min(i,20);let r=parseInt(a.spouseCanadianWork)||0;return r>5&&(r=5),n+=Ce[r]||0,Math.min(n,40)}function na(a){const n=Ee[a.education]||0,t=Je(a),i=ze(a),r=Ve(a),m=_e[n]?.[t]||0,l=Le[n]?.[i]||0,c=Math.min(m+l,50),o=Te[r]?.[t]||0,d=Pe[r]?.[i]||0,h=Math.min(o+d,50);let u=0;if(a.pathway==="fst"&&a.hasCertificate==="yes"){const b=B(a);u=We[b>=7?2:b>=5?1:0]}return Math.min(c+h+u,100)}function ta(a){let n=0;const t=$e;return a.hasPNP==="yes"&&(n+=t.pnp_nomination),a.hasJobOffer==="yes"&&(a.jobOfferTeer==="teer_0"&&a.jobOfferMajorGroup00==="yes"?n+=t.job_offer_00:["teer_0","teer_1","teer_2","teer_3"].includes(a.jobOfferTeer)&&(n+=t.job_offer_other)),a.canadianEducation==="yes"&&(n+=a.canadianEduType==="long"?t.canadian_edu_long:t.canadian_edu_short),a.hasSibling==="yes"&&(n+=t.sibling_in_canada),a.hasFrench==="yes"&&se(a)>=7&&(n+=B(a)>=5?t.french_strong_strong_english:t.french_strong_weak_english),Math.min(n,600)}function ie(a){const n=Ue(a),t=Ke(n),i=Xe(n),r=Qe(n),m=Ze(n),l=ea(n),c=parseInt(n.foreignWorkExp)||0,o=t+i+r+m+l,d=aa(n),h=na(n),u=ta(n);return{total:Math.min(o+d+h+u,1200),breakdown:{coreHumanCapital:o,spouseFactors:d,skillTransferability:h,additionalPoints:u},details:{age:t,education:i,firstLanguage:r,secondLanguage:m,canadianWork:l,foreignWork:c,spouseTotal:d,skillTotal:h,additionalTotal:u}}}function _(a,n){return ie({...a,...n})}function j(a,n,t,i,r,m,l=""){return{title:a,description:n,potentialGain:t,difficulty:i,timeframe:r,icon:m,action:l}}function sa(a,n){const t=[],i=B(a);if(i<10){const c=Math.min(i+1,10),o=a.langTestType==="celpip"?"CELPIP":"IELTS",d={},h=["listening","reading","writing","speaking"];for(const S of h){const N=a.langTestType==="celpip"?`celpip_${S}`:`ielts_${S}`,L=a.langTestType==="celpip"?parseInt(a[N])||0:parseFloat(a[N])||0;a.langTestType==="celpip"?d[N]=Math.max(L,c):d[N]=Math.max(L,L+.5)}const b=_(a,d).total-n.total;b>0&&t.push(j(`Improve ${o} Scores`,`Raising your weakest ${o} skill to CLB ${c} could add significant points. Focus on your lowest band.`,b,"Medium","3-5 months","language",`Current min CLB ${i} → target CLB ${c} = +${b} CRS`))}const r=["less_than_secondary","secondary","one_year_post","two_year_post","bachelors","two_or_more","masters","doctoral"],m=r.indexOf(a.education);if(m>=0&&m<r.length-1){const c=r[m+1],d=_(a,{education:c}).total-n.total;if(d>0){const h={secondary:"high school diploma",one_year_post:"1-year diploma",two_year_post:"2-year diploma",bachelors:"bachelor's degree",two_or_more:"two credentials",masters:"master's degree",doctoral:"doctoral degree"};t.push(j("Higher Education",`Completing a ${h[c]||"higher credential"} could boost your score.`,d,"Hard","1-4 years","education",`${a.education||"current level"} → ${c} = +${d} CRS`))}}const l=parseInt(a.canadianWorkExp)||0;if(l<5){const o=_(a,{canadianWorkExp:String(l+1)}).total-n.total;o>0&&t.push(j("Gain Canadian Work Experience","An additional year of Canadian work experience adds points across multiple categories including skill transferability.",o,"Hard","8-12 months","work",`${l} year(s) → ${l+1} year(s) = +${o} CRS`))}if(a.hasFrench!=="yes"){const d=_(a,{hasFrench:"yes",french_listening:"7",french_reading:"7",french_writing:"7",french_speaking:"7"}).total-n.total;d>0&&t.push(j("Learn French (TEF/TCF)",`Strong French skills (NCLC 7+) earn ${i>=5?"50":"25"} additional CRS points. Plus, French-language category draws have cutoffs around 400 — much lower than general draws (~520).`,d,"Hard","6-12 months","french",`Reach NCLC 7 in all 4 abilities = +${d} CRS`))}else se(a)>=7&&n.total<520&&n.total>=370&&t.push(j("Target French-Language Category Draw",`With your French NCLC 7+ scores, you qualify for French-language category draws where recent cutoffs are around 400 — your score of ${n.total} may already be competitive!`,0,"Easy","Immediate","french",`Current score ${n.total} already fits many French-category cutoffs`));if(a.hasPNP!=="yes"&&t.push(j("Provincial Nominee Program","A PNP nomination adds 600 points, virtually guaranteeing an ITA. Explore programs in provinces like Ontario, BC, Alberta and Saskatchewan.",600,"Hard","2-8 months","province","PNP nomination = +600 CRS")),a.hasJobOffer!=="yes"){const o=_(a,{hasJobOffer:"yes",jobOfferTeer:"teer_0"}).total-n.total;o>0&&t.push(j("Obtain LMIA-Backed Job Offer","A valid job offer with LMIA in a TEER 0-3 occupation adds 50-200 points.",o,"Hard","2-6 months","job",`Current profile + valid LMIA-backed offer = +${o} CRS`))}if(a.canadianEducation!=="yes"&&t.push(j("Study in Canada","A Canadian credential (1-2 year program) adds 15 points, or 30 points for a 3+ year program.",30,"Hard","12-36 months","study","Canadian credential can add +15 to +30 CRS")),a.hasSibling!=="yes"&&t.push(j("Sibling in Canada (If Applicable)","If you have a sibling who is a Canadian citizen or PR, this adds 15 points. Check if any siblings qualify.",15,"Easy","1-2 weeks","family","Eligible sibling relationship = +15 CRS")),H(a)){const c=["listening","reading","writing","speaking"];let o=99;for(const d of c){const h=parseInt(a[`spouseLang_${d}`])||0;h<o&&(o=h)}if(o<9){const d=Math.min(o+1,9),h={};for(const S of c)h[`spouseLang_${S}`]=String(Math.max(parseInt(a[`spouseLang_${S}`])||0,d));const b=_(a,h).total-n.total;b>0&&t.push(j("Improve Spouse's Language Scores",`Your spouse's language improvement to CLB ${d} could add points.`,b,"Medium","3-5 months","language",`Spouse min CLB ${o} → ${d} = +${b} CRS`))}}return t.sort((c,o)=>o.potentialGain-c.potentialGain),t}function ia(a){const n=a.total;return n>=500?{label:"Very Strong",months:"1-3",description:"You are very likely to receive an ITA in the next few draws."}:n>=470?{label:"Strong",months:"3-6",description:"Your score is competitive. An ITA is likely within a few months."}:n>=440?{label:"Moderate",months:"6-12",description:"Your score is near recent cutoffs. Category-based draws may help."}:n>=400?{label:"Below Average",months:"12-18",description:"You may need to improve your profile or target a category-based draw."}:{label:"Needs Improvement",months:"18+",description:"Significant profile improvements are recommended before applying."}}const ra=[{id:"on",name:"Ontario",abbr:"ON",streams:["Human Capital Priorities","Skilled Trades","French-Speaking"],demandSectors:["stem","healthcare","trade"],minCLB:7,minEducation:"bachelors",minWorkYears:1,notes:"Largest province. Strong demand for tech, healthcare, and skilled trades. Ontario often sends NOIs to Express Entry candidates with CRS 400+."},{id:"bc",name:"British Columbia",abbr:"BC",streams:["Skills Immigration","Express Entry BC","Tech"],demandSectors:["stem","healthcare","trade"],minCLB:5,minEducation:"two_year_post",minWorkYears:1,notes:"Tech hub (Vancouver). BC PNP Tech targets 29 in-demand occupations including software, data, and engineering roles."},{id:"ab",name:"Alberta",abbr:"AB",streams:["Alberta Advantage Immigration","Express Entry Stream"],demandSectors:["trade","healthcare","stem","transport"],minCLB:5,minEducation:"secondary",minWorkYears:1,notes:"Strong energy/oil sector. Growing tech scene in Calgary and Edmonton. Lower cost of living than ON/BC."},{id:"sk",name:"Saskatchewan",abbr:"SK",streams:["International Skilled Worker","Express Entry"],demandSectors:["agriculture","healthcare","trade","transport"],minCLB:4,minEducation:"secondary",minWorkYears:1,notes:"In-Demand Occupations list is broad. One of the easiest PNPs to qualify for. Agriculture and mining are key industries."},{id:"mb",name:"Manitoba",abbr:"MB",streams:["Skilled Workers Overseas","Skilled Workers in Manitoba"],demandSectors:["healthcare","agriculture","trade","transport"],minCLB:5,minEducation:"one_year_post",minWorkYears:1,notes:"Welcoming to newcomers. Strong need for healthcare workers and tradespeople. Lower CRS requirements than federal draws."},{id:"ns",name:"Nova Scotia",abbr:"NS",streams:["Labour Market Priorities","Skilled Worker","Physician"],demandSectors:["healthcare","trade","stem"],minCLB:5,minEducation:"one_year_post",minWorkYears:1,notes:"Part of Atlantic Immigration Program. Growing tech sector in Halifax. Healthcare workers are highly sought after."},{id:"nb",name:"New Brunswick",abbr:"NB",streams:["Express Entry Labour Market","Skilled Workers with Employer Support"],demandSectors:["healthcare","trade","agriculture"],minCLB:5,minEducation:"secondary",minWorkYears:1,notes:"Bilingual province (English/French). Part of Atlantic Immigration Program. Francophone candidates get priority."},{id:"pe",name:"Prince Edward Island",abbr:"PE",streams:["Express Entry","Labour Impact"],demandSectors:["agriculture","healthcare","trade"],minCLB:5,minEducation:"two_year_post",minWorkYears:2,notes:"Small province with lower competition. Agriculture and tourism are key industries."},{id:"nl",name:"Newfoundland & Labrador",abbr:"NL",streams:["Express Entry","Skilled Worker","Priority Skills"],demandSectors:["healthcare","trade","stem"],minCLB:5,minEducation:"one_year_post",minWorkYears:1,notes:"Part of Atlantic Immigration Program. Growing need for healthcare and tech workers. Oil and gas sector."},{id:"yt",name:"Yukon",abbr:"YT",streams:["Yukon Express Entry","Skilled Worker"],demandSectors:["trade","healthcare","transport"],minCLB:4,minEducation:"secondary",minWorkYears:1,notes:"Territory with small population. Job offer typically required. Good for tradespeople and healthcare workers."}],G={less_than_secondary:0,secondary:1,one_year_post:2,two_year_post:3,bachelors:4,two_or_more:5,masters:6,doctoral:7};function oa(a,n){return(G[a]||0)>=(G[n]||0)}function ca(a){const n=la(a),t=a.education||"secondary",i=Math.max(parseInt(a.canadianWorkExp)||0,parseInt(a.foreignWorkExp)||0),r=a.occupationCategory||"other",m=a.hasFrench==="yes";return ra.map(l=>{let c=0;const o=100;n>=l.minCLB&&(c+=20,n>=l.minCLB+2&&(c+=10)),oa(t,l.minEducation)&&(c+=15,(G[t]||0)>=4&&(c+=5)),i>=l.minWorkYears&&(c+=15,i>=3&&(c+=5)),l.demandSectors.includes(r)&&(c+=25),m&&(l.id==="nb"||l.id==="on")&&(c+=5);const d=Math.min(Math.round(c/o*100),100);return{...l,matchScore:d}}).sort((l,c)=>c.matchScore-l.matchScore)}function la(a){if(a.langTestType==="celpip"){const t=["listening","reading","writing","speaking"].map(i=>parseInt(a[`celpip_${i}`])||0);return Math.min(...t)}if(a.langTestType==="ielts"){const t=["listening","reading","writing","speaking"].map(i=>{const r=parseFloat(a[`ielts_${i}`])||0;return r>=8?10:r>=7?9:r>=6.5?8:r>=6?7:r>=5.5?6:r>=5?5:r>=4?4:0});return Math.min(...t)}return 0}const Z={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.08}}},x={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{type:"spring",stiffness:100,damping:18}}};function da({value:a,duration:n=1.2}){const[t,i]=g.useState(0);return g.useEffect(()=>{const r=a,m=performance.now(),l=c=>{const o=(c-m)/(n*1e3);if(o>=1){i(r);return}const d=1-Math.pow(1-o,3);i(Math.round(r*d)),requestAnimationFrame(l)};requestAnimationFrame(l)},[a,n]),e.jsx(e.Fragment,{children:t})}function ha({score:a,statusColor:n}){const i=2*Math.PI*54,r=Math.min(a/1200,1);return e.jsxs("div",{className:"score-gauge","aria-label":`CRS Score: ${a} out of 1200`,children:[e.jsxs("svg",{viewBox:"0 0 120 120",width:"180",height:"180",children:[e.jsx("circle",{cx:"60",cy:"60",r:54,fill:"none",stroke:"var(--surface-2)",strokeWidth:"8"}),e.jsx(p.circle,{cx:"60",cy:"60",r:54,fill:"none",stroke:n,strokeWidth:"8",strokeLinecap:"round",transform:"rotate(-90 60 60)",strokeDasharray:i,initial:{strokeDashoffset:i},animate:{strokeDashoffset:i-r*i},transition:{duration:1.4,ease:[.22,1,.36,1]}})]}),e.jsxs("div",{className:"gauge-text",children:[e.jsx("div",{className:"gauge-number","aria-live":"polite",children:e.jsx(da,{value:a})}),e.jsx("div",{className:"gauge-max",children:"/ 1,200"})]})]})}function ua({icon:a,label:n,value:t,max:i,note:r}){const m=Math.round(t/i*100);return e.jsxs(p.div,{className:"bd-item",variants:x,children:[e.jsx("span",{className:"bd-icon",children:a}),e.jsxs("div",{className:"bd-info",children:[e.jsxs("div",{className:"bd-top",children:[e.jsxs("span",{className:"bd-label",children:[n,r&&e.jsxs("small",{className:"bd-note",children:[" (",r,")"]})]}),e.jsxs("span",{className:"bd-pts",children:[t," ",e.jsxs("small",{children:["/ ",i]})]})]}),e.jsx("div",{className:"bd-bar-bg",children:e.jsx(p.div,{className:"bd-bar-fill",initial:{width:0},animate:{width:`${m}%`},transition:{duration:.8,delay:.3,ease:"easeOut"}})})]})]})}function D({draw:a,userScore:n}){const t=n>=a.score;return e.jsxs("div",{className:`draw-row ${t?"draw-above":"draw-below"}`,children:[e.jsx("span",{className:"draw-date",children:a.date}),e.jsx("span",{className:"draw-program",children:a.program}),e.jsx("span",{className:"draw-score",children:a.score})]})}const ma=[{value:"secondary",label:"High School"},{value:"one_year_post",label:"1-Year Diploma"},{value:"two_year_post",label:"2-Year Diploma"},{value:"bachelors",label:"Bachelor's"},{value:"two_or_more",label:"2+ Credentials"},{value:"masters",label:"Master's"},{value:"doctoral",label:"PhD"}];function q(a,n,t){return{id:a,label:n,age:t.age||"",education:t.education||"",canadianWorkExp:t.canadianWorkExp||"0",minClb:""}}function pa(a){return{5:5,6:5.5,7:6,8:6.5,9:7,10:7.5}[a]||0}function fa(a,n){const t={};if(n.age&&n.age!==a.age&&(t.age=n.age),n.education&&n.education!==a.education&&(t.education=n.education),n.canadianWorkExp&&n.canadianWorkExp!==a.canadianWorkExp&&(t.canadianWorkExp=n.canadianWorkExp),n.minClb){const i=parseInt(n.minClb,10),r=["listening","reading","writing","speaking"];if(a.langTestType==="celpip")for(const m of r){const l=`celpip_${m}`;t[l]=String(Math.max(parseInt(a[l],10)||0,i))}else{const m=pa(i);for(const l of r){const c=`ielts_${l}`;t[c]=String(Math.max(parseFloat(a[c])||0,m))}}}return Object.keys(t).length===0?null:_(a,t)}function ga({answers:a,originalScore:n,t}){const[i,r]=g.useState(()=>[q("a","Scenario A",a),q("b","Scenario B",a)]),m=()=>{i.length>=3||r(o=>[...o,q("c","Scenario C",a)])},l=o=>{i.length<=2||r(d=>d.filter(h=>h.id!==o))},c=(o,d)=>{r(h=>h.map(u=>u.id===o?{...u,...d}:u))};return e.jsxs("div",{className:"scenario-panel",children:[e.jsx("div",{className:"scenario-grid",children:i.map(o=>{const d=fa(a,o),h=d?d.total-n:0;return e.jsxs("div",{className:"scenario-card",children:[e.jsxs("div",{className:"scenario-head",children:[e.jsx("strong",{children:o.label}),o.id==="c"&&e.jsx("button",{type:"button",className:"scenario-remove",onClick:()=>l(o.id),children:"Remove"})]}),e.jsxs("div",{className:"wi-grid",children:[e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Age"}),e.jsxs("select",{value:o.age,onChange:u=>c(o.id,{age:u.target.value}),children:[e.jsx("option",{value:"",children:"Current"}),Array.from({length:30},(u,b)=>b+18).map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Education"}),e.jsxs("select",{value:o.education,onChange:u=>c(o.id,{education:u.target.value}),children:[e.jsx("option",{value:"",children:"Current"}),ma.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))]})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Canadian Work (yrs)"}),e.jsx("select",{value:o.canadianWorkExp,onChange:u=>c(o.id,{canadianWorkExp:u.target.value}),children:[0,1,2,3,4,5].map(u=>e.jsx("option",{value:u,children:u},u))})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Min Language CLB"}),e.jsxs("select",{value:o.minClb,onChange:u=>c(o.id,{minClb:u.target.value}),children:[e.jsx("option",{value:"",children:"Current"}),[5,6,7,8,9,10].map(u=>e.jsxs("option",{value:u,children:["CLB ",u,"+"]},u))]})]})]}),d&&e.jsx(p.div,{className:"wi-result",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"wi-scores",children:[e.jsxs("div",{className:"wi-score-block",children:[e.jsx("small",{children:t("results.original")}),e.jsx("strong",{children:n})]}),e.jsx("span",{className:"wi-arrow",children:"→"}),e.jsxs("div",{className:"wi-score-block projected",children:[e.jsx("small",{children:t("results.projected")}),e.jsx("strong",{children:d.total})]}),e.jsxs("span",{className:`wi-delta ${h>0?"pos":h<0?"neg":""}`,children:[h>0?"+":"",h," pts"]})]})})]},o.id)})}),i.length<3&&e.jsx("button",{type:"button",className:"btn-toggle scenario-add-btn",onClick:m,children:"Add Scenario C ▼"})]})}function xa(){return e.jsx(p.div,{className:"loading-screen",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,scale:.95,transition:{duration:.3}},children:e.jsx(Ge,{})})}function ba(a){const n=g.useRef(null);return g.useEffect(()=>{if(!a)return;const t=n.current;if(!t)return;const i=t.getContext("2d");t.width=window.innerWidth,t.height=window.innerHeight;const r=["#22c55e","#4CC9F0","#7C3AED","#f59e0b","#ec4899","#3A0CA3"],m=Array.from({length:120},()=>({x:Math.random()*t.width,y:Math.random()*t.height-t.height,w:Math.random()*8+4,h:Math.random()*6+2,color:r[Math.floor(Math.random()*r.length)],vx:(Math.random()-.5)*4,vy:Math.random()*3+2,rot:Math.random()*360,rv:(Math.random()-.5)*8}));let l;const c=()=>{i.clearRect(0,0,t.width,t.height);let d=!1;for(const h of m)h.x+=h.vx,h.y+=h.vy,h.rot+=h.rv,h.vy+=.05,h.y<t.height+20&&(d=!0),i.save(),i.translate(h.x,h.y),i.rotate(h.rot*Math.PI/180),i.fillStyle=h.color,i.fillRect(-h.w/2,-h.h/2,h.w,h.h),i.restore();d&&(l=requestAnimationFrame(c))};l=requestAnimationFrame(c);const o=setTimeout(()=>{cancelAnimationFrame(l),i.clearRect(0,0,t.width,t.height)},4e3);return()=>{cancelAnimationFrame(l),clearTimeout(o)}},[a]),n}async function ee(a){try{return await navigator.clipboard.writeText(a),!0}catch{try{const n=document.createElement("textarea");return n.value=a,n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),!0}catch{return!1}}}function ya({answers:a,onRestart:n}){const{t}=Ae(),[i,r]=g.useState(!0),[m,l]=g.useState(!1),[c,o]=g.useState(!1),[d,h]=g.useState(!1),[u,b]=g.useState(!1),[S,N]=g.useState(!1),[L,re]=g.useState(""),[U,oe]=g.useState(""),[M,ce]=g.useState(!1),[J,T]=g.useState(""),[z,V]=g.useState(!1),[I,le]=g.useState(()=>`${window.location.origin}${window.location.pathname}#${Be(a)}`);g.useEffect(()=>{const s=setTimeout(()=>r(!1),2500);return()=>clearTimeout(s)},[]);const P=g.useMemo(()=>{if(a.knowsScore==="yes"){const s=parseInt(a.scoreRange,10)||400;return{total:s,breakdown:{coreHumanCapital:s,spouseFactors:0,skillTransferability:0,additionalPoints:0},details:{age:0,education:0,firstLanguage:0,secondLanguage:0,canadianWork:0,foreignWork:0,spouseTotal:0,skillTotal:0,additionalTotal:0}}}return ie(a)},[a]),$=a.knowsScore!=="yes",v=P.total,k=W.averageCutoff,w=v-k,de=Oe(),C=w>=20?{cls:"above",marker:"+",title:"Great News!",desc:`Your score is ${w} points above the recent cut-off (${k}). You have a strong chance of receiving an Invitation to Apply.`,color:"#22c55e"}:w>=-10?{cls:"close",marker:"~",title:"Almost There!",desc:`You're just ${Math.abs(w)} points ${w>=0?"above":"below"} the recent cut-off (${k}). A few small improvements could make the difference.`,color:"#f59e0b"}:{cls:"below",marker:"—",title:"Room to Improve",desc:`You're ${Math.abs(w)} points below the recent cut-off (${k}). Don't worry — see the suggestions below to boost your score.`,color:"#ef4444"},R=g.useMemo(()=>sa(a,P),[a,P]),F=g.useMemo(()=>ia(P),[P]),y=P.details,he=g.useMemo(()=>{const s=[{icon:"A",label:"Age",value:y.age,max:110},{icon:"E",label:"Education",value:y.education,max:150},{icon:"L",label:"English Language",value:y.firstLanguage,max:136},{icon:"W",label:"Canadian Work",value:y.canadianWork,max:80}];return y.secondLanguage>0&&s.splice(3,0,{icon:"F",label:"French",value:y.secondLanguage,max:24}),y.foreignWork>0?s.push({icon:"S",label:t("results.foreignWork"),value:y.skillTotal,max:100,note:"via skill transferability"}):s.push({icon:"S",label:"Skill Bonus",value:y.skillTotal,max:100}),y.spouseTotal>0&&s.push({icon:"P",label:"Spouse",value:y.spouseTotal,max:40}),y.additionalTotal>0&&s.push({icon:"+",label:"Bonus Points",value:y.additionalTotal,max:600}),s},[y,t]),ue=R.slice(0,3),O=R.slice(3),Y=Re[a.pathway],K=g.useMemo(()=>$?ca(a):[],[a,$]),X=!i&&w>=20,me=ba(X),pe=async()=>{try{if(navigator.share){await navigator.share({title:"My CRS Score",text:`My CRS score is ${v}/1200!`,url:I});return}}catch{}await ee(I)&&(N(!0),setTimeout(()=>N(!1),2e3))},fe=()=>{const s=Math.max(470,k),f=`My CRS = ${v} — see how to reach ${s}+`,E=`https://twitter.com/intent/tweet?text=${encodeURIComponent(f)}&url=${encodeURIComponent(I)}`;window.open(E,"_blank","noopener,noreferrer")},ge=async()=>{const s=U.trim();if(M&&!s){T("Add an email to enable draw alerts.");return}if(s&&!/^\S+@\S+\.\S+$/.test(s)){T("Please enter a valid email address.");return}const f=Ye({name:L.trim(),answers:a,score:v,email:s,alertOptIn:!!M&&!!s}),E=De(f.id,a);le(E),V(!0);try{s||M?(await qe(f)).status==="ok"?T(M?"Profile saved and draw alerts subscribed.":"Profile saved with shareable link."):T("Profile saved locally. Configure Supabase env vars to enable cloud sync/alerts."):T("Profile saved locally with a unique shareable link.")}catch(Q){T(`Profile saved locally, but cloud sync failed: ${Q.message}`)}finally{V(!1)}},xe=()=>window.print();return i?e.jsx(xa,{}):e.jsxs(p.div,{className:"results",variants:Z,initial:"hidden",animate:"show",exit:{opacity:0,transition:{duration:.2}},children:[X&&e.jsx("canvas",{ref:me,className:"confetti-canvas"}),e.jsx(p.div,{className:"score-hero",variants:x,children:e.jsx(ha,{score:v,statusColor:C.color})}),e.jsxs(p.div,{className:"result-actions",variants:x,children:[e.jsx("button",{className:"action-btn",onClick:pe,"aria-label":"Share results",children:S?"✓ Copied!":t("results.share")}),e.jsx("button",{className:"action-btn",onClick:fe,"aria-label":"Tweet score",children:"Share on X"}),e.jsx("button",{className:"action-btn",onClick:xe,"aria-label":"Download PDF",children:t("results.pdf")})]}),e.jsxs(p.div,{className:`card status-card ${C.cls}-card`,variants:x,children:[e.jsxs("div",{className:"status-header",children:[e.jsx("span",{className:`status-marker ${C.cls}`,children:C.marker})," ",e.jsx("strong",{children:C.title})]}),e.jsx("p",{className:"status-desc",children:C.desc}),e.jsxs("div",{className:"cutoff-compare",children:[e.jsx(ae,{label:"Your Score",value:v,max:Math.max(v,k,600),color:"var(--primary)"}),e.jsx(ae,{label:"Cut-off",value:k,max:Math.max(v,k,600),color:"var(--surface-3)"})]})]}),e.jsxs(p.div,{className:"card save-profile-card",variants:x,children:[e.jsx("h3",{children:"Save & share your profile"}),e.jsx("p",{className:"cat-intro",children:"Save this result, generate a unique URL, and optionally subscribe to draw alerts."}),e.jsxs("div",{className:"save-grid",children:[e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Profile name (optional)"}),e.jsx("input",{value:L,onChange:s=>re(s.target.value),placeholder:"e.g., Feb 2026 Profile"})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Email (optional)"}),e.jsx("input",{value:U,onChange:s=>oe(s.target.value),placeholder:"you@example.com"})]})]}),e.jsxs("label",{className:"save-alert-row",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:s=>ce(s.target.checked)}),e.jsx("span",{children:"Notify me by email when my score is at/above the latest cutoff"})]}),!de&&e.jsx("p",{className:"save-note",children:"Cloud alerts need Supabase env vars (`VITE_SUPABASE_URL`, `VITE_SUPABASE_ANON_KEY`)."}),e.jsxs("div",{className:"save-actions",children:[e.jsx("button",{className:"action-btn",onClick:ge,disabled:z,children:z?"Saving…":"Save Profile"}),e.jsx("button",{className:"action-btn",onClick:()=>ee(I),children:"Copy Share URL"})]}),e.jsx("p",{className:"save-url",children:I}),J&&e.jsx("p",{className:"save-status",children:J})]}),$&&e.jsxs(p.div,{className:"card",variants:x,children:[e.jsx("h3",{children:t("results.breakdown")}),e.jsx(p.div,{className:"breakdown-grid",variants:Z,initial:"hidden",animate:"show",children:he.map(s=>e.jsx(ua,{...s},s.label))}),e.jsxs("div",{className:"bd-total",children:[e.jsx("span",{children:"Total CRS Score"}),e.jsx("span",{className:"bd-total-num",children:v})]})]}),$&&e.jsxs(p.div,{className:"card whatif-card",variants:x,children:[e.jsxs("h3",{className:"draws-toggle",onClick:()=>h(!d),children:["Scenario Compare (A vs B) ",e.jsx("span",{className:"toggle-arrow",children:d?"▲":"▼"})]}),d&&e.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx("p",{className:"cat-intro",children:t("results.whatifDesc")}),e.jsx(ga,{answers:a,originalScore:v,t})]})]}),R.length>0&&e.jsxs(p.div,{className:"card",variants:x,children:[e.jsx("h3",{children:t("results.improve")}),ue.map((s,f)=>e.jsxs(p.div,{className:"action-card",variants:x,children:[e.jsx("div",{className:"action-rank",children:f+1}),e.jsxs("div",{className:"action-body",children:[e.jsxs("div",{className:"action-title",children:[s.title,s.potentialGain>0&&e.jsxs("span",{className:"action-badge",children:["+",s.potentialGain," pts"]})]}),e.jsx("div",{className:"action-desc",children:s.description}),s.action&&e.jsx("div",{className:"action-specific",children:s.action}),e.jsxs("div",{className:"action-meta",children:[e.jsx("span",{className:"action-time",children:s.timeframe}),e.jsx("span",{className:`action-diff diff-${s.difficulty.toLowerCase()}`,children:s.difficulty})]})]})]},f)),O.length>0&&e.jsxs(e.Fragment,{children:[m&&O.map((s,f)=>e.jsxs(p.div,{className:"action-card",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[e.jsx("div",{className:"action-rank",children:f+4}),e.jsxs("div",{className:"action-body",children:[e.jsxs("div",{className:"action-title",children:[s.title,s.potentialGain>0&&e.jsxs("span",{className:"action-badge",children:["+",s.potentialGain," pts"]})]}),e.jsx("div",{className:"action-desc",children:s.description}),s.action&&e.jsx("div",{className:"action-specific",children:s.action}),e.jsxs("div",{className:"action-meta",children:[e.jsx("span",{className:"action-time",children:s.timeframe}),e.jsx("span",{className:`action-diff diff-${s.difficulty.toLowerCase()}`,children:s.difficulty})]})]})]},f+3)),e.jsx("button",{className:"btn-toggle",onClick:()=>l(!m),children:m?"Show fewer ▲":`Show ${O.length} more suggestions ▼`})]})]}),$&&e.jsxs(p.div,{className:"card",variants:x,children:[e.jsx("h3",{children:t("results.category")}),e.jsx("p",{className:"cat-intro",children:t("results.catIntro")}),e.jsx("div",{className:"cat-grid",children:Fe.map(s=>{const f=s.check(a),E=f&&v>=s.recentCutoff;return e.jsxs(p.div,{className:`cat-card ${f?E?"cat-above":"cat-eligible":"cat-na"}`,variants:x,children:[e.jsxs("div",{className:"cat-header",children:[e.jsx("span",{className:"cat-icon",children:s.icon}),e.jsxs("div",{children:[e.jsx("strong",{className:"cat-name",children:s.name}),f&&e.jsx("span",{className:`cat-badge ${E?"badge-above":"badge-eligible"}`,children:E?"Above Cutoff":"Eligible"}),!f&&e.jsx("span",{className:"cat-badge badge-na",children:"Not Eligible"})]})]}),e.jsx("p",{className:"cat-desc",children:s.description}),e.jsxs("div",{className:"cat-cutoff",children:[e.jsxs("span",{children:["Recent cutoff: ",e.jsx("strong",{children:s.recentCutoff})]}),e.jsxs("span",{className:"cat-range",children:["Range: ",s.cutoffRange]})]}),!f&&e.jsx("p",{className:"cat-req",children:s.eligibility})]},s.id)})})]}),$&&K.length>0&&e.jsxs(p.div,{className:"card",variants:x,children:[e.jsxs("h3",{className:"draws-toggle",onClick:()=>b(!u),children:["Province Recommender ",e.jsx("span",{className:"toggle-arrow",children:u?"▲":"▼"})]}),u&&e.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx("p",{className:"cat-intro",children:"Based on your profile, these provinces may be good matches for Provincial Nominee Programs."}),e.jsx("div",{className:"prov-grid",children:K.slice(0,5).map(s=>e.jsxs("div",{className:"prov-card",children:[e.jsxs("div",{className:"prov-header",children:[e.jsx("span",{className:"prov-abbr",children:s.abbr}),e.jsxs("div",{children:[e.jsx("strong",{className:"prov-name",children:s.name}),e.jsxs("span",{className:`prov-match ${s.matchScore>=70?"match-high":s.matchScore>=40?"match-mid":"match-low"}`,children:[s.matchScore,"% match"]})]})]}),e.jsx("div",{className:"prov-bar-wrap",children:e.jsx(p.div,{className:"prov-bar",initial:{width:0},animate:{width:`${s.matchScore}%`},transition:{duration:.8,ease:"easeOut"},style:{background:s.matchScore>=70?"#22c55e":s.matchScore>=40?"#f59e0b":"var(--surface-3)"}})}),e.jsx("p",{className:"prov-notes",children:s.notes})]},s.id))})]})]}),e.jsxs(p.div,{className:"card",variants:x,children:[e.jsx("h3",{children:t("results.timeline")}),e.jsxs("div",{className:`timeline-badge tl-${C.cls}`,children:[e.jsx("strong",{children:F.label})," — est. ",F.months," months"]}),e.jsx("p",{className:"timeline-desc",children:F.description})]}),e.jsxs(p.div,{className:"card",variants:x,children:[e.jsxs("h3",{className:"draws-toggle",onClick:()=>o(!c),children:[t("results.draws")," ",e.jsx("span",{className:"toggle-arrow",children:c?"▲":"▼"})]}),c&&e.jsxs(p.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"draws-content",children:[e.jsx("h4",{className:"draws-subhead",children:"General / CEC Draws"}),W.generalProgram.slice(0,4).map((s,f)=>e.jsx(D,{draw:s,userScore:v},`g${f}`)),e.jsx("h4",{className:"draws-subhead",children:"Category-Based Draws"}),W.categoryBased.slice(0,4).map((s,f)=>e.jsx(D,{draw:s,userScore:v},`c${f}`)),!!W.pnpDraws?.length&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"draws-subhead",children:"Provincial Nominee (PNP)"}),W.pnpDraws.slice(0,3).map((s,f)=>e.jsx(D,{draw:s,userScore:v},`p${f}`))]})]})]}),Y&&e.jsxs(p.div,{className:"card",variants:x,children:[e.jsxs("h3",{children:[Y.name," Requirements"]}),e.jsx("ul",{className:"pathway-list",children:Y.requirements.map((s,f)=>e.jsx("li",{children:s},f))})]}),e.jsx(p.div,{className:"card disclaimer",variants:x,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Disclaimer:"})," ",t("results.disclaimer")," ",e.jsx("a",{href:"https://www.canada.ca/en/immigration-refugees-citizenship.html",target:"_blank",rel:"noopener noreferrer",children:"canada.ca"})]})}),e.jsx(p.button,{className:"btn-restart",onClick:n,whileHover:{scale:1.03},whileTap:{scale:.96},variants:x,children:t("results.restart")})]})}function ae({label:a,value:n,max:t,color:i}){const r=Math.round(n/t*100);return e.jsxs("div",{className:"cutoff-row",children:[e.jsx("span",{className:"cutoff-label",children:a}),e.jsx("div",{className:"cutoff-bar-wrap",children:e.jsx(p.div,{className:"cutoff-bar",style:{background:i},initial:{width:0},animate:{width:`${r}%`},transition:{duration:.8,ease:"easeOut"},children:n})})]})}export{ya as default};
