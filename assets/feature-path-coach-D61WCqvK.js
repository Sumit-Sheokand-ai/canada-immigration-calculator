import{r as f,j as i}from"./vendor-react-Ah1pgjPn.js";import{c as qe,a as Ve,b as Ze,d as Xe,e as Qe,f as et,s as tt,g as nt,h as st,i as at,j as it,k as rt,l as ot,m as ct,n as lt,o as dt,p as ut,q as ht,r as we}from"./data-question-bank-F-s7nTqV.js";import{c as ft}from"./vendor-supabase-BZ0N5lZN.js";import{u as pt,m as Z}from"./vendor-motion-DURBmaq0.js";const gt="https://rvijvbcknwwtfhulsesk.supabase.co",Ce="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ2aWp2YmNrbnd3dGZodWxzZXNrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3NTY0NDIsImV4cCI6MjA3ODMzMjQ0Mn0.Nw7gfls2IHV88r4kFBXKRsAFfVqeDcTxQVwDo6OzDrg",A=!!Ce,x=A?ft(gt,Ce,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}):null,ve=f.createContext(null);function me(){return`${window.location.origin}${window.location.pathname}`}function wn({children:e}){const[t,n]=f.useState(A),[s,a]=f.useState(null),[r,c]=f.useState(null);f.useEffect(()=>{if(!A||!x)return;let l=!0;x.auth.getSession().then(({data:j,error:N})=>{if(l){if(N){n(!1);return}a(j.session||null),c(j.session?.user||null),n(!1)}}).catch(()=>{l&&n(!1)});const{data:u}=x.auth.onAuthStateChange((j,N)=>{a(N||null),c(N?.user||null),n(!1)});return()=>{l=!1,u?.subscription?.unsubscribe()}},[]);const d=f.useCallback(async l=>{if(!A||!x)throw new Error("Supabase auth is not configured.");const{error:u}=await x.auth.signInWithOtp({email:l,options:{shouldCreateUser:!0,emailRedirectTo:me()}});if(u)throw u;return{status:"sent"}},[]),h=f.useCallback(async l=>d(l),[d]),p=f.useCallback(async(l,u)=>{if(!A||!x)throw new Error("Supabase auth is not configured.");const j=["email","magiclink","signup"];let N=null;for(const U of j){const{data:z,error:C}=await x.auth.verifyOtp({email:l,token:u,type:U});if(!C)return z;N=C}throw N||new Error("Unable to verify the email code.")},[]),m=f.useCallback(async()=>{if(!A||!x)throw new Error("Supabase auth is not configured.");const{error:l}=await x.auth.signInWithOAuth({provider:"google",options:{redirectTo:me()}});if(l)throw l;return{status:"redirecting"}},[]),y=f.useCallback(async()=>{if(!x)return;const{error:l}=await x.auth.signOut();if(l)throw l},[]),w=f.useCallback(async({fullName:l})=>{if(!A||!x)throw new Error("Supabase auth is not configured.");const u={};typeof l=="string"&&(u.data={full_name:l.trim()});const{data:j,error:N}=await x.auth.updateUser(u);if(N)throw N;return j?.user&&c(j.user),j},[]),b=f.useCallback(async()=>{if(!A||!x)return null;const{data:l,error:u}=await x.auth.getSession();if(u)throw u;return a(l.session||null),c(l.session?.user||null),l.session||null},[]),S=f.useMemo(()=>({isConfigured:A,loading:t,session:s,user:r,isAuthenticated:!!r,sendEmailOtp:h,sendEmailMagicLink:d,verifyEmailOtp:p,signInWithGoogle:m,signOut:y,updateProfile:w,refreshSession:b}),[t,b,d,h,s,m,y,w,r,p]);return i.jsx(ve.Provider,{value:S,children:e})}function mt(){const e=f.useContext(ve);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function yt({as:e="div",className:t="",color:n="white",speed:s="6s",children:a,...r}){return i.jsxs(e,{className:`star-border ${t}`,style:{...r.style},...r,children:[i.jsx("div",{className:"star-border__glow star-border__glow--bottom",style:{background:`radial-gradient(circle, ${n}, transparent 10%)`,animationDuration:s}}),i.jsx("div",{className:"star-border__glow star-border__glow--top",style:{background:`radial-gradient(circle, ${n}, transparent 10%)`,animationDuration:s}}),i.jsx("div",{className:"star-border__inner",children:a})]})}const k={tables:{agePoints:Xe,educationPoints:Qe,firstLangPoints:et,secondLangPoints:tt,canadianWorkPoints:nt,spouseEducationPoints:st,spouseLangPoints:ut,spouseWorkPoints:at,eduRank:it,eduLangTransfer:rt,eduCWETransfer:ot,fweLangTransfer:ct,fweCWETransfer:lt,certLangTransfer:ht,additionalPointsTable:dt},converters:{ieltsToCLB:Ze,tefToNCLC:qe,tcfToNCLC:Ve},caps:{secondLanguageNoSpouse:24,secondLanguageWithSpouse:22,spouseTotal:40,skillTransferabilityTotal:100,additionalPointsTotal:600,crsTotal:1200}},je=(e,t,n)=>Math.max(t,Math.min(n,e));function kt(e){const t={...e},n=Y(e)==="french"||e.hasFrench==="yes";if(n&&e.frenchTestType==="tef")for(const s of["listening","reading","writing","speaking"])t[`french_${s}`]=String(k.converters.tefToNCLC(s,parseInt(e[`tef_${s}`],10)||0));else if(n&&e.frenchTestType==="tcf")for(const s of["listening","reading","writing","speaking"])t[`french_${s}`]=String(k.converters.tcfToNCLC(s,parseInt(e[`tcf_${s}`],10)||0));return t}function Y(e){return e.firstOfficialLanguage==="french"?"french":"english"}function te(e){return Y(e)==="french"||e.hasFrench==="yes"}function ne(e){return e.hasSpouse==="yes"&&e.spouseIsCanadian!=="yes"&&e.spouseAccompanying!=="no"}const R=e=>ne(e)?1:0;function se(e,t){if(e.langTestType==="celpip")return je(parseInt(e[`celpip_${t}`],10)||0,0,12);const n=parseFloat(e[`ielts_${t}`])||0;return k.converters.ieltsToCLB(t,n)}function ae(e,t){return je(parseInt(e[`french_${t}`],10)||0,0,12)}function Ne(e,t){return Y(e)==="french"?ae(e,t):se(e,t)}function ie(e){const t=["listening","reading","writing","speaking"];let n=99;for(const s of t){const a=Ne(e,s);a<n&&(n=a)}return n===99?0:n}function xt(e){const t=["listening","reading","writing","speaking"];let n=99;for(const s of t){const a=se(e,s);a<n&&(n=a)}return n===99?0:n}function bt(e){if(!te(e))return 0;const t=["listening","reading","writing","speaking"];let n=99;for(const s of t){const a=ae(e,s);a<n&&(n=a)}return n===99?0:n}function St(e){const t=ie(e);return t>=9?2:t>=7?1:0}function Tt(e){const t=parseInt(e.canadianWorkExp)||0;return t>=2?2:t>=1?1:0}function wt(e){const t=parseInt(e.foreignWorkExp)||0;return t>=3?2:t>=1?1:0}function Ct(e){let t=parseInt(e.age);return isNaN(t)?0:(t<18&&(t=17),t>47&&(t=47),t>44&&(t=45),k.tables.agePoints[t]?.[R(e)]||0)}function vt(e){return k.tables.educationPoints[e.education]?.[R(e)]||0}function jt(e){const t=["listening","reading","writing","speaking"],n=R(e);return t.reduce((s,a)=>{const r=Ne(e,a);return s+(k.tables.firstLangPoints[r]?.[n]||0)},0)}function Nt(e){const t=Y(e);if(!(t==="french"?e.langTestType==="ielts"||e.langTestType==="celpip":te(e)))return 0;const s=["listening","reading","writing","speaking"],a=R(e),r=s.reduce((c,d)=>{const h=t==="french"?se(e,d):ae(e,d);return c+(k.tables.secondLangPoints[h]?.[a]||0)},0);return Math.min(r,a===0?k.caps.secondLanguageNoSpouse:k.caps.secondLanguageWithSpouse)}function _t(e){let t=parseInt(e.canadianWorkExp)||0;return t>5&&(t=5),k.tables.canadianWorkPoints[t]?.[R(e)]||0}function Pt(e){if(!ne(e))return 0;let t=0;t+=k.tables.spouseEducationPoints[e.spouseEducation]||0;const n=["listening","reading","writing","speaking"];let s=0;for(const r of n){const c=parseInt(e[`spouseLang_${r}`])||0;s+=k.tables.spouseLangPoints[c]||0}t+=Math.min(s,20);let a=parseInt(e.spouseCanadianWork)||0;return a>5&&(a=5),t+=k.tables.spouseWorkPoints[a]||0,Math.min(t,k.caps.spouseTotal)}function Mt(e){const t=k.tables.eduRank[e.education]||0,n=St(e),s=Tt(e),a=wt(e),r=k.tables.eduLangTransfer[t]?.[n]||0,c=k.tables.eduCWETransfer[t]?.[s]||0,d=Math.min(r+c,50),h=k.tables.fweLangTransfer[a]?.[n]||0,p=k.tables.fweCWETransfer[a]?.[s]||0,m=Math.min(h+p,50);let y=0;if(e.pathway==="fst"&&e.hasCertificate==="yes"){const w=ie(e);y=k.tables.certLangTransfer[w>=7?2:w>=5?1:0]}return Math.min(d+m+y,k.caps.skillTransferabilityTotal)}function At(e){let t=0;const n=k.tables.additionalPointsTable;return e.hasPNP==="yes"&&(t+=n.pnp_nomination),e.canadianEducation==="yes"&&(t+=e.canadianEduType==="long"?n.canadian_edu_long:n.canadian_edu_short),e.hasSibling==="yes"&&(t+=n.sibling_in_canada),te(e)&&bt(e)>=7&&(t+=xt(e)>=5?n.french_strong_strong_english:n.french_strong_weak_english),Math.min(t,k.caps.additionalPointsTotal)}function Dt(e){const t=kt(e),n=Ct(t),s=vt(t),a=jt(t),r=Nt(t),c=_t(t),d=parseInt(t.foreignWorkExp)||0,h=n+s+a+r+c,p=Pt(t),m=Mt(t),y=At(t);return{total:Math.min(h+p+m+y,k.caps.crsTotal),breakdown:{coreHumanCapital:h,spouseFactors:p,skillTransferability:m,additionalPoints:y},details:{age:n,education:s,firstLanguage:a,secondLanguage:r,canadianWork:c,foreignWork:d,spouseTotal:p,skillTotal:m,additionalTotal:y}}}function Et(e,t){return Dt({...e,...t})}const X=["less_than_secondary","secondary","one_year_post","two_year_post","bachelors","two_or_more","masters","doctoral"],It={Easy:14,Medium:7,Hard:0},_e={high:78,medium:58,low:35};function Q(e,t,n){return Math.max(t,Math.min(n,e))}function Lt(e,t=we.averageCutoff){return Math.max(t+10,e+25)}function Ft(e,t){return{listening:{7:6,8:7.5,9:8,10:8.5},reading:{7:6,8:6.5,9:7,10:8},writing:{7:6,8:6.5,9:7,10:7.5},speaking:{7:6,8:6.5,9:7,10:7.5}}[e]?.[t]||0}function Wt(e,t){if(e.firstOfficialLanguage==="french"){const s=["listening","reading","writing","speaking"],a={hasFrench:"yes",frenchTestType:"clb"};for(const r of s){const c=`french_${r}`;a[c]=String(Math.max(parseInt(e[c],10)||0,t))}return a}const n=["listening","reading","writing","speaking"];if(e.langTestType==="celpip"){const s={};for(const a of n){const r=`celpip_${a}`;s[r]=String(Math.max(parseInt(e[r],10)||0,t))}return s}if(e.langTestType==="ielts"){const s={};for(const a of n){const r=`ielts_${a}`,c=Ft(a,t);s[r]=String(Math.max(parseFloat(e[r])||0,c))}return s}return{langTestType:"celpip",celpip_listening:String(t),celpip_reading:String(t),celpip_writing:String(t),celpip_speaking:String(t)}}function $t(e,t=7){const n={listening:parseInt(e.french_listening,10)||0,reading:parseInt(e.french_reading,10)||0,writing:parseInt(e.french_writing,10)||0,speaking:parseInt(e.french_speaking,10)||0};return{hasFrench:"yes",frenchTestType:"clb",french_listening:String(Math.max(n.listening,t)),french_reading:String(Math.max(n.reading,t)),french_writing:String(Math.max(n.writing,t)),french_speaking:String(Math.max(n.speaking,t))}}function Ot({pathId:e,gain:t,months:n,steps:s}){return s.map((a,r)=>({id:`${e}-m${r+1}`,title:a.title,details:a.details,etaWeeks:a.etaWeeks,expectedGain:r===s.length-1?Math.max(t-s.slice(0,-1).reduce((c,d)=>c+d.expectedGain,0),0):a.expectedGain,done:!1,monthHint:Q(Math.ceil((a.etaWeeks||1)/4),1,n)}))}function Pe({gain:e,months:t,difficulty:n,goalReached:s,likelihood:a}){const r=Q(24-t*2,0,24),c=Q(Math.round(e/4),0,80),d=s?32:0,h=Math.round((_e[a]||0)/3);return c+r+d+h+(It[n]||0)}function $({id:e,title:t,summary:n,category:s,difficulty:a,months:r,estimatedCostCad:c,whyItFits:d,likelihood:h="medium",overrides:p,currentScore:m,targetScore:y,milestoneSteps:w}){const b=Et(p.baseAnswers,p.patch),S=b.total-m;if(S<=0)return null;const l=b.total>=y,u=Ot({pathId:e,gain:S,months:r,steps:w});return{id:e,title:t,summary:n,category:s,difficulty:a,estimatedMonths:r,estimatedCostCad:c,projectedScore:b.total,potentialGain:S,goalReached:l,whyItFits:d,likelihood:h,likelihoodPercent:_e[h]||50,fitScore:Pe({gain:S,months:r,difficulty:a,goalReached:l,likelihood:h}),milestones:u,checks:{targetScore:y,currentScore:m,stillNeededAfterPath:Math.max(y-b.total,0)}}}function Gt(e,t,n){const s=ie(e);if(s>=10)return null;const a=s<7?8:9,r=e.firstOfficialLanguage==="french"?"french":"english",c=r==="french"?"French Accelerator Path":"English Accelerator Path",d=r==="french"?"Raise your weakest French ability first, then target NCLC 9+ for stronger transferability outcomes.":"Raise your weakest English ability first, then target CLB 9+ for transferability gains.";return $({id:`${r}-accelerator`,title:c,summary:d,category:"Language",difficulty:"Medium",months:4,estimatedCostCad:460,whyItFits:`Your current minimum first-official-language level is CLB/NCLC ${s}, so language gains are one of the fastest realistic boosters.`,likelihood:"high",overrides:{baseAnswers:e,patch:Wt(e,a)},currentScore:t,targetScore:n,milestoneSteps:[{title:"Baseline audit and weak-skill diagnosis",details:"Run a mock test and identify the lowest 2 abilities to prioritize.",etaWeeks:1,expectedGain:0},{title:"Targeted study sprint",details:"Follow a 5-day weekly schedule focused on weakest modules and timed drills.",etaWeeks:6,expectedGain:8},{title:"Exam booking + strategy correction",details:"Book IELTS/CELPIP and fine-tune pacing, vocabulary, and response format.",etaWeeks:4,expectedGain:8},{title:"Retake and profile refresh",details:"Update final language scores in your profile and reassess draw competitiveness.",etaWeeks:4,expectedGain:12}]})}function Bt(e,t,n){return e.firstOfficialLanguage==="french"?null:$({id:"french-advantage",title:"French Advantage Path",summary:"Reach NCLC 7 in all French abilities to unlock additional points and French-category draw access.",category:"Language",difficulty:"Hard",months:8,estimatedCostCad:690,whyItFits:"French pathways remain one of the highest-yield options for many candidates below general cutoffs.",likelihood:e.hasFrench==="yes"?"high":"medium",overrides:{baseAnswers:e,patch:$t(e,7)},currentScore:t,targetScore:n,milestoneSteps:[{title:"French baseline + study plan",details:"Assess current level and choose a structured curriculum for NCLC 7 goal.",etaWeeks:2,expectedGain:0},{title:"Core skill build phase",details:"Intensive reading/listening practice with weekly speaking/writing correction.",etaWeeks:12,expectedGain:8},{title:"TEF/TCF prep and mock cycles",details:"Complete timed mocks and focus weak modules before exam booking.",etaWeeks:8,expectedGain:8},{title:"Exam and score integration",details:"Enter verified NCLC scores and evaluate French-category competitiveness.",etaWeeks:6,expectedGain:12}]})}function Rt(e,t,n){const s=parseInt(e.canadianWorkExp,10)||0;return s>=5?null:$({id:"canadian-work-ladder",title:"Canadian Work Ladder Path",summary:"Add one more year of Canadian skilled work to increase core and transferability points.",category:"Work Experience",difficulty:"Hard",months:12,estimatedCostCad:0,whyItFits:`You currently report ${s} year(s) of Canadian work; the next year can materially lift your score.`,likelihood:"medium",overrides:{baseAnswers:e,patch:{canadianWorkExp:String(s+1)}},currentScore:t,targetScore:n,milestoneSteps:[{title:"Employer alignment",details:"Confirm TEER eligibility and maintain full-time skilled role continuity.",etaWeeks:2,expectedGain:0},{title:"Documentation discipline",details:"Collect monthly pay records and letters for future proof of experience.",etaWeeks:16,expectedGain:4},{title:"Mid-year score checkpoint",details:"Recalculate progress and combine with language upgrades if needed.",etaWeeks:24,expectedGain:6},{title:"Complete one full year increment",details:"Update profile immediately when additional year is met.",etaWeeks:52,expectedGain:12}]})}function Ut(e,t,n){const s=X.indexOf(e.education);if(s<0||s>=X.length-1)return null;const a=X[s+1];return $({id:"education-upgrade",title:"Education Upgrade Path",summary:"Move to the next recognized credential tier for predictable CRS uplift.",category:"Education",difficulty:"Hard",months:18,estimatedCostCad:12e3,whyItFits:`Your current education level can be improved to ${a.replace(/_/g," ")} for additional points.`,likelihood:"medium",overrides:{baseAnswers:e,patch:{education:a}},currentScore:t,targetScore:n,milestoneSteps:[{title:"Program selection",details:"Choose an accredited credential path aligned to CRS point tiers.",etaWeeks:4,expectedGain:0},{title:"Enrollment and milestone completion",details:"Track term-level progress to keep the plan on schedule.",etaWeeks:20,expectedGain:4},{title:"Credential completion prep",details:"Prepare final documents and ECA requirements where needed.",etaWeeks:20,expectedGain:4},{title:"Credential update in profile",details:"Add completed credential and recalculate total score immediately.",etaWeeks:28,expectedGain:10}]})}function zt(e,t,n){if(!ne(e))return null;const s=["listening","reading","writing","speaking"],a={};for(const r of s){const c=`spouseLang_${r}`;a[c]=String(Math.max(parseInt(e[c],10)||0,9))}return $({id:"spouse-optimization",title:"Spouse Optimization Path",summary:"Use spouse language and experience factors for faster low-cost point improvements.",category:"Family Factors",difficulty:"Medium",months:5,estimatedCostCad:420,whyItFits:"You have an accompanying spouse, so spouse-factor optimization is available and often underused.",likelihood:"high",overrides:{baseAnswers:e,patch:a},currentScore:t,targetScore:n,milestoneSteps:[{title:"Spouse baseline review",details:"Identify spouse factors currently missing points.",etaWeeks:1,expectedGain:0},{title:"Spouse language prep",details:"Prepare specifically for CLB 9 in the weakest spouse abilities.",etaWeeks:8,expectedGain:4},{title:"Spouse profile integration",details:"Update spouse test scores and re-optimize joint profile configuration.",etaWeeks:6,expectedGain:8}]})}function Ht(e,t,n){return e.hasPNP==="yes"?null:$({id:"pnp-fast-track",title:"PNP Fast-Track Path",summary:"Pursue provincial nomination for the largest single CRS jump (+600).",category:"Provincial",difficulty:"Hard",months:6,estimatedCostCad:2200,whyItFits:"If your baseline is below recent cutoffs, PNP remains the most direct guaranteed-lift route.",likelihood:"medium",overrides:{baseAnswers:e,patch:{hasPNP:"yes"}},currentScore:t,targetScore:n,milestoneSteps:[{title:"Province shortlist",details:"Match your profile to provinces aligned with occupation/language strengths.",etaWeeks:2,expectedGain:0},{title:"Document stack preparation",details:"Prepare references, test proofs, ECA, and provincial forms early.",etaWeeks:6,expectedGain:0},{title:"Submit nomination stream",details:"Apply to selected stream and monitor NOI/application updates.",etaWeeks:8,expectedGain:0},{title:"Nomination linked to profile",details:"Accept nomination and refresh profile for major score jump.",etaWeeks:8,expectedGain:600}]})}function Kt(e,t){const n=[...e].sort((h,p)=>p.fitScore-h.fitScore);if(n.length<2)return null;const[s,a]=n,r=Math.min(s.projectedScore+a.potentialGain,1200),c=r-s.checks.currentScore;if(c<=0)return null;const d=r>=t;return{id:"combo-bridge-plan",title:"Bridge Combination Path",summary:`Combine “${s.title}” + “${a.title}” to maximize speed while limiting risk.`,category:"Combination",difficulty:s.difficulty==="Hard"||a.difficulty==="Hard"?"Hard":"Medium",estimatedMonths:Math.round((s.estimatedMonths+a.estimatedMonths)/2),estimatedCostCad:s.estimatedCostCad+a.estimatedCostCad,projectedScore:r,potentialGain:c,goalReached:d,whyItFits:"A blended route often reaches target faster than single-track attempts.",likelihood:"medium",likelihoodPercent:62,fitScore:Pe({gain:c,months:Math.round((s.estimatedMonths+a.estimatedMonths)/2),difficulty:s.difficulty==="Hard"||a.difficulty==="Hard"?"Hard":"Medium",goalReached:d,likelihood:"medium"}),milestones:[...s.milestones.slice(0,2).map(h=>({...h,id:`combo-${h.id}`})),...a.milestones.slice(0,2).map(h=>({...h,id:`combo-${h.id}`})),{id:"combo-final-sync",title:"Final score synchronization",details:"Update all achieved improvements together and reassess draw strategy.",etaWeeks:4,expectedGain:Math.max(c-16,0),done:!1,monthHint:2}],checks:{targetScore:t,currentScore:s.checks.currentScore,stillNeededAfterPath:Math.max(t-r,0)}}}function Yt(e,t,n={}){const s=t?.total||0,a=Number(n.averageCutoff)||we.averageCutoff,r=Number(n.targetScore)||Lt(s,a),c=[Gt(e,s,r),Bt(e,s,r),Rt(e,s,r),Ut(e,s,r),zt(e,s,r),Ht(e,s,r)].filter(Boolean),d=Kt(c,r);d&&c.push(d);const h=c.sort((p,m)=>m.fitScore-p.fitScore).slice(0,5);return{currentScore:s,targetScore:r,plans:h,generatedAt:new Date().toISOString()}}const Me="crs-path-tracking-v1",ye=540,Ae=55,Jt=30,qt=25;function De(e,t,n){return Math.max(t,Math.min(n,e))}function Ee(){return typeof localStorage<"u"}function M(e=new Date){const t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?"":t.toISOString().slice(0,10)}function Ie(e){return new Date(`${e}T00:00:00.000Z`)}function re(e,t){const n=new Date(e||Date.now());return n.setDate(n.getDate()+t),n.toISOString()}function W(e,t){const n=Ie(e);return n.setUTCDate(n.getUTCDate()+t),M(n)}function oe(){if(!Ee())return{};try{const e=localStorage.getItem(Me);if(!e)return{};const t=JSON.parse(e);return t&&typeof t=="object"?t:{}}catch{return{}}}function Le(e){if(Ee())try{localStorage.setItem(Me,JSON.stringify(e))}catch{}}function ce(e,t){if(!e||typeof e!="object")return null;const n=Math.max(1,Number(e.etaWeeks)||1);return{...e,id:e.id||`m_${t+1}`,title:e.title||`Milestone ${t+1}`,details:e.details||"",etaWeeks:n,expectedGain:Number.isFinite(Number(e.expectedGain))?Number(e.expectedGain):0,done:!!e.done,completedAt:e.completedAt||null}}function Fe(e,t){if(!e||typeof e!="object")return null;const n=M(e.date||e.dateKey||e.scheduledFor);return n?{id:e.id||`d_${t+1}`,date:n,milestoneId:e.milestoneId||null,title:String(e.title||"Daily action").trim(),details:String(e.details||"").trim(),expectedMinutes:Math.max(10,Number(e.expectedMinutes)||Ae),expectedGain:Number.isFinite(Number(e.expectedGain))?Number(e.expectedGain):0,done:!!e.done,completedAt:e.completedAt||null}:null}function We(e,t){const n=(e?.milestones||[]).map((c,d)=>ce(c,d)).filter(Boolean);if(!n.length)return[];const s=M(t||new Date);if(!s)return[];const a=[];let r=0;for(const c of n){const d=De(Math.round((Number(c.etaWeeks)||1)*7),7,224),h=d>0?Number(((Number(c.expectedGain)||0)/d).toFixed(2)):0;for(let p=0;p<d&&a.length<ye;p++){const m=W(s,r+p),y=Ie(m).getUTCDay(),w=y===0||y===6,b=p===0;let S=`Focused practice: ${c.title}`,l=c.details||"Work toward this milestone today.",u=w?Jt:Ae;b?(S=`Kickoff plan: ${c.title}`,l=`Set tasks and resources for this phase. ${c.details||""}`.trim(),u=qt):w&&(S=`Weekly review: ${c.title}`,l=`Light revision + progress check. ${c.details||""}`.trim()),a.push({id:`${e?.id||"path"}-d${a.length+1}`,date:m,milestoneId:c.id,title:S,details:l,expectedMinutes:u,expectedGain:h,done:!1,completedAt:null})}if(r+=d,a.length>=ye)break}return a}function $e(e){if(!e||typeof e!="object")return null;const t=e.startedAt||new Date().toISOString(),n=(e.milestones||[]).map((r,c)=>ce(r,c)).filter(Boolean),s=(e.dailyTasks||[]).map((r,c)=>Fe(r,c)).filter(Boolean),a=s.length>0?s:We(e.selectedPath,t);return{...e,id:e.id||`track_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`,status:e.status||"active",startedAt:t,updatedAt:e.updatedAt||t,nextCheckInAt:e.nextCheckInAt||re(t,7),currentScore:Number(e.currentScore)||0,targetScore:Number(e.targetScore)||Number(e?.selectedPath?.checks?.targetScore)||0,selectedPath:e.selectedPath||null,milestones:n,dailyTasks:a,notes:Array.isArray(e.notes)?e.notes:[],dailyStats:e.dailyStats||null}}function D(e,{touchUpdatedAt:t=!0}={}){const n=$e(e);if(!n)return null;const s=Oe(n),a=J(n),r=n.milestones.length>0&&n.milestones.every(h=>h.done),c=n.dailyTasks.length===0||n.dailyTasks.every(h=>h.done);return{...n,status:r&&c?"completed":"active",progressPct:s,dailyStats:a,updatedAt:t?new Date().toISOString():n.updatedAt}}function Vt(e=null,t=null){return e?`user:${e}`:t?`profile:${t}`:"guest:default"}function ke(e){if(!e)return null;const t=oe();return D(t[e],{touchUpdatedAt:!1})}function xe(e,t){if(!e||!t)return t;const n=oe(),s=D(t,{touchUpdatedAt:!1});return n[e]=s,Le(n),s}function Zt(e){if(!e)return;const t=oe();delete t[e],Le(t)}function Xt(e,t,n){const s=new Date().toISOString(),a=(e?.milestones||[]).map((c,d)=>ce({...c,done:!1,completedAt:null},d)).filter(Boolean),r=We(e,s);return D({id:`track_${Date.now().toString(36)}_${Math.random().toString(36).slice(2,8)}`,status:"active",startedAt:s,updatedAt:s,nextCheckInAt:re(s,7),currentScore:Number(t)||0,targetScore:Number(n)||Number(e?.checks?.targetScore)||0,selectedPath:e,milestones:a,dailyTasks:r,notes:[]},{touchUpdatedAt:!0})}function Oe(e){const t=e?.milestones||[],n=e?.dailyTasks||[],s=t.length?t.filter(r=>r.done).length/t.length:0,a=n.length?n.filter(r=>r.done).length/n.length:0;return!t.length&&!n.length?0:n.length?t.length?Math.round((s*.65+a*.35)*100):Math.round(a*100):Math.round(s*100)}function J(e){const t=(e?.dailyTasks||[]).map((l,u)=>Fe(l,u)).filter(Boolean).sort((l,u)=>l.date.localeCompare(u.date)),n=M(new Date);if(!t.length)return{totalTasks:0,completedTasks:0,completionPct:0,dueToday:0,completedToday:0,overdueTasks:0,expectedByToday:0,completedByToday:0,paceStatus:"not-started",streakDays:0,todayKey:n};const s=t.length,a=t.filter(l=>l.done).length,r=t.filter(l=>l.date===n).length,c=t.filter(l=>l.date===n&&l.done).length,d=t.filter(l=>l.date<=n).length,h=t.filter(l=>l.date<=n&&l.done).length,p=t.filter(l=>l.date<n&&!l.done).length,m=Math.round(a/s*100);let y="not-started";if(d>0){const l=h/d;l>=1?y="on-track":l>=.75?y="slightly-behind":y="behind"}const w=new Set(t.filter(l=>l.done).map(l=>M(l.completedAt||l.date)).filter(Boolean));let b=n;!w.has(b)&&r===0&&(b=W(n,-1));let S=0;for(;w.has(b);)S+=1,b=W(b,-1);return{totalTasks:s,completedTasks:a,completionPct:m,dueToday:r,completedToday:c,overdueTasks:p,expectedByToday:d,completedByToday:h,paceStatus:y,streakDays:S,todayKey:n}}function Qt(e,t=M(new Date)){return(e?.dailyTasks||[]).filter(s=>M(s.date)===t)}function en(e,t=7,n=M(new Date)){const s=W(n,Math.max(t-1,0));return(e?.dailyTasks||[]).filter(a=>{const r=M(a.date);return r>=n&&r<=s})}function tn(e){const t=$e(e);if(!t||!t.dailyTasks.length)return null;const n=J(t),s=t.dailyTasks.length,a=t.dailyTasks[0]?.date||M(t.startedAt),r=s,c=n.expectedByToday>0?n.completedByToday/n.expectedByToday:1,d=De(c||1,.45,1.35),h=Math.max(1,Math.round(s/d)),p=W(a,r-1),m=W(a,h-1);return{baselineDate:p,projectedDate:m,paceMultiplier:d,baselineDays:r,projectedDays:h,delayDays:h-r}}function nn(e,t){if(!e)return e;const n=(e.milestones||[]).map(s=>{if(s.id!==t)return s;const a=!s.done;return{...s,done:a,completedAt:a?new Date().toISOString():null}});return D({...e,milestones:n},{touchUpdatedAt:!0})}function sn(e,t){if(!e)return e;const n=(e.dailyTasks||[]).map(s=>{if(s.id!==t)return s;const a=!s.done;return{...s,done:a,completedAt:a?new Date().toISOString():null}});return D({...e,dailyTasks:n},{touchUpdatedAt:!0})}function an(e,t){return e&&D({...e,currentScore:Number(t)||0},{touchUpdatedAt:!0})}function rn(e,t=7){if(!e)return e;const n=e.nextCheckInAt||new Date().toISOString();return D({...e,nextCheckInAt:re(n,t)},{touchUpdatedAt:!0})}function on(e,t){if(!e||!t?.trim())return e;const n=[...e.notes||[],{id:`note_${Date.now().toString(36)}`,text:t.trim(),createdAt:new Date().toISOString()}];return D({...e,notes:n},{touchUpdatedAt:!0})}function cn(e){if(!e)return"Choose an expert path to get a daily action plan.";if(e.status==="completed")return"Great progress — this path is complete. Recalculate and choose your next upgrade target.";const t=J(e),n=M(new Date),s=(e.dailyTasks||[]).find(r=>r.date===n&&!r.done);if(t.overdueTasks>0)return`You have ${t.overdueTasks} overdue daily task(s). Clear one overdue task before adding new work.`;if(s)return`Today’s focus: ${s.title} (~${s.expectedMinutes} min).`;const a=(e.milestones||[]).find(r=>!r.done);return a?`Next milestone: ${a.title}. Keep your streak alive with one focused task today.`:"You are close to completion — finish remaining daily actions and refresh your score."}function le(e,t){const n=String(e?.message||"");return new RegExp(`relation\\s+["']?public\\.${t}["']?\\s+does not exist`,"i").test(n)||new RegExp(`table\\s+["']?${t}["']?\\s+not found`,"i").test(n)}function de(e,t){return new Error(`${e}: ${t?.message||t?.hint||String(t)}`)}function ee(){return new Date().toISOString()}function ue(){return A&&!!x}function ln(e){if(!e)return!1;const t=new Set(["active","trialing","paid"]),n=String(e.status||"").toLowerCase();if(!t.has(n))return!1;if(!e.current_period_end)return!0;const s=new Date(e.current_period_end).getTime();return Number.isFinite(s)&&s>Date.now()}async function be(e){if(!e)return{status:"skipped",reason:"Missing user id",active:!1};if(!ue())return{status:"skipped",reason:"Supabase env vars are not configured",active:!1};const{data:t,error:n}=await x.from("user_tracking_access").select("*").eq("user_id",e).limit(1);if(n&&le(n,"user_tracking_access"))return{status:"skipped",reason:"Tracking access table missing. Run the latest supabase/schema.sql.",active:!1};if(n)throw de("Failed to fetch tracking access",n);const s=t?.[0]||null;return{status:"ok",row:s,active:ln(s)}}async function dn(e,t){if(!e||!t)return{status:"skipped",reason:"Missing user id or tracking payload"};if(!ue())return{status:"skipped",reason:"Supabase env vars are not configured"};const n={id:t.id,user_id:e,path_id:t.selectedPath?.id||null,target_score:Number(t.targetScore)||0,start_score:Number(t.selectedPath?.checks?.currentScore)||0,current_score:Number(t.currentScore)||0,status:t.status||"active",progress_pct:Number.isFinite(t.progressPct)?t.progressPct:0,next_check_in_at:t.nextCheckInAt||null,milestones_json:t.milestones||[],daily_tasks_json:t.dailyTasks||[],plan_json:t.selectedPath||{},notes_json:t.notes||[],updated_at:ee()},{data:s,error:a}=await x.from("user_path_tracking").upsert(n,{onConflict:"id"}).select();if(a&&le(a,"user_path_tracking"))return{status:"skipped",reason:"Path tracking table missing. Run the latest supabase/schema.sql."};if(a)throw de("Failed to save path tracking",a);return{status:"ok",data:s?.[0]||null}}async function un(e){if(!e)return{status:"skipped",reason:"Missing user id"};if(!ue())return{status:"skipped",reason:"Supabase env vars are not configured"};const{data:t,error:n}=await x.from("user_path_tracking").select("*").eq("user_id",e).order("updated_at",{ascending:!1}).limit(1);if(n&&le(n,"user_path_tracking"))return{status:"skipped",reason:"Path tracking table missing. Run the latest supabase/schema.sql.",data:null};if(n)throw de("Failed to load path tracking",n);const s=t?.[0]||null;return s?{status:"ok",data:{id:s.id,status:s.status||"active",startedAt:s.created_at||ee(),updatedAt:s.updated_at||ee(),nextCheckInAt:s.next_check_in_at||null,currentScore:s.current_score||0,targetScore:s.target_score||0,selectedPath:s.plan_json||null,milestones:Array.isArray(s.milestones_json)?s.milestones_json:[],dailyTasks:Array.isArray(s.daily_tasks_json)?s.daily_tasks_json:[],notes:Array.isArray(s.notes_json)?s.notes_json:[]}}:{status:"ok",data:null}}function F(e){if(!e)return"—";const t=new Date(e);return Number.isNaN(t.getTime())?"—":t.toLocaleDateString()}function hn(e){const t=String(e||"").toLowerCase();return t==="easy"?"path-diff-easy":t==="hard"?"path-diff-hard":"path-diff-medium"}function Se(e,t,n){return Math.max(t,Math.min(n,e))}function Te(e,t){const n=new Date(e||Date.now());return n.setMonth(n.getMonth()+t),n.toISOString()}function fn(e){const t=Number(e)||0;return Number.isInteger(t)?String(t):t.toFixed(1)}function pn(e){return{"on-track":"On track","slightly-behind":"Slightly behind",behind:"Behind schedule","not-started":"Not started"}[String(e||"")]||"In progress"}function gn(e){return e?e.delayDays>0?`${e.delayDays} day(s) behind baseline`:e.delayDays<0?`${Math.abs(e.delayDays)} day(s) ahead of baseline`:"On baseline timeline":""}async function mn(e){if(!e)return"";const t=[];e.message&&t.push(String(e.message));const n=e.context;if(!n||typeof n.clone!="function")return t.join(" · ").trim();try{const s=n.clone();if((s.headers?.get?.("content-type")||"").includes("application/json")){const r=await s.json(),c=[r?.message,r?.error,r?.details].filter(Boolean).map(d=>String(d));c.length&&t.push(...c)}else{const r=await s.text();r&&t.push(r)}}catch{}return[...new Set(t)].join(" · ").trim()}function yn({answers:e,result:t,averageCutoff:n,categoryInfo:s}){const a=Number(t?.total)||0,r=Math.max(Number(n)||520,a+25),c=(s||[]).filter(p=>typeof p?.check=="function"&&p.check(e)).map(p=>Number(p.recentCutoff)).filter(p=>Number.isFinite(p)&&p>0);if(c.length===0)return Se(r+10,300,1200);const d=Math.min(...c),h=Math.max(d+5,a+5);return Se(Math.min(r+10,h),300,1200)}function kn({answers:e,result:t,averageCutoff:n,categoryInfo:s=[],motionIntensity:a="full"}){const r=pt()||a==="off",{user:c,isAuthenticated:d}=mt(),h=void 0,p=f.useMemo(()=>yn({answers:e,result:t,averageCutoff:n,categoryInfo:s}),[e,t,n,s]),[m,y]=f.useState(()=>Math.max((t?.total||0)+25,500)),[w,b]=f.useState(!1),[S,l]=f.useState(""),[u,j]=f.useState(null),[N,U]=f.useState(""),[z,C]=f.useState(""),[he,fe]=f.useState(!1),[H,O]=f.useState({loading:!1,active:!1,reason:""}),E=f.useMemo(()=>Vt(c?.id||null,null),[c?.id]),_=f.useMemo(()=>Yt(e,t,{targetScore:m,averageCutoff:n}),[e,t,m,n]),T=f.useMemo(()=>_.plans.find(o=>o.id===S)||_.plans[0]||null,[_.plans,S]),P=d&&H.active,pe=Oe(u),Ge=cn(u),I=f.useMemo(()=>J(u),[u]),q=f.useMemo(()=>Qt(u),[u]),V=f.useMemo(()=>en(u,7),[u]),K=f.useMemo(()=>tn(u),[u]),G=f.useMemo(()=>{if(!T)return null;const o=u?.startedAt||new Date().toISOString(),g=T.difficulty==="Easy"?1:T.difficulty==="Hard"?3:2,v=Math.max(T.estimatedMonths-g,1),L=T.estimatedMonths+g+(T.goalReached?0:1);return{earliestMonths:v,latestMonths:L,earliestDate:Te(o,v),latestDate:Te(o,L)}},[T,u?.startedAt]);f.useEffect(()=>{b(!1)},[t?.total]),f.useEffect(()=>{w||y(p)},[p,w]),f.useEffect(()=>{if(!_.plans.length){l("");return}_.plans.some(g=>g.id===S)||l(_.plans[0].id)},[_.plans,S]),f.useEffect(()=>{let o=!0;return queueMicrotask(()=>{if(!o)return;const g=ke(E);if(g){const v={...g,currentScore:Number(t?.total)||0};j(v)}else j(null)}),()=>{o=!1}},[t?.total,E]),f.useEffect(()=>{if(!d||!c?.id)return;let o=!0;return be(c.id).then(g=>{o&&O({loading:!1,active:!!g.active,reason:g.reason||""})}).catch(g=>{o&&O({loading:!1,active:!1,reason:g.message||"Could not verify tracking access."})}),()=>{o=!1}},[d,c?.id]),f.useEffect(()=>{if(!d||!c?.id)return;let o=!0;return un(c.id).then(g=>{if(!o||g.status!=="ok"||!g.data)return;const v=ke(E),L=new Date(g.data.updatedAt||0).getTime(),Je=new Date(v?.updatedAt||0).getTime();if(!v||L>Je){const ge={...g.data,currentScore:Number(t?.total)||0};xe(E,ge),j(ge)}}).catch(()=>{}),()=>{o=!1}},[d,t?.total,E,c?.id]);const B=async o=>{const g=an(o,t.total),v=xe(E,g);if(j(v),d&&P&&c?.id)try{await dn(c.id,v)}catch{}return v},Be=async()=>{if(!T)return;if(!P){C("Tracking is available on the 5 CAD/month plan.");return}const o=Xt(T,t.total,m);await B(o),C("Expert path started. Complete today's tasks to build momentum.")},Re=async o=>{if(!u||!P)return;const g=nn(u,o);await B(g),C("Milestone progress updated.")},Ue=async o=>{if(!u||!P)return;const g=sn(u,o);await B(g),C("Daily task updated.")},ze=async()=>{if(!u||!P)return;const o=rn(u,7);await B(o),C("Next check-in moved by 7 days.")},He=async()=>{if(!u||!P)return;const o=N.trim();if(!o)return;const g=on(u,o);await B(g),U(""),C("Coach note saved.")},Ke=()=>{Zt(E),j(null),C("Tracking reset. Choose another expert path.")},Ye=async()=>{if(!d||!c?.id){C("Please log in before subscribing.");return}fe(!0),C("");try{if(!x)throw new Error("Supabase client is not configured.");const{data:o,error:g}=await x.functions.invoke("create-tracking-checkout",{body:{source:"path-coach"}});if(g){const L=await mn(g);throw new Error(L||"Could not create checkout session.")}const v=o?.url;if(!v)throw new Error("Checkout function returned no URL.");window.location.href=v,C("Opening secure checkout...")}catch(o){const g=String(o?.message||""),v=/non-2xx status code/i.test(g);C(v?'Checkout backend is returning an error. Deploy/fix the Supabase "create-tracking-checkout" function and Stripe secrets, or set VITE_STRIPE_TRACKING_CHECKOUT_URL fallback.':g||"Could not start subscription checkout.")}finally{fe(!1)}};return i.jsxs(Z.div,{className:"card path-coach-card",initial:r?!1:{opacity:0,y:18},animate:{opacity:1,y:0},transition:r?{duration:0}:{duration:.24,ease:[.22,1,.36,1]},children:[i.jsxs("div",{className:"path-coach-head",children:[i.jsx("h3",{children:"Expert Strategy Coach"}),i.jsx("span",{className:"path-pill",children:"Phase 2"})]}),i.jsx("p",{className:"cat-intro",children:"Pick the strategy that fits you best, then follow a guided daily plan to close your CRS gap faster."}),i.jsxs("div",{className:"path-target-row",children:[i.jsxs("label",{className:"wi-field",children:[i.jsx("span",{children:"Target score"}),i.jsx("input",{type:"number",min:"300",max:"1200",value:m,onChange:o=>{b(!0),y(Number(o.target.value)||_.targetScore)}})]}),i.jsxs("div",{className:"path-target-meta",children:[i.jsxs("small",{children:["Current: ",_.currentScore]}),i.jsxs("small",{children:["Score gap: ",Math.max(m-_.currentScore,0)]}),i.jsxs("small",{children:["Smart target: ",p]})]})]}),i.jsx("div",{className:"path-grid",children:_.plans.map(o=>i.jsxs(Z.button,{type:"button",className:`path-option ${T?.id===o.id?"selected":""}`,onClick:()=>l(o.id),"aria-pressed":T?.id===o.id,whileHover:r?void 0:{y:-3},whileTap:r?void 0:{scale:.98},children:[i.jsxs("div",{className:"path-option-head",children:[i.jsx("strong",{children:o.title}),i.jsx("span",{className:`path-diff ${hn(o.difficulty)}`,children:o.difficulty})]}),i.jsx("p",{children:o.summary}),i.jsxs("div",{className:"path-stats",children:[i.jsxs("span",{children:["+",o.potentialGain," pts"]}),i.jsxs("span",{children:[o.estimatedMonths," months"]}),i.jsxs("span",{children:[o.likelihoodPercent,"% likely"]})]}),i.jsx("small",{children:o.goalReached?"Can likely reach your target with this path":`${o.checks.stillNeededAfterPath} pts still needed after this path`})]},o.id))}),T&&i.jsxs("div",{className:"path-detail",children:[i.jsx("h4",{children:T.title}),i.jsx("p",{className:"path-why",children:T.whyItFits}),i.jsxs("div",{className:"path-meta-line",children:[i.jsxs("span",{children:["Projected score: ",i.jsx("strong",{children:T.projectedScore})]}),i.jsxs("span",{children:["Estimated cost: ",i.jsxs("strong",{children:[T.estimatedCostCad," CAD"]})]})]}),G&&i.jsxs("div",{className:"path-meta-line",children:[i.jsxs("span",{children:["Likely completion window: ",i.jsxs("strong",{children:[G.earliestMonths,"-",G.latestMonths," months"]})]}),i.jsxs("span",{children:["Target finish dates: ",i.jsxs("strong",{children:[F(G.earliestDate)," - ",F(G.latestDate)]})]})]}),i.jsx("ul",{className:"path-milestones-preview",children:T.milestones.map(o=>i.jsxs("li",{children:[i.jsx("span",{children:o.title}),i.jsxs("small",{children:["~",o.etaWeeks," weeks"]})]},o.id))})]}),!d&&i.jsx("div",{className:"path-paywall",children:i.jsx("p",{children:"Log in first, then activate paid tracking (5 CAD/month) to unlock daily guidance and cloud sync."})}),d&&!P&&i.jsxs("div",{className:"path-paywall",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Tracking plan:"})," 5 CAD / month"]}),i.jsx("p",{children:"Includes expert strategy tracking, daily tasks, reminders, and cross-device progress sync."}),i.jsxs("div",{className:"path-pay-actions",children:[i.jsx("button",{type:"button",className:"action-btn auth-btn-primary",disabled:he,onClick:Ye,children:he?"Opening...":"Subscribe (5 CAD/month)"}),i.jsx("button",{type:"button",className:"action-btn",onClick:async()=>{if(c?.id){O(o=>({...o,loading:!0}));try{const o=await be(c.id);O({loading:!1,active:!!o.active,reason:o.reason||""}),C(o.active?"Subscription detected. Tracking unlocked.":"Subscription not active yet.")}catch(o){O({loading:!1,active:!1,reason:o.message||""})}}},children:H.loading?"Checking...":"Refresh payment status"}),h]}),H.reason&&i.jsx("small",{children:H.reason})]}),i.jsxs("div",{className:"path-actions",children:[i.jsx(yt,{color:"var(--primary)",speed:"5s",children:i.jsx("button",{className:"btn-next finish",type:"button",onClick:Be,children:u?"Switch to this strategy":"Start this strategy"})}),u&&i.jsx("button",{className:"btn-toggle",type:"button",onClick:Ke,children:"Reset tracking"})]}),u&&i.jsxs("div",{className:"path-tracker",children:[i.jsxs("div",{className:"path-progress-head",children:[i.jsxs("strong",{children:["Progress: ",pe,"%"]}),i.jsxs("span",{children:["Next check-in: ",F(u.nextCheckInAt)]})]}),i.jsx("div",{className:"path-progress-bar-wrap",children:i.jsx(Z.div,{className:"path-progress-bar",initial:{width:0},animate:{width:`${pe}%`},transition:r?{duration:0}:{duration:.7}})}),i.jsxs("div",{className:"path-daily-stats",children:[i.jsxs("span",{children:["Streak: ",i.jsxs("strong",{children:[I.streakDays," day(s)"]})]}),i.jsxs("span",{children:["Completed: ",i.jsxs("strong",{children:[I.completedTasks,"/",I.totalTasks]})]}),i.jsxs("span",{children:["Today: ",i.jsxs("strong",{children:[I.completedToday,"/",I.dueToday]})]}),i.jsxs("span",{className:`pace pace-${I.paceStatus}`,children:["Pace: ",i.jsx("strong",{children:pn(I.paceStatus)})]})]}),K&&i.jsxs("div",{className:"path-coach-note",children:[i.jsx("strong",{children:"Completion forecast:"})," baseline ",F(K.baselineDate)," · current pace ",F(K.projectedDate)," (",gn(K),")"]}),i.jsxs("div",{className:"path-coach-note",children:[i.jsx("strong",{children:"Coach guidance:"})," ",Ge]}),i.jsxs("div",{className:"path-daily-section",children:[i.jsx("h5",{children:"Today's guide"}),!q.length&&i.jsx("p",{className:"path-empty-text",children:"No task is due today. Continue with the next upcoming task."}),!!q.length&&i.jsx("ul",{className:"path-daily-list",children:q.map(o=>i.jsxs("li",{className:o.done?"done":"",children:[i.jsx("button",{type:"button",onClick:()=>Ue(o.id),disabled:!P,children:o.done?"✓":"○"}),i.jsxs("div",{children:[i.jsx("strong",{children:o.title}),i.jsx("p",{children:o.details}),i.jsxs("small",{children:[o.expectedMinutes," min planned · +",fn(o.expectedGain)," projected CRS pace"]})]})]},o.id))})]}),i.jsxs("div",{className:"path-daily-section",children:[i.jsx("h5",{children:"Upcoming 7-day guide"}),!V.length&&i.jsx("p",{className:"path-empty-text",children:"No upcoming tasks yet."}),!!V.length&&i.jsx("ul",{className:"path-upcoming-list",children:V.slice(0,10).map(o=>i.jsxs("li",{children:[i.jsx("span",{children:F(o.date)}),i.jsx("span",{children:o.title})]},o.id))})]}),i.jsx("ul",{className:"path-milestone-list",children:(u.milestones||[]).map(o=>i.jsxs("li",{className:o.done?"done":"",children:[i.jsx("button",{type:"button",onClick:()=>Re(o.id),disabled:!P,children:o.done?"✓":"○"}),i.jsxs("div",{children:[i.jsx("strong",{children:o.title}),i.jsx("p",{children:o.details}),i.jsxs("small",{children:["Expected impact: +",o.expectedGain," pts · ~",o.etaWeeks," weeks"]})]})]},o.id))}),i.jsx("div",{className:"path-checkin-row",children:i.jsx("button",{className:"action-btn",type:"button",onClick:ze,disabled:!P,children:"Move next check-in by 7 days"})}),i.jsxs("div",{className:"path-note-input",children:[i.jsx("input",{type:"text",value:N,onChange:o=>U(o.target.value),placeholder:"Add blocker or update note for your next check-in..."}),i.jsx("button",{className:"action-btn",type:"button",onClick:He,disabled:!P,children:"Save note"})]})]}),z&&i.jsx("p",{className:"save-status",children:z})]})}const Cn=Object.freeze(Object.defineProperty({__proto__:null,default:kn},Symbol.toStringTag,{value:"Module"}));export{wn as A,Cn as P,yt as S,xt as a,bt as b,Dt as c,ie as g,ne as h,A as i,Et as r,x as s,mt as u};
