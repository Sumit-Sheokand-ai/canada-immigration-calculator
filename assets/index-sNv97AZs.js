const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/WelcomeScreen-Xe9DzNF_.js","assets/vendor-react-Ah1pgjPn.js","assets/feature-path-coach-CtSDU3nA.js","assets/data-question-bank-F-s7nTqV.js","assets/vendor-supabase-BZ0N5lZN.js","assets/vendor-motion-DURBmaq0.js","assets/Wizard-Tuwv4AwG.js","assets/Results-BnNoS2Hd.js"])))=>i.map(i=>d[i]);
import{r as i,j as e,c as Ie}from"./vendor-react-Ah1pgjPn.js";import{s as j,i as ce,u as we,A as Re}from"./feature-path-coach-CtSDU3nA.js";import{u as Le,m as De,A as Te}from"./vendor-motion-DURBmaq0.js";import{t as H,r as U}from"./data-question-bank-F-s7nTqV.js";import"./vendor-supabase-BZ0N5lZN.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();const Oe="modulepreload",Me=function(t){return"/"+t},de={},le=function(s,r,c){let a=Promise.resolve();if(r&&r.length>0){let k=function(p){return Promise.all(p.map(S=>Promise.resolve(S).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=d?.nonce||d?.getAttribute("nonce");a=k(r.map(p=>{if(p=Me(p),p in de)return;de[p]=!0;const S=p.endsWith(".css"),y=S?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${y}`))return;const h=document.createElement("link");if(h.rel=S?"stylesheet":Oe,S||(h.as="script"),h.crossOrigin="",h.href=p,f&&h.setAttribute("nonce",f),document.head.appendChild(h),S)return new Promise((N,W)=>{h.addEventListener("load",N),h.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${p}`)))})}))}function o(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&o(f.reason);return s().catch(o)})},be=i.createContext();function ze({children:t}){const[s,r]=i.useState(()=>{try{return localStorage.getItem("crs-theme")==="dark"}catch{return!1}});i.useEffect(()=>{document.documentElement.setAttribute("data-theme",s?"dark":"light");try{localStorage.setItem("crs-theme",s?"dark":"light")}catch{}},[s]);const c=()=>r(a=>!a);return e.jsx(be.Provider,{value:{dark:s,toggle:c},children:t})}function Fe(){return i.useContext(be)}const qe={"header.title":"CRS Calculator 2026","welcome.heading":`Free CRS Calculator
for Express Entry 2026`,"welcome.sub":"Calculate your Comprehensive Ranking System (CRS) score for Canada Express Entry. Check FSW, CEC, PNP eligibility instantly. Updated with latest IRCC draw cutoffs.","welcome.btn":"Calculate My CRS Score Free","welcome.updated":"IRCC data updated:","welcome.trust":"Uses official IRCC draw data â€” last updated:","welcome.microcopy":"This will take 3 minutes â€” one question at a time.","welcome.resume":"You have an unfinished calculation.","welcome.resumeBtn":"Resume","welcome.startFresh":"Start Fresh","feature.accurate":"Official CRS Formula","feature.accurateDesc":"100% accurate IRCC scoring algorithm","feature.suggestions":"Boost Your Score","feature.suggestionsDesc":"Get personalized tips to gain +50 points","feature.draws":"2026 Draw Cutoffs","feature.drawsDesc":"Live IRCC Express Entry draw results","feature.instant":"Free & Instant","feature.instantDesc":"No signup required Â· Results in 2 minutes","wizard.step":"Step","wizard.of":"of","wizard.next":"Next â†’","wizard.back":"â† Back","wizard.calculate":"Calculate Score âœ“","results.breakdown":"Your CRS Score Breakdown","results.improve":"How to Increase Your CRS Score","results.category":"Category-Based Draw Eligibility","results.catIntro":"IRCC runs category-based draws with lower cutoffs for healthcare, STEM, trades, transport, and French speakers. Here's your eligibility:","results.timeline":"PR Timeline Estimate","results.draws":"Latest Express Entry Draws 2026","results.disclaimer":"This free CRS calculator provides an estimate based on IRCC's publicly available scoring criteria. Not affiliated with Immigration, Refugees and Citizenship Canada.","results.restart":"â†» Recalculate","results.share":"Share Results","results.pdf":"Download PDF","results.whatif":"What-If Score Simulator","results.whatifDesc":"See how improving IELTS, education, or work experience affects your CRS:","results.original":"Current","results.projected":"Projected","results.foreignWork":"Foreign Work (Skill Bonus)","footer.copy":"Free CRS Calculator 2026 Â· Not affiliated with IRCC"},Ue={"header.title":"Calculateur SRC","welcome.heading":`Immigration au Canada
Calculateur de Points`,"welcome.sub":"Calculez votre score du SystÃ¨me de classement global (SCG) et dÃ©couvrez votre meilleur chemin vers la rÃ©sidence permanente canadienne.","welcome.btn":"Calculer Mon Score","welcome.updated":"DerniÃ¨re mise Ã  jour :","welcome.trust":"DonnÃ©es officielles dâ€™IRCC â€” derniÃ¨re mise Ã  jour :","welcome.microcopy":"Cela prend 3 minutes â€” une question Ã  la fois.","welcome.resume":"Vous avez un calcul en cours.","welcome.resumeBtn":"Reprendre","welcome.startFresh":"Recommencer","feature.accurate":"Score SCG PrÃ©cis","feature.accurateDesc":"Calcul complet du SystÃ¨me de classement global","feature.suggestions":"Suggestions Intelligentes","feature.suggestionsDesc":"Conseils personnalisÃ©s pour augmenter vos points","feature.draws":"Derniers Tirages","feature.drawsDesc":"RÃ©sultats Ã  jour des tirages EntrÃ©e express d'IRCC","feature.instant":"RÃ©sultats InstantanÃ©s","feature.instantDesc":"Obtenez votre score en moins de 2 minutes","wizard.step":"Ã‰tape","wizard.of":"de","wizard.next":"Suivant â†’","wizard.back":"â† Retour","wizard.calculate":"Calculer le Score âœ“","results.breakdown":"DÃ©tail de Votre Score","results.improve":"Comment AmÃ©liorer Votre Score","results.category":"AdmissibilitÃ© aux Tirages par CatÃ©gorie","results.catIntro":"Le Canada organise des tirages spÃ©ciaux pour des groupes spÃ©cifiques avec des seuils plus bas. Voici ce Ã  quoi vous pourriez Ãªtre admissible :","results.timeline":"Calendrier EstimÃ©","results.draws":"Tirages RÃ©cents EntrÃ©e Express","results.disclaimer":"Ce calculateur fournit une estimation basÃ©e sur les critÃ¨res SCG publics. Il n'est pas affiliÃ© Ã  IRCC.","results.restart":"â†» Recommencer","results.share":"Partager les RÃ©sultats","results.pdf":"TÃ©lÃ©charger PDF","results.whatif":"Comparaison HypothÃ©tique","results.whatifDesc":"Ajustez les variables pour voir comment votre score change :","results.original":"Original","results.projected":"ProjetÃ©","results.foreignWork":"Exp. Ã‰trangÃ¨re (Bonus)","footer.copy":"Calculateur SRC Â· Non affiliÃ© Ã  IRCC"},fe={en:qe,fr:Ue},ye=i.createContext();function Be({children:t}){const[s,r]=i.useState(()=>{try{return localStorage.getItem("crs-lang")||"en"}catch{return"en"}}),c=i.useCallback(o=>{r(o);try{localStorage.setItem("crs-lang",o)}catch{}},[]),a=i.useCallback(o=>fe[s]?.[o]||fe.en[o]||o,[s]);return e.jsx(ye.Provider,{value:{lang:s,setLang:c,t:a},children:t})}function ve(){return i.useContext(ye)}const Se="crs-analytics-queue-v1";function We(t,s){try{return t?JSON.parse(t):s}catch{return s}}function Ye(){return typeof window>"u"?[]:We(window.localStorage.getItem(Se),[])}function Ge(t){if(typeof window>"u")return;const s=Array.isArray(t)?t.slice(-250):[];try{window.localStorage.setItem(Se,JSON.stringify(s))}catch{}}function Ve(t={}){const s={};for(const[r,c]of Object.entries(t))if(c!=null){if(typeof c=="string"||typeof c=="number"||typeof c=="boolean"){s[r]=c;continue}if(Array.isArray(c)){s[r]=c.slice(0,20).map(a=>String(a));continue}s[r]=String(c)}return s}async function $e(t){}function He(t,s){if(!(typeof window>"u")&&typeof window.plausible=="function")try{window.plausible(t,{props:s})}catch{}}function T(t,s={}){if(!t||typeof window>"u")return;const r=Ve(s),c={name:String(t),payload:r,ts:new Date().toISOString(),path:window.location.pathname},a=Ye();a.push(c),Ge(a),He(c.name,r),$e()}function Ke(t,s){const r=t.answers||{};return{id:t.id,user_id:s||null,name:t.name||null,score:Number(t.score)||0,email:t.email||null,alert_opt_in:!!t.alertOptIn,alert_token:t.alertToken||null,profile_json:{answers:r,tracking:{userId:s||null,savedAt:new Date().toISOString()}},updated_at:new Date().toISOString()}}function ae(t){const s=String(t?.message||"");return/column\s+["']?user_id["']?\s+does not exist/i.test(s)}function K(t,s){const r=s?.message||s?.hint||String(s);return`${t}: ${r}`}function B(){return ce&&!!j}async function Ct(t,s={}){if(!B())return{status:"skipped",reason:"Supabase env vars are not configured"};const r=s.userId||null,c=Ke(t,r);let a,o;if({data:a,error:o}=await j.from("saved_profiles").upsert(c,{onConflict:"id"}).select(),o&&r&&ae(o)){const{user_id:d,...f}=c;({data:a,error:o}=await j.from("saved_profiles").upsert(f,{onConflict:"id"}).select())}if(o)throw new Error(K("Supabase upsert failed",o));return{status:"ok",data:a||[]}}async function Je(t){if(!t)return{status:"skipped",reason:"Missing token"};if(!B())return{status:"skipped",reason:"Supabase env vars are not configured"};const{data:s,error:r}=await j.from("saved_profiles").update({alert_opt_in:!1,updated_at:new Date().toISOString()}).eq("alert_token",t).select();if(r)throw new Error(K("Supabase unsubscribe failed",r));return s?.length?{status:"ok",data:s[0]}:{status:"not-found"}}async function jt(t){if(!t)return{status:"skipped",reason:"Missing user id"};if(!B())return{status:"skipped",reason:"Supabase env vars are not configured"};const{data:s,error:r}=await j.from("saved_profiles").select("id,name,score,email,updated_at").eq("user_id",t).order("updated_at",{ascending:!1}).limit(12);if(r&&ae(r))return{status:"skipped",reason:"saved_profiles.user_id column not found; run the latest supabase/schema.sql"};if(r)throw new Error(K("Supabase profile list failed",r));return{status:"ok",data:s||[]}}async function Qe(t,s){if(!t)return{status:"skipped",reason:"Missing user id"};if(!B())return{status:"skipped",reason:"Supabase env vars are not configured"};const{error:r,data:c}=await j.from("saved_profiles").update({alert_opt_in:!!s,updated_at:new Date().toISOString()}).eq("user_id",t).select("id");if(r&&ae(r))return{status:"skipped",reason:"saved_profiles.user_id column not found; run the latest supabase/schema.sql"};if(r)throw new Error(K("Supabase alert preference update failed",r));return{status:"ok",updatedCount:c?.length||0}}async function Xe(t,s){if(!t)return{status:"skipped",reason:"Missing user id"};if(!B())return{status:"skipped",reason:"Supabase env vars are not configured"};const r=s?String(s).trim().toLowerCase():null,{error:c,data:a}=await j.from("saved_profiles").update({email:r||null,updated_at:new Date().toISOString()}).eq("user_id",t).select("id");if(c&&ae(c))return{status:"skipped",reason:"saved_profiles.user_id column not found; run the latest supabase/schema.sql"};if(c)throw new Error(K("Supabase profile email update failed",c));return{status:"ok",updatedCount:a?.length||0}}const xe="crs-account-settings-v1",q={profileName:"",contactEmail:"",defaultDrawAlerts:!1,autoSyncProfiles:!0,autoSaveProgress:!0,motionIntensity:"full"};function oe(){try{const t=localStorage.getItem(xe);if(!t)return{...q};const s=JSON.parse(t);return!s||typeof s!="object"?{...q}:{...q,...s}}catch{return{...q}}}function Ze(t){const s={...q,...t||{}};["off","subtle","full"].includes(s.motionIntensity)||(s.motionIntensity=q.motionIntensity);try{localStorage.setItem(xe,JSON.stringify(s))}catch{}try{window.dispatchEvent(new Event("crs-account-settings-updated"))}catch{}return s}const me=/^\S+@\S+\.\S+$/,$="DELETE",pe=8;function et({open:t,onClose:s}){const{isConfigured:r,loading:c,user:a,sendEmailMagicLink:o,verifyEmailOtp:d,refreshSession:f,signInWithGoogle:k,signOut:p,updateProfile:S,changePassword:y,deleteAccount:h}=we(),[N,W]=i.useState(""),[O,L]=i.useState(""),[A,_]=i.useState("request"),[J,g]=i.useState(""),[Q,l]=i.useState(""),[P,M]=i.useState(0),[v,C]=i.useState(()=>oe()),[X,Y]=i.useState(""),[Z,u]=i.useState(""),[m,I]=i.useState(""),ne=i.useId(),R=i.useMemo(()=>a?"Account":"Login / Signup",[a]),D=B(),b=J!=="",x=n=>J===n;if(i.useEffect(()=>{if(!t||P<=0)return;const n=window.setInterval(()=>{M(w=>w<=1?0:w-1)},1e3);return()=>window.clearInterval(n)},[t,P]),i.useEffect(()=>{!t||!a||C(n=>({...n,profileName:a.user_metadata?.full_name||n.profileName||"",contactEmail:n.contactEmail||a.email||""}))},[t,a]),i.useEffect(()=>{if(!t||!a||!(A==="sent"||A==="verify"))return;l("Signed in successfully.");const n=window.setTimeout(()=>s(),500);return()=>window.clearTimeout(n)},[s,t,A,a]),i.useEffect(()=>{t||(_("request"),L(""),l(""),g(""),M(0),Y(""),u(""),I(""))},[t]),i.useEffect(()=>{if(!t)return;const n=document.body.style.overflow,w=re=>{re.key==="Escape"&&s()};return document.body.style.overflow="hidden",window.addEventListener("keydown",w),()=>{window.removeEventListener("keydown",w),document.body.style.overflow=n}},[s,t]),!t)return null;const E=N.trim().toLowerCase(),G=m.trim().toUpperCase(),V=async()=>{if(!E||!me.test(E)){l("Please enter a valid email address.");return}g("sendMagicLink"),l("");try{await o(E),_("sent"),L(""),M(25),l("Magic link sent. Open your email and click the secure sign-in link.")}catch(n){l(n.message||"Could not send magic link.")}finally{g("")}},ee=async()=>{g("checkMagicLink"),l("");try{(await f())?.user?(l("Signed in successfully."),_("request"),window.setTimeout(()=>s(),500)):l("No active session found yet. Click the magic link from your email in this browser, then try again.")}catch(n){l(n.message||"Could not refresh session.")}finally{g("")}},te=async()=>{P>0||await V()},se=async()=>{if(!E||!O.trim()){l("Enter your email and 6-digit code.");return}g("verifyCode"),l("");try{await d(E,O.trim()),await f(),l("Signed in successfully."),_("request"),L(""),window.setTimeout(()=>s(),500)}catch(n){l(n.message||"Verification failed.")}finally{g("")}},je=async()=>{g("googleAuth"),l("");try{await k(),l("Redirecting to Google...")}catch(n){l(n.message||"Google login failed.")}finally{g("")}},ke=async()=>{const n={...v,profileName:(v.profileName||"").trim(),contactEmail:(v.contactEmail||"").trim().toLowerCase()};if(n.contactEmail&&!me.test(n.contactEmail)){l("Please enter a valid contact email.");return}g("saveSettings"),l("");try{await S({fullName:n.profileName}),Ze(n),C(n),D&&a?.id&&await Promise.all([Qe(a.id,n.defaultDrawAlerts),Xe(a.id,n.contactEmail||a.email||"")]),l("Account settings saved.")}catch(w){l(w.message||"Could not save account settings.")}finally{g("")}},Ee=async()=>{const n=X.trim(),w=Z.trim();if(n.length<pe){l(`Password must be at least ${pe} characters.`);return}if(n!==w){l("New password and confirmation do not match.");return}g("changePassword"),l("");try{await y(n),Y(""),u(""),l("Password updated successfully.")}catch(re){l(re.message||"Could not change password.")}finally{g("")}},Ne=()=>{{l("Membership management is unavailable. Add VITE_STRIPE_BILLING_PORTAL_URL.");return}},Ae=async()=>{if(G!==$){l(`Type ${$} to confirm account deletion.`);return}g("deleteAccount"),l("");try{await h(),I(""),l("Account deleted."),window.setTimeout(()=>s(),350)}catch(n){l(n.message||"Could not delete account.")}finally{g("")}},_e=async()=>{g("refreshSession"),l("");try{await f(),l("Session refreshed.")}catch(n){l(n.message||"Session refresh failed.")}finally{g("")}},Pe=async()=>{g("signOut"),l("");try{await p(),l("Signed out."),window.setTimeout(()=>s(),400)}catch(n){l(n.message||"Sign out failed.")}finally{g("")}};return e.jsx("div",{className:"auth-modal-backdrop",onClick:s,role:"presentation",children:e.jsxs("div",{className:"auth-modal",role:"dialog","aria-modal":"true","aria-labelledby":ne,onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"auth-modal-head",children:[e.jsx("h3",{id:ne,children:R}),e.jsx("button",{type:"button",className:"auth-close",onClick:s,"aria-label":"Close dialog",children:"Ã—"})]}),e.jsxs("div",{className:"auth-modal-scroll",children:[!r&&e.jsx("p",{className:"auth-note",children:"Auth is unavailable. Add `VITE_SUPABASE_URL` and `VITE_SUPABASE_ANON_KEY`."}),r&&c&&e.jsx("p",{className:"auth-note",children:"Checking session..."}),r&&!c&&a&&e.jsxs("div",{className:"auth-body",children:[e.jsxs("p",{className:"auth-note",children:["Signed in as ",e.jsx("strong",{children:a.email})]}),e.jsxs("div",{className:"auth-settings-card auth-settings-section",children:[e.jsx("h4",{children:"Account settings"}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Display name"}),e.jsx("input",{type:"text",value:v.profileName,onChange:n=>C(w=>({...w,profileName:n.target.value})),placeholder:"Your name"})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Contact email for draw alerts"}),e.jsx("input",{type:"email",value:v.contactEmail,onChange:n=>C(w=>({...w,contactEmail:n.target.value})),placeholder:"you@example.com"})]}),e.jsxs("label",{className:"auth-check-row",children:[e.jsx("input",{type:"checkbox",checked:v.defaultDrawAlerts,onChange:n=>C(w=>({...w,defaultDrawAlerts:n.target.checked}))}),e.jsx("span",{children:"Enable draw alerts by default"})]}),e.jsxs("label",{className:"auth-check-row",children:[e.jsx("input",{type:"checkbox",checked:v.autoSyncProfiles,onChange:n=>C(w=>({...w,autoSyncProfiles:n.target.checked}))}),e.jsx("span",{children:"Auto-sync saved profiles"})]}),e.jsxs("label",{className:"auth-check-row",children:[e.jsx("input",{type:"checkbox",checked:v.autoSaveProgress,onChange:n=>C(w=>({...w,autoSaveProgress:n.target.checked}))}),e.jsx("span",{children:"Auto-save wizard progress on this device"})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Animation intensity"}),e.jsxs("select",{value:v.motionIntensity||"full",onChange:n=>C(w=>({...w,motionIntensity:n.target.value})),children:[e.jsx("option",{value:"full",children:"Full"}),e.jsx("option",{value:"subtle",children:"Subtle"}),e.jsx("option",{value:"off",children:"Off"})]})]}),!D&&e.jsx("p",{className:"auth-note",children:"Cloud account settings require Supabase env vars."})]}),e.jsxs("div",{className:"auth-settings-card auth-settings-section",children:[e.jsx("h4",{children:"Security"}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"New password"}),e.jsx("input",{type:"password",value:X,onChange:n=>Y(n.target.value),placeholder:"At least 8 characters",autoComplete:"new-password"})]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Confirm new password"}),e.jsx("input",{type:"password",value:Z,onChange:n=>u(n.target.value),placeholder:"Re-enter new password",autoComplete:"new-password"})]}),e.jsx("div",{className:"auth-actions",children:e.jsx("button",{type:"button",className:"action-btn",disabled:b,onClick:Ee,children:x("changePassword")?"Updating...":"Change password"})})]}),e.jsxs("div",{className:"auth-settings-card auth-settings-section",children:[e.jsx("h4",{children:"Membership"}),e.jsx("p",{className:"auth-note",children:"Remove or manage your membership from the billing portal."}),e.jsx("div",{className:"auth-actions",children:e.jsx("button",{type:"button",className:"action-btn",disabled:b,onClick:Ne,children:"Remove membership"})})]}),e.jsxs("div",{className:"auth-settings-card auth-settings-section auth-danger-zone",children:[e.jsx("h4",{children:"Danger zone"}),e.jsxs("p",{className:"auth-note",children:["This permanently deletes your account. Type ",e.jsx("strong",{children:$})," to confirm."]}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Confirmation"}),e.jsx("input",{type:"text",value:m,onChange:n=>I(n.target.value),placeholder:$})]}),e.jsx("div",{className:"auth-actions",children:e.jsx("button",{type:"button",className:"action-btn auth-btn-danger",disabled:b||G!==$,onClick:Ae,children:x("deleteAccount")?"Deleting...":"Delete account"})})]}),e.jsxs("div",{className:"auth-actions",children:[e.jsx("button",{type:"button",className:"action-btn auth-btn-primary",disabled:b,onClick:ke,children:x("saveSettings")?"Saving...":"Save settings"}),e.jsx("button",{type:"button",className:"action-btn",disabled:b,onClick:_e,children:x("refreshSession")?"Refreshing...":"Refresh session"}),e.jsx("button",{type:"button",className:"action-btn",disabled:b,onClick:Pe,children:x("signOut")?"Signing out...":"Sign out"})]})]}),r&&!c&&!a&&e.jsxs("div",{className:"auth-body",children:[e.jsx("p",{className:"auth-note",children:"Sign in with a magic link (recommended) or verify manually with an email code."}),e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Email"}),e.jsx("input",{type:"email",placeholder:"you@example.com",value:N,onChange:n=>W(n.target.value),autoFocus:!0})]}),A==="verify"&&e.jsxs("label",{className:"wi-field",children:[e.jsx("span",{children:"Email verification code"}),e.jsx("input",{type:"text",inputMode:"numeric",placeholder:"Enter code",value:O,onChange:n=>L(n.target.value)})]}),e.jsxs("div",{className:"auth-actions",children:[A==="request"?e.jsx("button",{type:"button",className:"action-btn auth-btn-primary",disabled:b,onClick:V,children:x("sendMagicLink")?"Sending...":"Send magic link"}):A==="sent"?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"action-btn auth-btn-primary",disabled:b,onClick:ee,children:x("checkMagicLink")?"Checking...":"I clicked the magic link"}),e.jsx("button",{type:"button",className:"action-btn",disabled:b||P>0,onClick:te,children:P>0?`Resend in ${P}s`:"Resend magic link"}),e.jsx("button",{type:"button",className:"action-btn",disabled:b,onClick:()=>{_("verify"),l("If your email contains a code, enter it below.")},children:"Use email code instead"})]}):e.jsx("button",{type:"button",className:"action-btn auth-btn-primary",disabled:b,onClick:se,children:x("verifyCode")?"Verifying...":"Verify and sign in"}),e.jsx("button",{type:"button",className:"action-btn",disabled:b,onClick:je,children:x("googleAuth")?"Redirecting...":"Continue with Google"}),A!=="request"&&e.jsx("button",{type:"button",className:"action-btn",disabled:b,onClick:()=>{_("request"),L(""),l(""),M(0)},children:"Back"})]})]}),Q&&e.jsx("p",{className:"auth-status",role:"status","aria-live":"polite",children:Q})]})]})})}const tt={en:"EN",fr:"FR"};function st({canInstallApp:t=!1,onInstallApp:s=()=>{},motionIntensity:r="full"}){const c=Le()||r==="off",{dark:a,toggle:o}=Fe(),{lang:d,setLang:f,t:k}=ve(),{user:p}=we(),[S,y]=i.useState(!1);return i.useEffect(()=>{const h=()=>y(!0);return window.addEventListener("crs-open-account-modal",h),()=>{window.removeEventListener("crs-open-account-modal",h)}},[]),e.jsxs(De.header,{className:"header",initial:c?!1:{y:-60,opacity:0},animate:{y:0,opacity:1},transition:c?{duration:0}:{type:"spring",stiffness:120,damping:20},children:[e.jsxs("div",{className:"header-inner",children:[e.jsxs("div",{className:"logo",children:[e.jsx("span",{className:"logo-leaf",children:"ðŸ"}),e.jsx("span",{children:k("header.title")})]}),e.jsxs("div",{className:"header-actions",children:[t&&e.jsx("button",{type:"button",className:"install-btn",onClick:s,"aria-label":"Install app",title:"Add app shortcut",children:"Install app"}),e.jsx("button",{type:"button",className:"auth-toggle",onClick:()=>{y(!0),T("account_modal_opened",{source:"header_button",is_authenticated:!!p})},"aria-label":p?"Manage account":"Login or signup",title:p?p.email:"Login / Signup",children:p?"Account":"Login"}),e.jsx("select",{className:"lang-select",value:d,onChange:h=>f(h.target.value),"aria-label":"Select language",children:Object.entries(tt).map(([h,N])=>e.jsx("option",{value:h,children:N},h))}),e.jsx("button",{type:"button",className:"theme-toggle",onClick:o,"aria-label":a?"Switch to light mode":"Switch to dark mode",title:a?"Light mode":"Dark mode",children:a?"Light":"Dark"})]})]}),e.jsx(et,{open:S,onClose:()=>y(!1)})]})}function ie(){const t=Array.from({length:9});return e.jsxs("div",{className:"uv-loader",children:[t.map((s,r)=>e.jsx("div",{className:"uv-text",children:e.jsx("span",{children:"Loading"})},r)),e.jsx("div",{className:"uv-line"})]})}const Ce=300*1e3;let z={data:null,source:"none",fetchedAt:0},F={data:null,source:"none",fetchedAt:0};function at(t){return!!t&&typeof t=="object"&&Array.isArray(t.generalProgram)&&Array.isArray(t.categoryBased)&&Array.isArray(t.pnpDraws)&&Number.isFinite(Number(t.averageCutoff))}function nt(t){return at(t)?{...t,generalProgram:t.generalProgram||[],categoryBased:t.categoryBased||[],pnpDraws:t.pnpDraws||[],averageCutoff:Number(t.averageCutoff)||U.averageCutoff,lastUpdated:t.lastUpdated||U.lastUpdated,pnpRanges:t.pnpRanges||U.pnpRanges}:null}function rt(t){if(!t||typeof t!="object")return null;const s=String(t.id||"").trim(),r=String(t.name||"").trim(),c=String(t.icon||"").trim(),a=String(t.description||"").trim(),o=String(t.eligibility||"").trim(),d=String(t.cutoff_range||t.cutoffRange||"").trim(),f=Number(t.recent_cutoff??t.recentCutoff);return!s||!r||!c||!a||!o||!Number.isFinite(f)?null:{id:s,name:r,icon:c,description:a,eligibility:o,recentCutoff:f,cutoffRange:d||"N/A",source:t.source||"supabase",updatedAt:t.updated_at||null}}function it(t=[]){const s=new Map(H.map(o=>[o.id,o])),r=new Map;for(const o of t){const d=rt(o);d&&(r.has(d.id)||r.set(d.id,d))}const c=H.map(o=>{const d=r.get(o.id);return d?{...o,name:d.name,icon:d.icon,description:d.description,eligibility:d.eligibility,recentCutoff:d.recentCutoff,cutoffRange:d.cutoffRange,source:d.source,updatedAt:d.updatedAt}:o}),a=[...r.values()].filter(o=>!s.has(o.id)).map(o=>({...o,check:()=>!1}));return[...c,...a]}function ot(){return U}function ct(){return H}async function lt({forceRefresh:t=!1}={}){if(!t&&z.data&&Date.now()-z.fetchedAt<Ce)return{status:"ok",source:z.source,data:z.data};if(ce&&j)try{const{data:s,error:r}=await j.from("draw_snapshots").select("payload,last_updated").order("last_updated",{ascending:!1}).limit(1);if(!r){const c=s?.[0],a=nt(c?.payload);if(a)return z={data:a,source:"supabase",fetchedAt:Date.now()},{status:"ok",source:"supabase",data:a}}}catch{}return z={data:U,source:"local-fallback",fetchedAt:Date.now()},{status:"ok",source:"local-fallback",data:U}}async function ut({forceRefresh:t=!1}={}){if(!t&&F.data&&Date.now()-F.fetchedAt<Ce)return{status:"ok",source:F.source,data:F.data};if(ce&&j)try{const{data:s,error:r}=await j.from("category_draw_configs").select("id,source,name,icon,description,eligibility,recent_cutoff,cutoff_range,is_active,updated_at").eq("is_active",!0).order("updated_at",{ascending:!1});if(!r&&Array.isArray(s)&&s.length>0){const c=it(s);return F={data:c,source:"supabase",fetchedAt:Date.now()},{status:"ok",source:"supabase",data:c}}}catch{}return F={data:H,source:"local-fallback",fetchedAt:Date.now()},{status:"ok",source:"local-fallback",data:H}}const dt=i.lazy(()=>le(()=>import("./WelcomeScreen-Xe9DzNF_.js"),__vite__mapDeps([0,1,2,3,4,5]))),ft=i.lazy(()=>le(()=>import("./Wizard-Tuwv4AwG.js"),__vite__mapDeps([6,1,3,2,4,5]))),mt=i.lazy(()=>le(()=>import("./Results-BnNoS2Hd.js"),__vite__mapDeps([7,1,2,3,4,5]))),ue="crs-progress";function he(){try{const t=localStorage.getItem(ue);return t?JSON.parse(t):null}catch{return null}}function pt(t){try{localStorage.setItem(ue,JSON.stringify(t))}catch{}}function ge(){try{localStorage.removeItem(ue)}catch{}}function ht(){try{return new URLSearchParams(window.location.search).get("unsubscribe")}catch{return null}}function gt(){return{}}function wt(){const{t}=ve(),[s,r]=i.useState(()=>oe()),c=s.autoSaveProgress!==!1,a=["off","subtle","full"].includes(s.motionIntensity)?s.motionIntensity:"full",o=ht(),d=gt(),[f,k]=i.useState(()=>o?"unsubscribe":Object.keys(d).length>0?"results":"welcome"),[p,S]=i.useState(()=>d),[y,h]=i.useState(()=>o?"loading":"idle"),[N,W]=i.useState(()=>ot()),[O,L]=i.useState("local-fallback"),[A,_]=i.useState(()=>ct());i.useEffect(()=>{if(!o)return;let u=!0;return Je(o).then(m=>{u&&h(m.status==="ok"?"success":"notfound")}).catch(()=>{u&&h("error")}),()=>{u=!1}},[o]),i.useEffect(()=>{let u=!0;return lt().then(m=>{u&&m?.status==="ok"&&m.data&&(W(m.data),L(m.source||"local-fallback"))}).catch(()=>{}),()=>{u=!1}},[]),i.useEffect(()=>{let u=!0;return ut().then(m=>{u&&m?.status==="ok"&&Array.isArray(m.data)&&m.data.length>0&&_(m.data)}).catch(()=>{}),()=>{u=!1}},[]);const J=i.useCallback(u=>{if(u&&c){const m=he();m&&S(m)}T("wizard_started",{resumed:!!u}),k("wizard")},[c]),g=i.useCallback(u=>{S(u),ge(),T("wizard_completed",{answer_count:Object.keys(u||{}).length}),k("results"),window.scrollTo({top:0,behavior:"smooth"})},[]),Q=i.useCallback(()=>{S({}),ge(),T("calculator_restarted"),window.history.replaceState(null,"",window.location.pathname),k("welcome"),window.scrollTo({top:0,behavior:"smooth"})},[]),l=c&&!!he(),[P,M]=i.useState(!1),[v,C]=i.useState(null),[X,Y]=i.useState(()=>{const u=window.matchMedia?.("(display-mode: standalone)")?.matches,m=window.navigator?.standalone===!0;return!!(u||m)});i.useEffect(()=>{const u=()=>M(window.scrollY>400);return window.addEventListener("scroll",u,{passive:!0}),()=>window.removeEventListener("scroll",u)},[]),i.useEffect(()=>{const u=I=>{I.preventDefault(),C(I)},m=()=>{C(null),Y(!0)};return window.addEventListener("beforeinstallprompt",u),window.addEventListener("appinstalled",m),()=>{window.removeEventListener("beforeinstallprompt",u),window.removeEventListener("appinstalled",m)}},[]);const Z=i.useCallback(async()=>{if(!v)return;T("install_prompt_triggered"),v.prompt(),(await v.userChoice)?.outcome==="accepted"?(C(null),T("install_prompt_accepted")):T("install_prompt_dismissed")},[v]);return i.useEffect(()=>{const u=()=>{r(oe())};return window.addEventListener("storage",u),window.addEventListener("crs-account-settings-updated",u),()=>{window.removeEventListener("storage",u),window.removeEventListener("crs-account-settings-updated",u)}},[]),i.useEffect(()=>{document.documentElement.setAttribute("data-motion",a)},[a]),i.useEffect(()=>{const u=document.documentElement,m=window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches,I=window.matchMedia?.("(pointer: fine)")?.matches;if(!(a!=="off"&&!m&&!!I)){u.style.setProperty("--pointer-x","50%"),u.style.setProperty("--pointer-y","40%"),u.style.setProperty("--pointer-glow","0");return}u.style.setProperty("--pointer-glow",a==="subtle"?"0.45":"1");let R=0,D=50,b=40,x=50,E=40;const G=()=>{D+=(x-D)*.12,b+=(E-b)*.12,u.style.setProperty("--pointer-x",`${D.toFixed(2)}%`),u.style.setProperty("--pointer-y",`${b.toFixed(2)}%`),Math.abs(x-D)>.05||Math.abs(E-b)>.05?R=window.requestAnimationFrame(G):R=0},V=()=>{R||(R=window.requestAnimationFrame(G))},ee=se=>{x=se.clientX/window.innerWidth*100,E=se.clientY/window.innerHeight*100,V()},te=()=>{x=50,E=40,V()};return window.addEventListener("pointermove",ee,{passive:!0}),window.addEventListener("pointerleave",te,{passive:!0}),()=>{window.removeEventListener("pointermove",ee),window.removeEventListener("pointerleave",te),R&&window.cancelAnimationFrame(R)}},[a]),e.jsxs("div",{className:"app",children:[e.jsxs("div",{className:"anime-bg","aria-hidden":"true",children:[e.jsx("span",{className:"anime-bg-aurora anime-bg-aurora--one"}),e.jsx("span",{className:"anime-bg-aurora anime-bg-aurora--two"}),e.jsx("span",{className:"anime-bg-aurora anime-bg-aurora--three"}),e.jsx("span",{className:"anime-bg-grid"}),e.jsx("span",{className:"anime-bg-noise"}),e.jsx("span",{className:"anime-bg-pointer-glow"}),e.jsx("span",{className:"anime-bg-flare"}),e.jsx("span",{className:"anime-bg-vignette"}),e.jsxs("div",{className:"anime-bg-sparks",children:[e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{}),e.jsx("span",{})]})]}),e.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),e.jsx(st,{canInstallApp:!X&&!!v,onInstallApp:Z,motionIntensity:a}),e.jsx("main",{className:"main",role:"main",id:"main-content",children:e.jsxs(Te,{mode:"wait",children:[f==="welcome"&&e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"loading-fallback",children:e.jsx(ie,{})}),children:e.jsx(dt,{onStart:J,hasSaved:l,drawData:N,drawSource:O,motionIntensity:a},"welcome")}),f==="wizard"&&e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"loading-fallback",children:e.jsx(ie,{})}),children:e.jsx(ft,{onFinish:g,onProgress:c?pt:void 0,initialAnswers:p,motionIntensity:a},"wizard")}),f==="unsubscribe"&&e.jsxs("div",{className:"card unsubscribe-card",children:[e.jsx("h3",{children:"Draw alert preferences"}),y==="loading"&&e.jsx("p",{children:"Processing your unsubscribe requestâ€¦"}),y==="success"&&e.jsx("p",{children:"Youâ€™ve been unsubscribed from draw alerts successfully."}),y==="notfound"&&e.jsx("p",{children:"This unsubscribe link is invalid or already inactive."}),y==="error"&&e.jsx("p",{children:"We couldnâ€™t process this request right now. Please try again later."}),e.jsx("button",{type:"button",className:"btn-restart",onClick:()=>k("welcome"),children:"Back to calculator"})]}),f==="results"&&e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"loading-fallback",children:e.jsx(ie,{})}),children:e.jsx(mt,{answers:p,onRestart:Q,drawData:N,drawSource:O,categoryInfo:A,motionIntensity:a},"results")})]})}),e.jsxs("footer",{className:"footer",children:[e.jsxs("p",{children:["Â© ",new Date().getFullYear()," ",t("footer.copy")]}),e.jsxs("p",{className:"footer-legal-links",children:[e.jsx("a",{href:"/guides.html",children:"Guides"}),e.jsx("span",{"aria-hidden":"true",children:" Â· "}),e.jsx("a",{href:"/terms.html",children:"Terms of Service"}),e.jsx("span",{"aria-hidden":"true",children:" Â· "}),e.jsx("a",{href:"/privacy.html",children:"Privacy Policy"}),e.jsx("span",{"aria-hidden":"true",children:" Â· "}),e.jsx("a",{href:"/trust.html",children:"Trust Center"})]})]}),P&&e.jsx("button",{type:"button",className:"btn-top",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),"aria-label":"Back to top",children:"â†‘"})]})}"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("[SW] Service Worker registered:",t)}).catch(t=>{console.error("[SW] Service Worker registration failed:",t)})});Ie.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(Re,{children:e.jsx(ze,{children:e.jsx(Be,{children:e.jsx(wt,{})})})})}));export{ie as L,le as _,ot as a,Ct as b,ct as g,B as i,jt as l,oe as r,Ze as s,T as t,ve as u};
